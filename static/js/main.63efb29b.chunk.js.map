{"version":3,"sources":["lib/typeAcquisition.ts","../../bundler/dist/dist-module/index.js","../../resolver-host-compound/dist/dist-module/index.js","lib/error.ts","lib/ResolverHostMonaco.ts","../../resolver-host-unpkg/dist/dist-module/index.js","lib/ResolverHostWithCache.ts","lib/EditorManager.ts","components/Editor.tsx","components/Preview.tsx","lib/hooks.ts","components/Sidebar.tsx","components/App.tsx","serviceWorker.ts","index.tsx","../../resolver/dist/dist-module/index.js"],"names":["PackageEntryKind","HAS_D_TS_EXTENSION","getTypingsModuleSpec","pkgJson","typingsName","name","charAt","slice","replace","typingsRange","version","major","split","range","TypeAcquirer","resolver","resolveBareModule","_onTypeFile","Emitter","typingsFiles","parentPath","moduleRoot","util","join","this","_listFiles","then","files","imported","promises","normalizedMain","resolve","main","pathname","test","push","host","readFileContent","nameSpec","spec","buf","contents","decoder","decode","filePath","fire","content","e","console","warn","length","Promise","all","undefined","typingsModuleSpec","_import","dependencies","getCanonicalUrl","unresolvedUrl","resolvedUrl","entries","queue","next","shift","listEntries","entriesAtPath","entry","type","ResolvedEntryKind","Directory","url","path","href","File","pkgJsonPathname","bareModuleUrl","readParentPackageJson","resolvedPkgJson","Error","pkgJsonText","JSON","stringify","packageJson","resolvedName","_importAdjacentTypings","indexOf","_importTypingsFromDefinitelyTyped","error","specs","Object","keys","map","importTypesForSpec","importResults","reduce","result","event","object","enumerableOnly","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","apply","target","i","arguments","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","RELATE_PATH_RX","SPEC_RX","Deferred","token","_this","internalState","promise","promiseResolve","promiseReject","isCancellationRequested","reject","onCancellationRequested","value","reason","get","isBareModuleSpecifier","parseBareModuleSpec","parsed","matches","match","maybeParseBareModuleSpec","concat","traverse","ast","ctx","_ref","visit","node","parent","enter","leave","prop","index","_shouldSkip","shouldSkip","call","context","skipped","childKeys","Array","isArray","j","skip","isArrowFunctionExpression","isFunctionDeclaration","isFunctionExpression","isIdentifier","isMemberExpression","isNodeWithStartAndEnd","start","end","isStringLiteral","isLiteral","parseFile","uri","magicString","code","options","unboundSymbols","Map","locals","nodeEnv","replacements","requires","requireResolves","Set","original","onComment","_isBlock","_test","remove","onToken","addSourcemapLocation","allowReturnOutsideFunction","sourceType","scopingAndRequiresVisitor","collectGlobalsVisitor","err","message","requireDependencies","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","callee","return","requireResolveDependencies","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_node","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","_ref4","_ref3","symbolName","symbolNodes","set","has","_parent","isVariableDeclaration","nextParent","kind","isScope","isBlockScope","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","declarations","declarePattern","id","_parent2","_nextParent2","_locals","declareFunction","isFunction","_locals2","isClassDeclaration","_parent3","_nextParent3","_locals3","isTryStatement","handler","_locals4","param","visitAndCaptureScoping","isIfStatement","isBinaryExpression","l","r","operator","left","right","memberExpressionMatches","replacement","alternate","add","consequent","visitAndSkipBranches","isCallExpression","firstArg","property","_firstArg","visitRequires","isPropertyOfMemberExpression","isProperty","isKeyOfProperty","isBindingIdentifier","foundBinding","declaresArguments","isThisExpression","_foundBinding","_nextParent","declaresThis","_unboundSymbols","params","isObjectPattern","properties","isArrayPattern","elements","isRestElement","argument","isAssignmentPattern","isProgram","isBlockStatement","pattern","memberParts","DependencyKind","Asset","rootHref","unresolvedDependencies","deps","filename","indentExclusionRanges","sourceMappingUrl","str","re","lastMatch","exec","getSourceMappingUrl","asset","endsWith","parse","_href","cssCode","BACKSLASH","charCodeAt","SINGLE_QUOTE","NL","CR","escaped","char","prependRight","prepend","append","getParserForAsset","json","_asset$dependencies","setCode","NODE_CORE_SHIMS","shims","coreLibName","assign","resolveBareModuleToUnpkgWithDetails","_ref5","mark","_callee","parentHref","_ref6","syntheticDependencies","parsedSpec","details","resolvedSpecRoot","unresolvedHref","parentUrl","parentPackageInfo","consolidatedDependencies","builtIn","parsedBuiltInSpec","stableUrl","stableRootUrl","resolveResult","packageInfo","_args","wrap","_context","prev","bareModule","URL","t0","sent","peerDependencies","devDependencies","versionSpec","t1","isBuiltIn","ignored","rootUrl","abrupt","stop","_x","_x2","_x3","_Error","ExtendableError","_this2","constructor","captureStackTrace","stack","_ExtendableError","InvariantViolation","createRuntime","manifest","aliases","create","mappings","modules","registry","addToSet","Runtime","root","Module","self","register","module","exports","HotModule","runtime","dependents","acceptCallbacks","disposeCallbacks","seal","hot","toStringTag","configurable","prototype","alias","dependency","fromId","toId","mappingsForId","getId","init","executeEntrypoints","factory","_alias","entrypoint","entrypoints","require","accept","cb","dispose","dirname","bind","window","Bundle","assets","entrypointsToAssets","dependenciesToAssets","assetsByHref","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","bundle","separator","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","addSource","buildAssetForImmediateExecution","aliasMap","from","acc","_ref7","_ref8","entrypointMap","_ref9","_ref10","runtimeOptions","toString","sourceMap","generateSourceMap","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_iterator7","buildAssetForDeferredExecution","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","_iterator8","_ref15","_ref12","_asset","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_step9","_iterator9","_ref16","_ref14","_name","_asset2","_this$buildForImmedia","buildForImmediateExecution","toDataUri","_buildAssetAndCollect","buildAssetAndCollectDependencies","_this4","inputMap","generateMap","includeContent","hires","seen","remapping","SourceMap","input","file","sourceRoot","names","sources","sourcesContent","encode","indent","clone","trim","_iteratorNormalCompletion10","_didIteratorError10","_iteratorError10","_step10","_iterator10","Require","RequireResolve","InjectedGlobal","exportName","_buildAssetAndCollect2","ResolveDetailsKind","Bundler","EMPTY_MODULE_URL","DEFAULT_SHIM_GLOBALS","Buffer","export","global","process","pendingResolves","onAssetAddedEmitter","onAssetRemovedEmitter","clear","_generateBundle","_callee5","tokenSource","pendingOperations","dfd","enqueue","resolveDependencies","resolveAsset","_loop4","_loop5","idx","_this5","_args5","_context5","cancel","_ref17","_callee2","op","_context2","onEnqueueAsset","onCompleteAsset","setTimeout","isSettled","catch","_","_x5","_ref18","_callee3","_asset$dependencies2","_iteratorNormalCompletion11","_didIteratorError11","_iteratorError11","_loop","_iterator11","_step11","_iteratorNormalCompletion12","_didIteratorError12","_iteratorError12","_loop2","_iterator12","_step12","_iteratorNormalCompletion13","_didIteratorError13","_iteratorError13","_loop3","_iterator13","_step13","_ref20","_context3","dependencyAsset","finish","_ref19","references","shim","t2","splice","_x6","_x7","_ref21","_callee4","fromSpec","resolvedSpec","_context4","resolveWithDetails","getOrCreateAsset","resolvedHref","readCode","_x8","_x9","_x4","_invalidate","_callee6","_ref22","combinedUri","_args6","_context6","removeAsset","_x10","delete","_readCode","_callee7","_ref23","_context7","_x11","_x12","_resolveWithDetails","_callee8","fromUri","_ref24","resolved","bareModuleResolveResult","resolvedUri","_resolvedHref","_context8","BareModule","stableHref","stableRootHref","Relative","_x13","_x14","_x15","_AbstractResolverHost","ResolverHostCompound","hosts","prefix","_ref2","child","startsWith","getResolveRoot","_ref11","InvariantError","TimeoutError","TranspileError","diagnostics","ResolverHostMonaco","rootUri","Monaco","_resolver","getModels","model","modelHref","seenDirs","nestedPath","nextDirIdx","getModel","encoder","TextEncoder","getTranspiledValue","output","getModeId","tryLoadFromWorker","a","typescript","getTypeScriptWorker","workerFactory","workerClient","getEmitOutput","getSyntacticDiagnostics","emitOutput","syntacticDiagnostics","emitSkipped","fsPath","diagnostic","startPosition","getPositionAt","endPosition","flattenDiagnosticMessageText","messageText","lineNumber","column","outputFiles","text","attempt","timeoutMs","race","timeout","Math","pow","getValue","AbstractResolverHost","diag","newLine","EntryNotFoundError","isValidEntry","isValidDirectory","isValidFile","every","UNPKG_SPEC_RX","parseUnpkgUrl","signalFromCancellationToken","AbortControllerConstructor","abortController","abort","signal","ResolverHostUnpkg","contentCache","byteLength","max","inflightContentRequests","packageLock","packageEntriesCache","packageJsonCache","fetch","TypeError","AbortController","_getCanonicalUrl","unresolvedSpec","protocol","hostname","readPackageJsonWithCache","_getResolveRoot","_args2","_listEntries","parentEntry","traversalSegments","_args3","readPackageEntriesWithCache","Boolean","segment","find","basename","_readFileContent","cached","inflight","_args4","redirect","res","ok","status","arrayBuffer","aborted","_readPackageEntriesWithCache","lockKey","lock","packageEntriesCacheForModule","exactMatch","_packageEntries","packageEntries","readPackageEntries","_readPackageJsonWithCache","packageJsonCacheForModule","_packageJson","readPackageJson","_readPackageJson","_ref13","_args7","parseBufferAsPackageJson","_readPackageEntries","_args8","ResolverHostWithCache","idbTimeout","hostTimeout","idbPromise","openDB","schemaVersion","upgrade","db","oldVersion","newVersion","transaction","log","createObjectStore","objectStore","inflightGetCanonicalUrl","inflightGetResolveRoot","inflightListEntries","inflightReadFileContent","getCanonicalUrlCache","getResolveRootCache","listEntriesCache","readFileContentCache","loadFn","cache","inflightMap","storeName","serialize","deserialize","withTimeout","idb","put","withCache","duration","EditorManager","bundler","Resolver","extensions","packageMain","editor","disposableStore","DisposableStore","initialPath","typeAcquirer","viewState","WeakMap","onWillFocusModelEmitter","onDidChangeEmitter","typescriptDefaults","setEagerModelSync","setMaximumWorkerIdleTime","setCompilerOptions","allowJs","allowNonTsExtensions","allowSyntheticDefaultImports","baseUrl","checkJs","esModuleInterop","experimentalDecorators","inlineSourceMap","inlineSources","isolatedModules","jsx","JsxEmit","React","lib","ModuleKind","CommonJS","moduleResolution","ModuleResolutionKind","NodeJs","noEmit","outDir","resolveJsonModule","rootDir","ScriptTarget","ES2015","typeRoots","setDiagnosticsOptions","noSemanticValidation","noSyntaxValidation","createModel","onDidCreateModel","onDidChangePackageJson","typescriptVersion","importTypesForSpecs","throttler","ThrottledDelayer","trigger","onDidChangeContent","onTypeFile","addExtraLib","language","inferLanguage","getModelByHref","focusModel","setModel","revealLineInCenter","ScrollType","Smooth","setPosition","columnNumber","markers","setModelMarkers","focus","getModelByPath","el","automaticLayout","showUnused","scrollBeyondLastLine","theme","wordWrap","wrappingIndent","onDidDispose","onDidChangeModel","newModelUrl","restoreViewState","onDidBlurEditorText","saveViewState","focusPath","EditorManagerContext","createContext","Editor","className","useRef","editorManager","useContext","useEffect","current","mount","ref","PreviewProgress","props","total","round","completed","PreviewIframeWrap","PreviewWrap","PreviewMessageError","PreviewMessageErrorText","isInternal","PreviewMessages","PreviewMessageLine","line","PreviewMessage","lines","Preview","invalidations","previewWrapRef","hmrClientRef","previewIframeRef","useState","messages","setMessages","buildProgress","setBuildProgress","runtimeBundleString","disposable","delayer","Delayer","Throttler","CancellationTokenSource","queueRefreshPreview","uris","refreshPreview","toInvalidate","building","invalidate","generateBundle","createBundleRuntime","runtimeBundle","unresolvedEntrypointHref","resolvedEntrypoint","resolvedEntrypointHref","build","CanceledError","send","updatedBundleFile","updatedBundleHref","createObjectURL","Event","toPromise","onReload","bundledCode","runtimeFile","bundleFile","markup","htmlUrl","iframe","document","createElement","style","display","src","appendChild","onload","onerror","onWillDisposeModel","onMessage","contentWindow","data","payload","fileName","row","getLineContent","MessagePort","HmrClient","debug","addEventListener","removeEventListener","ReactErrorOverlay","velcroRequire","channel","MessageChannel","setEditorHandler","postMessage","startReportingRuntimeErrors","onError","port2","onmessage","dismissRuntimeErrors","reportBuildError","val","isString","isValidReload","dismissBuildError","reload","__velcroRuntime","requireReload","disposeCallback","acceptCallback","m","script","toReload","head","port1","EntryKind","port","onReloadEmitter","close","Entry","modelFocused","color","cursor","backgroundColor","CreateEntry","SidebarFileDelete","Button","StyledTooltip","SidebarFile","activeModel","workbench","setActiveModel","trackEditor","onDidFocusEditorText","hasTextFocus","onDidCreateEditor","useActiveModel","tooltip","useTooltipState","gutter","onClick","TooltipReference","as","role","aria-label","Tooltip","Sidebar","sortEntries","models","sort","b","initialEntries","modelUri","setEntries","findIndex","useDirectory","prompt","onClickCreate","App","project","Provider","isLocalhost","location","config","navigator","origin","swUrl","headers","response","contentType","serviceWorker","ready","registration","unregister","registerValidSW","checkValidServiceWorker","onupdatefound","installingWorker","installing","onstatechange","state","controller","onUpdate","onSuccess","react","AppWrap","Notifications","AlertDialog","Dialog","OnlineNotification","onDismiss","dialog","useDialogState","visible","hideOnClickOutside","hideOnEsc","modal","UpdatedNotification","notification","waitingServiceWorker","waiting","ReactDOM","render","notifications","setNotifications","newNotifications","n","removeNotification","Portal","children","getElementById","ownKeys","_objectSpread","hasInvalidOptionalStringField","field","hasInvalidDependenciesField","CHAR_DOT","CHAR_FORWARD_SLASH","TRAILING_SLASH_RX","ensureTrailingSlash","browser","hasInvalidBrowserField","isValidPackageJson","parseTextAsPackageJson","getFirstPathSegmentAfterPrefix","childHref","parentOffset","validateString","ext","matchedSlash","extIdx","firstNonSlashEnd","isPathSeparator","extname","startDot","startPart","preDotState","len","rootEnd","offset","last","resolvedPath","resolvedAbsolute","allowAboveRoot","lastSegmentLength","lastSlash","dots","lastSlashIndex","lastIndexOf","normalizeString","freeze","__proto__","initialSegment","Decoder","TextDecoder","TRAILING_SLASH_RX$1","defaultExtensions","_resolve","optionsWithDefaults","canonicalUrlPromise","canonicalUrl","rootHrefWithoutTrailingSlash","canonicalHref","ignoreBrowserOverrides","resolveAsDirectory","resolveAsFile","_resolveAsDirectory","mainPathname","packageJsonEntry","packageJsonContent","mainUrl","_resolveAsFile","parentPackageJson","browserOverrides","browserMap","packageJsonDir","impliedUrl","targetSpec","containingUrl","entryDirectoryMap","entryFileMap","_entry","childFilename","_childFilename","mapping","_match","includes","t3","t4","_readParentPackageJson","hostRootUrl","hostRootHref","containingDirUrl","readPackageJsonOrRecurse","_this3","dir","parentPackageJsonContent","parentDir"],"mappings":"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","file":"static/js/main.63efb29b.chunk.js","sourcesContent":["import { util, Resolver, PackageJson, ResolvedEntryKind, ResolverHost } from '@velcro/resolver';\n\nimport { Emitter, Event } from 'ts-primitives';\nimport { BareModuleSpec } from '@velcro/resolver-host-unpkg';\n\nconst HAS_D_TS_EXTENSION = /\\.d\\.ts$/;\n\nenum PackageEntryKind {\n  Directory = 'directory',\n  File = 'file',\n}\n\ninterface PackageDirectoryEntry {\n  type: PackageEntryKind.Directory;\n  path: string;\n  files: PackageEntry[];\n}\n\ninterface PackageFileEntry {\n  type: PackageEntryKind.File;\n  path: string;\n}\n\ninterface TypingsFiles {\n  [fileName: string]: string;\n}\n\ntype PackageEntry = PackageDirectoryEntry | PackageFileEntry;\n\nfunction getTypingsModuleSpec(pkgJson: { name: string; version?: string }): { name: string; range: string } {\n  const typingsName = pkgJson.name.charAt(0) === '@' ? pkgJson.name.slice(1).replace('/', '__') : pkgJson.name;\n\n  let typingsRange = '*';\n\n  if (pkgJson.version) {\n    const major = pkgJson.version.split('.')[0];\n    typingsRange = `${major}.x`;\n  }\n\n  return {\n    name: `@types/${typingsName}`,\n    range: typingsRange,\n  };\n}\n\ninterface TypeFile {\n  pathname: string;\n  content: string;\n}\n\nexport class TypeAcquirer {\n  private _onTypeFile = new Emitter<TypeFile>();\n\n  constructor(\n    private readonly resolver: Resolver,\n    private readonly resolveBareModule: (resolver: ResolverHost, spec: BareModuleSpec) => URL\n  ) {}\n\n  private _importAdjacentTypings(\n    typingsFiles: TypingsFiles,\n    pkgJson: PackageJson,\n    parentPath: string\n  ): Promise<boolean> {\n    // console.log('_importAdjacentTypings', pkgJson.name, pkgJson.version, parentPath);\n    const moduleRoot = util.join(parentPath, `node_modules/${pkgJson.name}/`);\n\n    if (!pkgJson.name) {\n      return Promise.resolve(false);\n    }\n\n    return this._listFiles(pkgJson.name, pkgJson.version).then(files => {\n      let imported = false;\n      const promises: Promise<void>[] = [];\n      const normalizedMain = util.resolve('/', pkgJson.main || 'index.js');\n\n      for (const pathname in files) {\n        if (!(normalizedMain === pathname || HAS_D_TS_EXTENSION.test(pathname))) {\n          continue;\n        }\n\n        promises.push(\n          this.resolver.host\n            .readFileContent(\n              this.resolver,\n              this.resolveBareModule(this.resolver.host, {\n                name: pkgJson.name!,\n                nameSpec: `${pkgJson.name}@${pkgJson.version}`,\n                pathname,\n                spec: pkgJson.version!,\n              })\n            )\n            .then(\n              // eslint-disable-next-line no-loop-func\n              buf => {\n                const contents = this.resolver.decoder.decode(buf);\n                const filePath = util.join(moduleRoot, pathname);\n                typingsFiles[filePath] = contents;\n\n                this._onTypeFile.fire({\n                  pathname: filePath,\n                  content: contents,\n                });\n\n                if (normalizedMain !== pathname) {\n                  imported = true;\n                }\n              },\n              e => {\n                console.warn(e);\n              }\n            )\n        );\n      }\n\n      if (!promises.length) {\n        return imported;\n      }\n\n      return Promise.all(promises).then(() => imported);\n    });\n  }\n\n  // private async _importEmbeddedTypings(\n  //   typingsFiles: TypingsFiles,\n  //   pkgJson: PackageJsonWithTypings,\n  //   parentPath: string\n  // ) {\n  //   let filesPromise: Promise<{ [fileName: string]: PackageFileEntry }> | undefined;\n  //   const readFiles = () => {\n  //     if (!filesPromise) {\n  //       filesPromise = this._listFiles(pkgJson.name, pkgJson.version);\n  //     }\n  //     return filesPromise;\n  //   };\n  //   const visitTypingsFile = async (fileName: string) => {\n  //     if (seen.has(fileName)) return;\n  //     seen.add(fileName);\n  //     console.log('visiting', fileName);\n  //     // Load the contents and add it to the known models\n  //     const sourceText = await this._readUnpkgFile(pkgJson.name, pkgJson.version, pkgJson.typings);\n  //     console.log('addExtraLib', sourceText, fileName);\n  //     typingsFiles[join(parentPath, fileName)] = sourceText;\n  //     const sourceFile = typescript.createSourceFile(fileName, sourceText, typescript.ScriptTarget.Latest, true);\n  //     const children: string[] = [];\n  //     typescript.forEachChild(sourceFile, child => {\n  //       if (typescript.isImportDeclaration(child) && typescript.isStringLiteral(child.moduleSpecifier)) {\n  //         children.push(child.moduleSpecifier.text);\n  //       } else if (\n  //         typescript.isExportDeclaration(child) &&\n  //         child.moduleSpecifier &&\n  //         child.moduleSpecifier &&\n  //         typescript.isStringLiteral(child.moduleSpecifier)\n  //       ) {\n  //         children.push(child.moduleSpecifier.text);\n  //       }\n  //     });\n  //     // We will figure out dependencies outside this module by building the optimized npm\n  //     // dependency tree\n  //     const relativeChildren = children.filter(ref => ref.charAt(0) === '.');\n  //     if (relativeChildren.length) {\n  //       const currentDir = dirname(fileName);\n  //       const files = await readFiles();\n  //       await Promise.all(\n  //         relativeChildren.map(ref => {\n  //           const childPathReference = resolve(currentDir, ref);\n  //           const childPath = resolveImportPath(files, childPathReference);\n  //           if (childPath) {\n  //             return visitTypingsFile(childPath);\n  //           }\n  //         })\n  //       );\n  //     }\n  //   };\n  //   const seen = new Set<string>();\n  //   const typescript = await import('typescript');\n  //   await visitTypingsFile(pkgJson.typings);\n  // }\n\n  private async _importTypingsFromDefinitelyTyped(\n    files: TypingsFiles,\n    pkgJson: PackageJson,\n    parentPath: string\n  ): Promise<void> {\n    // console.log('_importTypingsFromDefinitelyTyped', pkgJson.name, pkgJson.version, parentPath);\n    if (!pkgJson.name) {\n      return undefined;\n    }\n\n    const typingsModuleSpec = getTypingsModuleSpec({ name: pkgJson.name, version: pkgJson.version });\n\n    try {\n      const pkgJson = await this._import(files, typingsModuleSpec.name, typingsModuleSpec.range, parentPath);\n\n      if (pkgJson.dependencies) {\n        for (const name in pkgJson.dependencies) {\n          await this._import(files, name, pkgJson.dependencies[name], parentPath);\n        }\n      }\n    } catch (e) {\n      return undefined;\n    }\n  }\n\n  private async _listFiles(\n    name: string,\n    version: string = 'latest'\n  ): Promise<{ [pathname: string]: PackageFileEntry }> {\n    const unresolvedUrl = await this.resolver.host.getCanonicalUrl(\n      this.resolver,\n      this.resolveBareModule(this.resolver.host, {\n        name,\n        spec: version,\n        nameSpec: `${name}@${version}`,\n        pathname: '/',\n      })\n    );\n    const resolvedUrl = await this.resolver.host.getCanonicalUrl(this.resolver, unresolvedUrl);\n    const entries: { [pathname: string]: PackageFileEntry } = {};\n    const queue = [resolvedUrl];\n\n    while (queue.length) {\n      const next = queue.shift()!;\n      const entriesAtPath = await this.resolver.host.listEntries(this.resolver, next);\n\n      for (const entry of entriesAtPath) {\n        if (entry.type === ResolvedEntryKind.Directory) {\n          queue.push(entry.url);\n        } else {\n          const path = entry.url.href.slice(resolvedUrl.href.length - 1);\n          entries[path] = { type: PackageEntryKind.File, path };\n        }\n      }\n    }\n\n    return entries;\n  }\n\n  private async _import(\n    files: TypingsFiles,\n    name: string,\n    range: string,\n    parentPath: string = ''\n  ): Promise<PackageJson> {\n    // console.log('_import', name, range, parentPath);\n\n    const pkgJsonPathname = util.join(parentPath, 'node_modules', name, 'package.json');\n    const bareModuleUrl = this.resolveBareModule(this.resolver.host, {\n      name,\n      spec: range,\n      nameSpec: `${name}@${range}`,\n      pathname: '/package.json',\n    });\n    const resolvedPkgJson = await this.resolver.readParentPackageJson(bareModuleUrl);\n\n    if (!resolvedPkgJson) {\n      throw new Error(`Unable to load package.json for ${name}@${range}`);\n    }\n\n    const pkgJsonText = JSON.stringify(resolvedPkgJson.packageJson);\n    const resolvedName = resolvedPkgJson.packageJson.name || name;\n\n    files[pkgJsonPathname] = pkgJsonText;\n\n    this._onTypeFile.fire({\n      pathname: pkgJsonPathname,\n      content: pkgJsonText,\n    });\n\n    // if (isPackageJsonWithTypings(pkgJson)) {\n    //   await this._importEmbeddedTypings(files, pkgJson, parentPath);\n    // } else {\n    try {\n      const hasAdjacentTypings = await this._importAdjacentTypings(files, resolvedPkgJson.packageJson!, parentPath);\n\n      // console.log('hasAdjacentTypings', hasAdjacentTypings);\n\n      if (!hasAdjacentTypings && resolvedName.indexOf('@types/') !== 0) {\n        await this._importTypingsFromDefinitelyTyped(files, resolvedPkgJson.packageJson, parentPath);\n      }\n    } catch (err) {\n      console.error('error', err);\n    }\n    // }\n\n    return resolvedPkgJson.packageJson;\n  }\n\n  get onTypeFile(): Event<TypeFile> {\n    return this._onTypeFile.event;\n  }\n\n  async importTypesForSpec(name: string, range: string = 'latest', parentPath: string = ''): Promise<TypingsFiles> {\n    const files: TypingsFiles = {};\n\n    try {\n      await this._import(files, name, range, parentPath);\n    } catch (err) {\n      console.warn(err, `Type acquisition failed for ${name}@${range}`);\n    }\n\n    return files;\n  }\n\n  async importTypesForSpecs(specs: { [name: string]: string }, parentPath: string = ''): Promise<TypingsFiles> {\n    const promises = Object.keys(specs).map(name => this.importTypesForSpec(name, specs[name], parentPath));\n    const importResults = promises.length ? await Promise.all(promises) : [];\n\n    return importResults.reduce((files, result) => ({ ...files, ...result }), {} as TypingsFiles);\n  }\n}\n","import _possibleConstructorReturn from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _wrapNativeSuper from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper\";\nimport _regeneratorRuntime from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Emitter } from 'ts-primitives';\nexport { CancellationToken, CancellationTokenSource } from 'ts-primitives';\nimport MagicString, { Bundle as Bundle$1 } from 'magic-string';\nimport { CanceledError, CancellationTokenSource, EntryNotFoundError } from '@velcro/resolver';\nimport { parse as parse$1 } from 'acorn';\nimport remapping from '@ampproject/remapping';\nimport { Base64 } from 'js-base64';\nvar RELATE_PATH_RX = /^[./]|^[a-z_-]+:/;\nvar SPEC_RX = /^((@[^/]+\\/[^/@]+|[^./@][^/@]*)(?:@([^/]+))?)(.*)?$/;\n\nvar Deferred =\n/*#__PURE__*/\nfunction () {\n  function Deferred(token) {\n    var _this = this;\n\n    _classCallCheck(this, Deferred);\n\n    this.internalState = 'pending';\n    this.promise = new Promise(function (promiseResolve, promiseReject) {\n      _this.promiseResolve = promiseResolve;\n      _this.promiseReject = promiseReject;\n    });\n\n    if (token) {\n      if (token.isCancellationRequested) {\n        this.reject(new CanceledError('Canceled'));\n      } else {\n        token.onCancellationRequested(function () {\n          _this.reject(new CanceledError('Canceled'));\n        });\n      }\n    }\n  }\n\n  _createClass(Deferred, [{\n    key: \"resolve\",\n    value: function resolve(value) {\n      this.internalState = 'resolved';\n      this.promiseResolve(value);\n    }\n  }, {\n    key: \"reject\",\n    value: function reject(reason) {\n      this.internalState = 'rejected';\n      this.promiseReject(reason);\n    }\n  }, {\n    key: \"isSettled\",\n    get: function get() {\n      return this.internalState !== 'pending';\n    }\n  }, {\n    key: \"state\",\n    get: function get() {\n      return this.internalState;\n    }\n  }]);\n\n  return Deferred;\n}();\n\nfunction isBareModuleSpecifier(spec) {\n  return !RELATE_PATH_RX.test(spec);\n}\n\nfunction maybeParseBareModuleSpec(spec) {\n  /**\r\n   * 1: scope + name + version\r\n   * 2: scope + name\r\n   * 3: version?\r\n   * 4: pathname\r\n   */\n  var matches = spec.match(SPEC_RX);\n\n  if (!matches) {\n    return undefined;\n  }\n\n  return {\n    nameSpec: matches[1],\n    name: matches[2],\n    spec: matches[3] || '',\n    pathname: matches[4] || ''\n  };\n}\n\nfunction parseBareModuleSpec(spec) {\n  var parsed = maybeParseBareModuleSpec(spec);\n\n  if (!parsed) {\n    throw new Error(\"Unable to parse unexpected unpkg url: '\".concat(spec, \"'\"));\n  }\n\n  return parsed;\n} // this looks ridiculous, but it prevents sourcemap tooling from mistaking\n// this for an actual sourceMappingURL\n\n\nfunction getSourceMappingUrl(str) {\n  var re = /(?:\\/\\/[@#][\\s]*(?:source)MappingURL=([^\\s'\"]+)[\\s]*$)|(?:\\/\\*[@#][\\s]*(?:source)MappingURL=([^\\s*'\"]+)[\\s]*(?:\\*\\/)[\\s]*$)/gm; // Keep executing the search to find the *last* sourceMappingURL to avoid\n  // picking up sourceMappingURLs from comments, strings, etc.\n\n  var lastMatch = null;\n  var match;\n\n  while (match = re.exec(str)) {\n    lastMatch = match;\n  }\n\n  if (!lastMatch) return undefined;\n  return lastMatch[1];\n}\n\nfunction traverse(ast, ctx, _ref) {\n  var enter = _ref.enter,\n      leave = _ref.leave;\n  visit(ast, null, ctx, enter, leave);\n}\n\nvar shouldSkip = false;\nvar context = {\n  skip: function skip() {\n    return shouldSkip = true;\n  }\n};\nvar childKeys = {};\n\nfunction visit(node, parent, ctx, enter, leave, prop, index) {\n  if (!node) return;\n  node.parent = parent;\n\n  if (enter) {\n    var _shouldSkip = shouldSkip;\n    shouldSkip = false;\n    enter.call(context, node, parent, ctx, prop, index);\n    var skipped = shouldSkip;\n    shouldSkip = _shouldSkip;\n    if (skipped) return;\n  }\n\n  var keys = childKeys[node.type] || (childKeys[node.type] = Object.keys(node).filter(function (key) {\n    return key !== 'parent' && typeof node[key] === 'object';\n  }));\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = node[key];\n\n    if (Array.isArray(value)) {\n      for (var j = 0; j < value.length; j++) {\n        visit(value[j], node, ctx, enter, leave, key, j);\n      }\n    } else if (value && value.type) {\n      visit(value, node, ctx, enter, leave, key);\n    }\n  }\n\n  if (leave) {\n    leave(node, parent, ctx, prop, index);\n  }\n}\n\nfunction isArrowFunctionExpression(node) {\n  return node.type === 'ArrowFunctionExpression';\n}\n\nfunction isArrayPattern(node) {\n  return node.type === 'ArrayPattern';\n}\n\nfunction isAssignmentPattern(node) {\n  return node.type === 'AssignmentPattern';\n}\n\nfunction isBinaryExpression(node) {\n  return node.type === 'BinaryExpression';\n}\n\nfunction isBlockStatement(node) {\n  return node.type === 'BlockStatement';\n}\n\nfunction isCallExpression(node) {\n  return node.type === 'CallExpression';\n}\n\nfunction isClassDeclaration(node) {\n  return node.type === 'ClassDeclaration';\n}\n\nfunction isFunctionDeclaration(node) {\n  return node.type === 'FunctionDeclaration';\n}\n\nfunction isFunctionExpression(node) {\n  return node.type === 'FunctionExpression';\n}\n\nfunction isIdentifier(node) {\n  return node.type === 'Identifier';\n}\n\nfunction isIfStatement(node) {\n  return node.type === 'IfStatement';\n}\n\nfunction isLiteral(node) {\n  return node.type === 'Literal';\n}\n\nfunction isMemberExpression(node) {\n  return node.type === 'MemberExpression';\n}\n\nfunction isNodeWithStartAndEnd(node) {\n  return typeof node.start === 'number' && typeof node.end === 'number';\n}\n\nfunction isObjectPattern(node) {\n  return node.type === 'ObjectPattern';\n}\n\nfunction isProperty(node) {\n  return node.type === 'Property';\n}\n\nfunction isRestElement(node) {\n  return node.type === 'RestElement';\n}\n\nfunction isProgram(node) {\n  return node.type === 'Program';\n}\n\nfunction isThisExpression(node) {\n  return node.type === 'ThisExpression';\n}\n\nfunction isTryStatement(node) {\n  return node.type === 'TryStatement';\n}\n\nfunction isVariableDeclaration(node) {\n  return node.type === 'VariableDeclaration';\n} // Refinements or groups\n\n\nfunction isFunction(node) {\n  return isFunctionDeclaration(node) || isFunctionExpression(node) || isArrowFunctionExpression(node);\n}\n\nfunction isStringLiteral(node) {\n  return isLiteral(node) && typeof node.value === 'string';\n}\n\nfunction parse(code, options) {\n  return parse$1(code, _objectSpread({}, options, {\n    allowReturnOutsideFunction: true,\n    sourceType: 'script'\n  }));\n}\n\nfunction parseFile(uri, magicString) {\n  var ctx = {\n    unboundSymbols: new Map(),\n    locals: new Map(),\n    nodeEnv: 'development',\n    replacements: [],\n    requires: [],\n    requireResolves: [],\n    skip: new Set()\n  };\n\n  try {\n    // let lastToken: acorn.Token | undefined = undefined;\n    var ast = parse(magicString.original, {\n      onComment: function onComment(_isBlock, _test, start, end) {\n        magicString.remove(start, end);\n      },\n      onToken: function onToken(token) {\n        magicString.addSourcemapLocation(token.start); // const wsStart = lastToken ? lastToken.end : 0;\n        // if (wsStart < token.start - 1) {\n        //   const between = magicString.original.substring(wsStart, token.start);\n        //   if (whitespaceRx.test(between)) {\n        //     magicString.overwrite(wsStart, token.start - 1, ' ');\n        //   }\n        // }\n        // lastToken = token;\n      }\n    });\n    traverse(ast, ctx, scopingAndRequiresVisitor);\n    traverse(ast, ctx, collectGlobalsVisitor);\n  } catch (err) {\n    throw new Error(\"Error parsing \".concat(uri, \": \").concat(err.message));\n  }\n\n  var requireDependencies = [];\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = ctx.requires[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var node = _step.value;\n      requireDependencies.push({\n        callee: _objectSpread({}, node.callee),\n        spec: _objectSpread({}, node.spec)\n      });\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return != null) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  var requireResolveDependencies = [];\n  var _iteratorNormalCompletion2 = true;\n  var _didIteratorError2 = false;\n  var _iteratorError2 = undefined;\n\n  try {\n    for (var _iterator2 = ctx.requireResolves[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n      var _node = _step2.value;\n      requireResolveDependencies.push({\n        callee: _objectSpread({}, _node.callee),\n        spec: _objectSpread({}, _node.spec)\n      });\n    }\n  } catch (err) {\n    _didIteratorError2 = true;\n    _iteratorError2 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n        _iterator2.return();\n      }\n    } finally {\n      if (_didIteratorError2) {\n        throw _iteratorError2;\n      }\n    }\n  }\n\n  var unboundSymbols = new Map();\n  var _iteratorNormalCompletion3 = true;\n  var _didIteratorError3 = false;\n  var _iteratorError3 = undefined;\n\n  try {\n    for (var _iterator3 = ctx.unboundSymbols[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n      var _ref4 = _step3.value;\n\n      var _ref3 = _slicedToArray(_ref4, 2);\n\n      var symbolName = _ref3[0];\n      var symbolNodes = _ref3[1];\n      unboundSymbols.set(symbolName, symbolNodes.map(function (node) {\n        return {\n          start: node.start,\n          end: node.end\n        };\n      }));\n    }\n  } catch (err) {\n    _didIteratorError3 = true;\n    _iteratorError3 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n        _iterator3.return();\n      }\n    } finally {\n      if (_didIteratorError3) {\n        throw _iteratorError3;\n      }\n    }\n  }\n\n  return {\n    requireDependencies: requireDependencies,\n    requireResolveDependencies: requireResolveDependencies,\n    unboundSymbols: unboundSymbols\n  };\n}\n\nvar scopingAndRequiresVisitor = {\n  enter: function enter(node, parent, ctx) {\n    if (ctx.skip.has(node)) {\n      return this.skip();\n    }\n\n    visitAndCaptureScoping(node, parent, ctx);\n    visitAndSkipBranches(node, parent, ctx);\n    visitRequires(node, parent, ctx);\n  }\n};\nvar collectGlobalsVisitor = {\n  enter: function enter(node, _parent, ctx) {\n    if (isBindingIdentifier(node) && isIdentifier(node)) {\n      var name = node.name;\n      if (name === 'undefined') return;\n      var foundBinding = false;\n      var nextParent = node.parent;\n\n      while (nextParent) {\n        if (name === 'arguments' && declaresArguments(nextParent)) {\n          foundBinding = true;\n          break;\n        }\n\n        var locals = ctx.locals.get(nextParent);\n\n        if (locals && locals[name]) {\n          foundBinding = true;\n          break;\n        }\n\n        nextParent = nextParent.parent;\n      }\n\n      if (!foundBinding && isNodeWithStartAndEnd(node)) {\n        var unboundSymbols = ctx.unboundSymbols.get(name);\n\n        if (!unboundSymbols) {\n          unboundSymbols = [];\n          ctx.unboundSymbols.set(name, unboundSymbols);\n        }\n\n        unboundSymbols.push(node);\n      }\n    } else if (isThisExpression(node)) {\n      var _foundBinding = false;\n      var _nextParent = node.parent;\n\n      while (_nextParent) {\n        if (declaresThis(_nextParent)) {\n          _foundBinding = true;\n          break;\n        }\n\n        _nextParent = _nextParent.parent;\n      }\n\n      if (!_foundBinding && isNodeWithStartAndEnd(node)) {\n        var _unboundSymbols = ctx.unboundSymbols.get('this');\n\n        if (!_unboundSymbols) {\n          _unboundSymbols = [];\n          ctx.unboundSymbols.set('this', _unboundSymbols);\n        }\n\n        _unboundSymbols.push(node);\n      }\n    }\n  }\n};\n\nfunction visitAndCaptureScoping(node, _parent, ctx) {\n  if (isVariableDeclaration(node)) {\n    var parent;\n    var nextParent = node.parent;\n\n    while (nextParent) {\n      if (node.kind === 'var' ? isScope(nextParent) : isBlockScope(nextParent)) {\n        parent = nextParent;\n        break;\n      }\n\n      nextParent = nextParent.parent;\n    }\n\n    if (!parent) {\n      throw new Error(\"Invariant violation: Failed to find a parent\");\n    }\n\n    var locals = ctx.locals.get(parent);\n\n    if (!locals) {\n      locals = {};\n      ctx.locals.set(parent, locals);\n    }\n\n    var _iteratorNormalCompletion4 = true;\n    var _didIteratorError4 = false;\n    var _iteratorError4 = undefined;\n\n    try {\n      for (var _iterator4 = node.declarations[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n        var declaration = _step4.value;\n        declarePattern(declaration.id, locals);\n      }\n    } catch (err) {\n      _didIteratorError4 = true;\n      _iteratorError4 = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion4 && _iterator4.return != null) {\n          _iterator4.return();\n        }\n      } finally {\n        if (_didIteratorError4) {\n          throw _iteratorError4;\n        }\n      }\n    }\n  } else if (isFunctionDeclaration(node)) {\n    var _parent2;\n\n    var _nextParent2 = node.parent;\n\n    if (_nextParent2 && _nextParent2.parent) {\n      _nextParent2 = _nextParent2.parent;\n    }\n\n    while (_nextParent2) {\n      if (isScope(_nextParent2)) {\n        _parent2 = _nextParent2;\n        break;\n      }\n\n      _nextParent2 = _nextParent2.parent;\n    }\n\n    if (!_parent2) {\n      throw new Error(\"Invariant violation: Failed to find a parent\");\n    }\n\n    var _locals = ctx.locals.get(_parent2);\n\n    if (!_locals) {\n      _locals = {};\n      ctx.locals.set(_parent2, _locals);\n    }\n\n    declareFunction(node, _locals);\n  } else if (isFunction(node)) {\n    var _locals2 = ctx.locals.get(node);\n\n    if (!_locals2) {\n      _locals2 = {};\n      ctx.locals.set(node, _locals2);\n    }\n\n    declareFunction(node, _locals2);\n  } else if (isClassDeclaration(node) && node.id) {\n    var _parent3;\n\n    var _nextParent3 = node.parent;\n\n    if (_nextParent3 && _nextParent3.parent) {\n      _nextParent3 = _nextParent3.parent;\n    }\n\n    while (_nextParent3) {\n      if (isScope(_nextParent3)) {\n        _parent3 = _nextParent3;\n        break;\n      }\n\n      _nextParent3 = _nextParent3.parent;\n    }\n\n    if (!_parent3) {\n      throw new Error(\"Invariant violation: Failed to find a parent\");\n    }\n\n    var _locals3 = ctx.locals.get(_parent3);\n\n    if (!_locals3) {\n      _locals3 = {};\n      ctx.locals.set(_parent3, _locals3);\n    }\n\n    _locals3[node.id.name] = true;\n  } else if (isTryStatement(node)) {\n    if (node.handler) {\n      var _locals4 = ctx.locals.get(node.handler);\n\n      if (!_locals4) {\n        _locals4 = {};\n        ctx.locals.set(node.handler, _locals4);\n      }\n\n      declarePattern(node.handler.param, _locals4);\n    }\n  }\n}\n\nfunction visitAndSkipBranches(node, _parent, ctx) {\n  if (isIfStatement(node) && isBinaryExpression(node.test)) {\n    var tests = {\n      '!=': function _(l, r) {\n        return l != r;\n      },\n      '!==': function _(l, r) {\n        return l !== r;\n      },\n      '==': function _(l, r) {\n        return l == r;\n      },\n      '===': function _(l, r) {\n        return l === r;\n      }\n    };\n    var test = tests[node.test.operator];\n\n    if (test) {\n      if (isStringLiteral(node.test.left) && isMemberExpression(node.test.right) && memberExpressionMatches(node.test.right, 'process.env.NODE_ENV')) {\n        // if ('development' === process.env.NODE_ENV) {}\n        ctx.replacements.push({\n          start: node.test.right.start,\n          end: node.test.right.end,\n          replacement: JSON.stringify(ctx.nodeEnv)\n        });\n\n        if (!test(node.test.left.value, ctx.nodeEnv)) {\n          ctx.skip.add(node.consequent);\n        } else if (node.alternate) {\n          ctx.skip.add(node.alternate);\n        }\n      } else if (isStringLiteral(node.test.right) && isMemberExpression(node.test.left) && memberExpressionMatches(node.test.left, 'process.env.NODE_ENV')) {\n        // if (process.env.NODE_ENV === 'development') {}\n        ctx.replacements.push({\n          start: node.test.left.start,\n          end: node.test.left.end,\n          replacement: JSON.stringify(ctx.nodeEnv)\n        });\n\n        if (!test(node.test.right.value, ctx.nodeEnv)) {\n          ctx.skip.add(node.consequent);\n        } else if (node.alternate) {\n          ctx.skip.add(node.alternate);\n        }\n      }\n    }\n  }\n}\n\nfunction visitRequires(node, _parent, ctx) {\n  if (isCallExpression(node) && isNodeWithStartAndEnd(node.callee)) {\n    var callee = node.callee;\n\n    if (isIdentifier(callee) && isNodeWithStartAndEnd(callee) && callee.name === 'require') {\n      var firstArg = node.arguments[0];\n\n      if (isStringLiteral(firstArg) && isNodeWithStartAndEnd(firstArg)) {\n        ctx.requires.push({\n          spec: {\n            start: firstArg.start,\n            end: firstArg.end,\n            value: firstArg.value\n          },\n          callee: {\n            start: callee.start,\n            end: callee.end\n          }\n        });\n      } else {\n        console.warn('Non string-literal first arg to require', firstArg);\n      }\n    } else if (isMemberExpression(callee) && isIdentifier(callee.object) && callee.object.name === 'require' && isIdentifier(callee.property) && callee.property.name === 'resolve') {\n      var _firstArg = node.arguments[0];\n\n      if (isStringLiteral(_firstArg) && isNodeWithStartAndEnd(_firstArg)) {\n        ctx.requireResolves.push({\n          spec: {\n            start: _firstArg.start,\n            end: _firstArg.end,\n            value: _firstArg.value\n          },\n          callee: {\n            start: callee.start,\n            end: callee.end\n          }\n        });\n      } else {\n        console.warn('Non string-literal first arg to require.resolve', _firstArg);\n      }\n    }\n  }\n}\n\nfunction declareFunction(node, locals) {\n  node.params.forEach(function (node) {\n    declarePattern(node, locals);\n  });\n\n  if (node.id) {\n    locals[node.id.name] = true;\n  }\n}\n\nfunction declarePattern(node, locals) {\n  if (isIdentifier(node)) {\n    locals[node.name] = true;\n  } else if (isObjectPattern(node)) {\n    node.properties.forEach(function (node) {\n      return declarePattern(node.value, locals);\n    });\n  } else if (isArrayPattern(node)) {\n    node.elements.forEach(function (node) {\n      return node && declarePattern(node, locals);\n    });\n  } else if (isRestElement(node)) {\n    declarePattern(node.argument, locals);\n  } else if (isAssignmentPattern(node)) {\n    declarePattern(node.left, locals);\n  } else {\n    throw new Error(\"Invariant violation: Unexpected pattern type: \".concat(node.type));\n  }\n}\n\nfunction isBindingIdentifier(node) {\n  return isIdentifier(node) && !isPropertyOfMemberExpression(node) && !isKeyOfProperty(node);\n}\n\nfunction isKeyOfProperty(node) {\n  return node.parent && isProperty(node.parent) && node.parent.key === node;\n}\n\nfunction isPropertyOfMemberExpression(node) {\n  return node.parent && isMemberExpression(node.parent) && node.parent.object !== node;\n}\n\nfunction isScope(node) {\n  return isFunctionDeclaration(node) || isFunctionExpression(node) || isArrowFunctionExpression(node) || isProgram(node);\n}\n\nfunction isBlockScope(node) {\n  return isBlockStatement(node) || isScope(node);\n}\n\nfunction declaresArguments(node) {\n  return isFunctionDeclaration(node) || isFunctionExpression(node);\n}\n\nfunction declaresThis(node) {\n  return isFunctionDeclaration(node) || isFunctionExpression(node);\n}\n\nfunction memberExpressionMatches(node, pattern) {\n  var memberParts = pattern.split('.');\n\n  if (memberParts.length < 2) {\n    return false;\n  }\n\n  var object = memberParts.shift();\n  var property = memberParts.shift();\n\n  for (var i = memberParts.length - 1; i >= 0; i--) {\n    if (!isIdentifier(node.property) || node.property.name !== memberParts[i]) {\n      return false;\n    }\n\n    if (!isMemberExpression(node.object)) {\n      return false;\n    }\n\n    node = node.object;\n  }\n\n  if (!isIdentifier(node.object) || !isIdentifier(node.property)) {\n    return false;\n  }\n\n  return node.object.name === object && node.property.name === property;\n}\n\nvar Asset =\n/*#__PURE__*/\nfunction () {\n  function Asset(href, rootHref) {\n    _classCallCheck(this, Asset);\n\n    this.href = href;\n    this.rootHref = rootHref;\n    this.dependencies = [];\n    this.unresolvedDependencies = {};\n    this.deps = new Map();\n  }\n\n  _createClass(Asset, [{\n    key: \"setCode\",\n    value: function setCode(code) {\n      this.magicString = new MagicString(code, {\n        filename: this.href,\n        indentExclusionRanges: []\n      });\n      this.sourceMappingUrl = getSourceMappingUrl(code);\n      var parser = getParserForAsset(this);\n      var dependencies = parser.parse(this.href, this.magicString);\n      this.unresolvedDependencies.requireDependencies = dependencies.requireDependencies;\n      this.unresolvedDependencies.requireResolveDependencies = dependencies.requireResolveDependencies;\n      this.unresolvedDependencies.unboundSymbols = dependencies.unboundSymbols;\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        href: this.href,\n        rootHref: this.rootHref,\n        dependencies: this.dependencies,\n        sourceMappingUrl: this.sourceMappingUrl,\n        code: this.magicString ? this.magicString.original : ''\n      };\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(json) {\n      var _asset$dependencies;\n\n      var asset = new Asset(json.href, json.rootHref);\n\n      (_asset$dependencies = asset.dependencies).push.apply(_asset$dependencies, _toConsumableArray(json.dependencies));\n\n      asset.sourceMappingUrl = json.sourceMappingUrl;\n      asset.setCode(json.code);\n      return asset;\n    }\n  }]);\n\n  return Asset;\n}();\n\n(function (Asset) {\n  var DependencyKind;\n\n  (function (DependencyKind) {\n    DependencyKind[\"Require\"] = \"require\";\n    DependencyKind[\"RequireResolve\"] = \"require.resolve\";\n    DependencyKind[\"InjectedGlobal\"] = \"injected_global\";\n  })(DependencyKind = Asset.DependencyKind || (Asset.DependencyKind = {}));\n})(Asset || (Asset = {}));\n\nfunction getParserForAsset(asset) {\n  if (asset.href.endsWith('.css')) {\n    return {\n      parse: function parse(_href, magicString) {\n        var cssCode = magicString.original;\n        var BACKSLASH = '\\\\'.charCodeAt(0);\n        var SINGLE_QUOTE = \"'\".charCodeAt(0);\n        var NL = '\\n'.charCodeAt(0);\n        var CR = '\\r'.charCodeAt(0);\n        var escaped = false;\n\n        for (var i = 0; i < cssCode.length; i++) {\n          var char = cssCode.charCodeAt(i);\n\n          if (char === BACKSLASH) {\n            escaped = !escaped;\n            continue;\n          }\n\n          if (!escaped) {\n            // Escape certain characters (if not already escaped)\n            switch (char) {\n              case CR:\n              case NL:\n              case SINGLE_QUOTE:\n                magicString.prependRight(i, '\\\\');\n                break;\n            }\n          }\n\n          escaped = false;\n        }\n\n        magicString.prepend(\"\\n          function reload(styles){\\n            var styleTag = document.querySelector('head > style[type=\\\"text/css\\\"][data-href=\".concat(JSON.stringify(asset.href), \"]');\\n\\n            if (styleTag && styleTag.parentElement) {\\n              styleTag.parentElement.removeChild(styleTag);\\n            }\\n\\n            styleTag = document.createElement(\\\"style\\\");\\n            styleTag.type = \\\"text/css\\\";\\n            styleTag.dataset.href=\").concat(JSON.stringify(asset.href), \";\\n\\n            styleTag.innerHTML = '\"));\n        magicString.append(\"';\\n            document.head.appendChild(styleTag);\\n          };\\n          reload();\\n\\n          exports.reload = reload;\\n\\n          if (module.hot && module.hot.accept) {\\n            require(\".concat(JSON.stringify(asset.href), \").reload()\\n          }\\n        \"));\n        return {\n          requireDependencies: [],\n          requireResolveDependencies: [],\n          unboundSymbols: new Map()\n        };\n      }\n    };\n  }\n\n  if (asset.href.endsWith('.json')) {\n    return {\n      parse: function parse(_href, magicString) {\n        magicString.prepend('module.exports = ');\n        return {\n          requireDependencies: [],\n          requireResolveDependencies: [],\n          unboundSymbols: new Map()\n        };\n      }\n    };\n  }\n\n  return {\n    parse: parseFile\n  };\n}\n\nvar version = \"0.22.0\";\nvar BARE_MODULE_PREFIX = 'https://unpkg.com/'; // const DEFAULT_SHIM_GLOBALS: { [key: string]: { spec: string; export?: string } } = {\n//   Buffer: {\n//     spec: `@velcro/node-libs@${nodeLibsVersion}/lib/buffer.js`,\n//     export: 'Buffer',\n//   },\n//   global: {\n//     spec: `@velcro/node-libs@${nodeLibsVersion}/lib/global.js`,\n//   },\n//   process: {\n//     spec: `@velcro/node-libs@${nodeLibsVersion}/lib/process.js`,\n//   },\n// };\n\nvar NODE_CORE_SHIMS = ['assert', 'buffer', 'constants', 'crypto', 'events', 'fs', 'http', 'https', 'net', 'os', 'path', 'process', 'querystring', 'stream', 'tls', 'url', 'util', 'vm', 'zlib'].reduce(function (shims, coreLibName) {\n  return Object.assign(shims, _defineProperty({}, coreLibName, \"@velcro/node-libs@\".concat(version, \"/lib/\").concat(coreLibName, \".js\")));\n}, {});\nNODE_CORE_SHIMS['string_decoder'] = 'string_decoder@1.2.0';\nNODE_CORE_SHIMS['punycode'] = 'punycode@2.1.1';\n\nvar resolveBareModuleToUnpkgWithDetails =\n/*#__PURE__*/\nfunction () {\n  var _ref5 = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(resolver, href, parentHref) {\n    var _ref6,\n        syntheticDependencies,\n        token,\n        parsedSpec,\n        details,\n        resolvedSpecRoot,\n        unresolvedHref,\n        parentUrl,\n        parentPackageInfo,\n        consolidatedDependencies,\n        builtIn,\n        parsedBuiltInSpec,\n        stableUrl,\n        stableRootUrl,\n        resolveResult,\n        packageInfo,\n        _args = arguments;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _ref6 = _args.length > 3 && _args[3] !== undefined ? _args[3] : {}, syntheticDependencies = _ref6.syntheticDependencies, token = _ref6.token;\n            parsedSpec = parseBareModuleSpec(href);\n            details = {\n              bareModule: {},\n              resolvedUrl: undefined\n            }; // let resolvedSpec: string | undefined = undefined;\n\n            resolvedSpecRoot = undefined;\n            unresolvedHref = undefined;\n\n            if (!parsedSpec.spec) {\n              _context.next = 9;\n              break;\n            }\n\n            // A manually-specified spec means we should use that instead of looking for a parent package.json\n            resolvedSpecRoot = parsedSpec.nameSpec;\n            _context.next = 32;\n            break;\n\n          case 9:\n            if (!(syntheticDependencies && parsedSpec.name in syntheticDependencies)) {\n              _context.next = 13;\n              break;\n            }\n\n            resolvedSpecRoot = \"\".concat(parsedSpec.name, \"@\").concat(syntheticDependencies[parsedSpec.name]);\n            _context.next = 32;\n            break;\n\n          case 13:\n            if (!parentHref) {\n              _context.next = 32;\n              break;\n            }\n\n            _context.prev = 14;\n            parentUrl = new URL(parentHref);\n            _context.next = 21;\n            break;\n\n          case 18:\n            _context.prev = 18;\n            _context.t0 = _context[\"catch\"](14);\n            throw new Error(\"Error loading bare module \".concat(href, \" because the parent module \").concat(parentHref, \" could not be resolved to a URL\"));\n\n          case 21:\n            _context.prev = 21;\n            _context.next = 24;\n            return resolver.readParentPackageJson(parentUrl, {\n              token: token\n            });\n\n          case 24:\n            parentPackageInfo = _context.sent;\n\n            if (parentPackageInfo) {\n              consolidatedDependencies = _objectSpread({}, parentPackageInfo.packageJson.peerDependencies || {}, {}, parentPackageInfo.packageJson.devDependencies || {}, {}, parentPackageInfo.packageJson.dependencies || {});\n              details.bareModule.versionSpec = consolidatedDependencies[parsedSpec.name];\n\n              if (details.bareModule.versionSpec) {\n                resolvedSpecRoot = \"\".concat(parsedSpec.name, \"@\").concat(details.bareModule.versionSpec);\n              }\n            }\n\n            _context.next = 32;\n            break;\n\n          case 28:\n            _context.prev = 28;\n            _context.t1 = _context[\"catch\"](21);\n\n            if (!(_context.t1 instanceof CanceledError || _context.t1.name === 'CanceledError')) {\n              _context.next = 32;\n              break;\n            }\n\n            throw _context.t1;\n\n          case 32:\n            if (resolvedSpecRoot) {\n              // The name + spec was hard-coded or could be derived from a parent package.json. We just\n              // need to prepend the staic prefix and then append the requested pathname.\n              resolvedSpecRoot = \"\".concat(BARE_MODULE_PREFIX).concat(resolvedSpecRoot);\n              unresolvedHref = \"\".concat(resolvedSpecRoot).concat(parsedSpec.pathname);\n            } else {\n              if (!parentHref) {\n                // There was no parent href from which to derive version constraints so we will take\n                // the provided 'namespec' and prefix it with the static prefix. That will be the root\n                // and the href can be determined by adding the requested pathname.\n                resolvedSpecRoot = \"\".concat(BARE_MODULE_PREFIX).concat(parsedSpec.nameSpec);\n                unresolvedHref = \"\".concat(resolvedSpecRoot).concat(parsedSpec.pathname);\n              } else {\n                builtIn = NODE_CORE_SHIMS[href];\n\n                if (builtIn) {\n                  parsedBuiltInSpec = parseBareModuleSpec(builtIn);\n                  resolvedSpecRoot = \"\".concat(BARE_MODULE_PREFIX).concat(parsedBuiltInSpec.nameSpec);\n                  unresolvedHref = \"\".concat(resolvedSpecRoot).concat(parsedBuiltInSpec.pathname);\n                  details.bareModule.isBuiltIn = true;\n                }\n              }\n            }\n\n            if (!(unresolvedHref && resolvedSpecRoot)) {\n              _context.next = 44;\n              break;\n            }\n\n            stableUrl = new URL(unresolvedHref);\n            stableRootUrl = new URL(resolvedSpecRoot);\n            _context.next = 38;\n            return resolver.resolve(stableUrl, {\n              token: token\n            });\n\n          case 38:\n            resolveResult = _context.sent;\n            details.ignored = resolveResult.ignored;\n            details.stableRootUrl = stableRootUrl;\n            details.stableUrl = stableUrl;\n\n            if (resolveResult.resolvedUrl) {\n              details.resolvedUrl = resolveResult.resolvedUrl;\n            }\n\n            details.rootUrl = resolveResult.rootUrl;\n\n          case 44:\n            if (!details.resolvedUrl) {\n              _context.next = 49;\n              break;\n            }\n\n            _context.next = 47;\n            return resolver.readParentPackageJson(details.resolvedUrl, {\n              token: token\n            });\n\n          case 47:\n            packageInfo = _context.sent;\n\n            if (packageInfo) {\n              details.bareModule.version = packageInfo.packageJson.version;\n            }\n\n          case 49:\n            return _context.abrupt(\"return\", details);\n\n          case 50:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[14, 18], [21, 28]]);\n  }));\n\n  return function resolveBareModuleToUnpkgWithDetails(_x, _x2, _x3) {\n    return _ref5.apply(this, arguments);\n  };\n}();\n\nvar ExtendableError =\n/*#__PURE__*/\nfunction (_Error) {\n  _inherits(ExtendableError, _Error);\n\n  function ExtendableError(message) {\n    var _this2;\n\n    _classCallCheck(this, ExtendableError);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(ExtendableError).call(this, message));\n    _this2.name = _this2.constructor.name;\n\n    if (typeof Error.captureStackTrace === 'function') {\n      Error.captureStackTrace(_assertThisInitialized(_this2), _this2.constructor);\n    } else {\n      _this2.stack = new Error(message).stack;\n    }\n\n    return _this2;\n  }\n\n  return ExtendableError;\n}(_wrapNativeSuper(Error));\n\nvar InvariantViolation =\n/*#__PURE__*/\nfunction (_ExtendableError) {\n  _inherits(InvariantViolation, _ExtendableError);\n\n  function InvariantViolation() {\n    _classCallCheck(this, InvariantViolation);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(InvariantViolation).apply(this, arguments));\n  }\n\n  return InvariantViolation;\n}(ExtendableError);\n\nvar ResolveError =\n/*#__PURE__*/\nfunction (_ExtendableError2) {\n  _inherits(ResolveError, _ExtendableError2);\n\n  function ResolveError(href, fromHref) {\n    var _this3;\n\n    _classCallCheck(this, ResolveError);\n\n    _this3 = _possibleConstructorReturn(this, _getPrototypeOf(ResolveError).call(this, \"Unable to resolve '\".concat(href, \"'\").concat(fromHref ? \" from '\".concat(fromHref, \"'\") : '')));\n    _this3.href = href;\n    _this3.fromHref = fromHref;\n    return _this3;\n  }\n\n  return ResolveError;\n}(ExtendableError); //@ts-check\n\n/**\n *\n * @param {import('./types').ImmediateExecutionManifest} manifest\n * @param {import('./types').RuntimeOptions} [options]\n * @returns {import('./types').IRuntime}\n */\n\n\nfunction createRuntime(manifest, options) {\n  /** @type {Record<string, string | undefined>} */\n  var aliases = Object.create(null);\n  /** @type {Record<string, Record<string, string | undefined> | undefined> } */\n\n  var mappings = Object.create(null);\n  /** @type {Record<string, Module | undefined>} */\n\n  var modules = Object.create(null);\n  /** @type {Record<string, import('./types').ModuleFactory | undefined>} */\n\n  var registry = Object.create(null);\n  /**\n   * @template T\n   * @param {T[]} set\n   * @param {T} value\n   * @returns {T[]}\n   */\n\n  function addToSet(set, value) {\n    var idx = set.indexOf(value);\n    if (idx === -1) set.push(value);\n    return set;\n  }\n  /**\n   * @class\n   * @implements {import('./types').IRuntime}\n   * @property {Module} root\n   */\n\n\n  function Runtime() {\n    /**\n     * @readonly\n     */\n    this.root = new Module('velcro://root', this);\n    var self = this;\n    this.register('@@runtime', function (module) {\n      module.exports = self;\n    });\n  }\n  /**\n   * @param {string} name\n   * @param {string} id\n   */\n\n\n  Runtime.prototype.alias = function (name, id) {\n    aliases[name] = id;\n  };\n  /**\n   * @param {string} fromId\n   * @param {string} spec\n   * @param {string} toId\n   */\n\n\n  Runtime.prototype.dependency = function (fromId, spec, toId) {\n    var mappingsForId = mappings[fromId];\n\n    if (!mappingsForId) {\n      mappingsForId = {};\n      mappings[fromId] = mappingsForId;\n    }\n\n    mappingsForId[spec] = toId;\n  };\n  /**\n   * @param {string} id\n   */\n\n\n  Runtime.prototype.get = function (id) {\n    id = aliases[id] || id;\n    return modules[id];\n  };\n  /**\n   * @param {string} fromId\n   * @param {string} spec\n   * @returns {string}\n   */\n\n\n  Runtime.prototype.getId = function (fromId, spec) {\n    var alias = aliases[spec];\n\n    if (alias) {\n      return alias;\n    }\n\n    var mappingsForId = mappings[fromId];\n    return mappingsForId && mappingsForId[spec] || spec;\n  };\n  /**\n   * @param {import('./types').ImmediateExecutionManifest} manifest\n   * @param {boolean} [executeEntrypoints]\n   */\n\n\n  Runtime.prototype.init = function (manifest, executeEntrypoints) {\n    for (var href in manifest.modules) {\n      var module = manifest.modules[href];\n\n      for (var alias in module.dependencies) {\n        this.dependency(href, alias, module.dependencies[alias]);\n      }\n\n      this.register(href, module.factory);\n    }\n\n    for (var _alias in manifest.aliases) {\n      this.alias(_alias, manifest.aliases[_alias]);\n    }\n\n    for (var entrypoint in manifest.entrypoints) {\n      this.alias(entrypoint, manifest.entrypoints[entrypoint]);\n\n      if (executeEntrypoints) {\n        this.require(entrypoint);\n      }\n    }\n  };\n  /**\n   * @param {string} id\n   * @param {import('./types').ModuleFactory} factory\n   */\n\n\n  Runtime.prototype.register = function (id, factory) {\n    if (!registry[id]) {\n      registry[id] = factory;\n    }\n  };\n  /**\n   * @param {string} id\n   * @returns {Module | undefined}\n   */\n\n\n  Runtime.prototype.remove = function (id) {\n    var module = this.get(id);\n\n    if (!module) {\n      return;\n    }\n\n    delete modules[module.id];\n    delete mappings[module.id];\n    delete registry[module.id];\n    return module;\n  };\n  /**\n   * @param {string} id\n   */\n\n\n  Runtime.prototype.require = function (id) {\n    return this.root.require(aliases[id] || id);\n  };\n  /**\n   * @class\n   * @param {Module} module\n   */\n\n\n  function HotModule(module) {\n    /** @private */\n    this.module = module;\n  }\n  /**\n   * @param {() => void} cb\n   */\n\n\n  HotModule.prototype.accept = function (cb) {\n    this.module.acceptCallbacks.push({\n      cb: cb\n    });\n  };\n  /**\n   * @param {() => void} cb\n   */\n\n\n  HotModule.prototype.dispose = function (cb) {\n    this.module.disposeCallbacks.push({\n      cb: cb\n    });\n  };\n  /**\n   * @class\n   * @param {string} id\n   * @param {Runtime} runtime\n   */\n\n\n  function Module(id, runtime) {\n    /** @type {Module[]} */\n    this.dependencies = [];\n    /** @type {Module[]} */\n\n    this.dependents = [];\n    this.id = id;\n    /** @type {import('./types').AcceptCallback[]} */\n\n    this.acceptCallbacks = [];\n    /** @type {import('./types').DisposeCallback[]} */\n\n    this.disposeCallbacks = [];\n    /** @readonly */\n\n    this.module = Object.seal({\n      exports: {},\n      hot: new HotModule(this)\n    });\n    /** @readonly */\n\n    this.runtime = runtime;\n    Object.defineProperty(this, Symbol.toStringTag, {\n      configurable: false,\n      enumerable: false,\n      get: function get() {\n        return 'Module';\n      }\n    });\n  }\n  /**\n   * @param {string} id\n   */\n\n\n  Module.prototype.require = function (id) {\n    id = this.runtime.getId(this.id, id);\n    /** @type {Module | undefined} */\n\n    var module = modules[id];\n\n    if (!module) {\n      var factory = registry[id];\n\n      if (!factory) {\n        throw new Error(\"Factory missing for \".concat(id));\n      }\n\n      module = new Module(id, this.runtime);\n      modules[id] = module; // Free up the registry entry and release any refs for GC\n\n      delete registry[id];\n      var dirname = id;\n      var filename = id;\n      factory.call(module.module.exports, module.module, module.module.exports, module.require.bind(module), dirname, filename);\n    }\n\n    addToSet(module.dependents, this);\n    addToSet(this.dependencies, module);\n    return module.module.exports;\n  }; //@ts-ignore\n\n\n  var runtime = options && options.runtime && window[options.runtime] || new Runtime();\n  runtime.init(manifest, options && options.executeEntrypoints);\n  return runtime;\n}\n\nvar Bundle =\n/*#__PURE__*/\nfunction () {\n  function Bundle(assets, entrypointsToAssets, dependenciesToAssets) {\n    _classCallCheck(this, Bundle);\n\n    this.assets = assets;\n    this.entrypointsToAssets = entrypointsToAssets;\n    this.dependenciesToAssets = dependenciesToAssets;\n    this.assetsByHref = new Map();\n    var _iteratorNormalCompletion5 = true;\n    var _didIteratorError5 = false;\n    var _iteratorError5 = undefined;\n\n    try {\n      for (var _iterator5 = assets[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n        var asset = _step5.value;\n        this.assetsByHref.set(asset.href, asset);\n      }\n    } catch (err) {\n      _didIteratorError5 = true;\n      _iteratorError5 = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion5 && _iterator5.return != null) {\n          _iterator5.return();\n        }\n      } finally {\n        if (_didIteratorError5) {\n          throw _iteratorError5;\n        }\n      }\n    }\n  }\n\n  _createClass(Bundle, [{\n    key: \"buildForImmediateExecution\",\n    value: function buildForImmediateExecution() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var bundle = new Bundle$1({\n        separator: '\\n\\t\\t,\\n'\n      });\n      var _iteratorNormalCompletion6 = true;\n      var _didIteratorError6 = false;\n      var _iteratorError6 = undefined;\n\n      try {\n        for (var _iterator6 = this.assets[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n          var asset = _step6.value;\n          bundle.addSource(buildAssetForImmediateExecution(asset));\n        }\n      } catch (err) {\n        _didIteratorError6 = true;\n        _iteratorError6 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion6 && _iterator6.return != null) {\n            _iterator6.return();\n          }\n        } finally {\n          if (_didIteratorError6) {\n            throw _iteratorError6;\n          }\n        }\n      }\n\n      var aliasMap = Array.from(this.dependenciesToAssets).reduce(function (acc, _ref7) {\n        var _ref8 = _slicedToArray(_ref7, 2),\n            name = _ref8[0],\n            asset = _ref8[1];\n\n        acc[name] = asset.href;\n        return acc;\n      }, {});\n      var entrypointMap = Array.from(this.entrypointsToAssets).reduce(function (acc, _ref9) {\n        var _ref10 = _slicedToArray(_ref9, 2),\n            name = _ref10[0],\n            asset = _ref10[1];\n\n        acc[name] = asset.href;\n        return acc;\n      }, {});\n      var runtimeOptions = {\n        executeEntrypoints: options.executeEntrypoints,\n        runtime: options.runtime\n      };\n      bundle.prepend(\"(\".concat(createRuntime.toString(), \")({\\n\\taliases:\").concat(JSON.stringify(aliasMap), \",\\n\\tentrypoints:\").concat(JSON.stringify(entrypointMap), \",\\n\\tmodules:{\\n\"));\n      bundle.append(\"\\n\\t}\\n}, \".concat(JSON.stringify(runtimeOptions), \");\"));\n      var code = bundle.toString();\n      var sourceMap = options.sourceMap ? this.generateSourceMap(bundle, '') : undefined;\n      return {\n        code: code,\n        sourceMap: sourceMap\n      };\n    }\n  }, {\n    key: \"toManifest\",\n    value: function toManifest(options) {\n      var manifest = {\n        aliases: {},\n        entrypoints: {},\n        modules: {}\n      };\n      var _iteratorNormalCompletion7 = true;\n      var _didIteratorError7 = false;\n      var _iteratorError7 = undefined;\n\n      try {\n        for (var _iterator7 = this.assets[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {\n          var asset = _step7.value;\n          manifest.modules[asset.href] = this.buildAssetForDeferredExecution(asset, options);\n        }\n      } catch (err) {\n        _didIteratorError7 = true;\n        _iteratorError7 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion7 && _iterator7.return != null) {\n            _iterator7.return();\n          }\n        } finally {\n          if (_didIteratorError7) {\n            throw _iteratorError7;\n          }\n        }\n      }\n\n      var _iteratorNormalCompletion8 = true;\n      var _didIteratorError8 = false;\n      var _iteratorError8 = undefined;\n\n      try {\n        for (var _iterator8 = this.dependenciesToAssets[Symbol.iterator](), _step8; !(_iteratorNormalCompletion8 = (_step8 = _iterator8.next()).done); _iteratorNormalCompletion8 = true) {\n          var _ref15 = _step8.value;\n\n          var _ref12 = _slicedToArray(_ref15, 2);\n\n          var name = _ref12[0];\n          var _asset = _ref12[1];\n          manifest.aliases[name] = _asset.href;\n        }\n      } catch (err) {\n        _didIteratorError8 = true;\n        _iteratorError8 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion8 && _iterator8.return != null) {\n            _iterator8.return();\n          }\n        } finally {\n          if (_didIteratorError8) {\n            throw _iteratorError8;\n          }\n        }\n      }\n\n      var _iteratorNormalCompletion9 = true;\n      var _didIteratorError9 = false;\n      var _iteratorError9 = undefined;\n\n      try {\n        for (var _iterator9 = this.entrypointsToAssets[Symbol.iterator](), _step9; !(_iteratorNormalCompletion9 = (_step9 = _iterator9.next()).done); _iteratorNormalCompletion9 = true) {\n          var _ref16 = _step9.value;\n\n          var _ref14 = _slicedToArray(_ref16, 2);\n\n          var _name = _ref14[0];\n          var _asset2 = _ref14[1];\n          manifest.entrypoints[_name] = _asset2.href;\n        }\n      } catch (err) {\n        _didIteratorError9 = true;\n        _iteratorError9 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion9 && _iterator9.return != null) {\n            _iterator9.return();\n          }\n        } finally {\n          if (_didIteratorError9) {\n            throw _iteratorError9;\n          }\n        }\n      }\n\n      return manifest;\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      var _this$buildForImmedia = this.buildForImmediateExecution(options),\n          code = _this$buildForImmedia.code,\n          sourceMap = _this$buildForImmedia.sourceMap;\n\n      return code + (sourceMap ? \"\\n//# sourceMappingURL=\".concat(sourceMap.toDataUri()) : '');\n    }\n  }, {\n    key: \"buildAssetForDeferredExecution\",\n    value: function buildAssetForDeferredExecution(asset) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      var _buildAssetAndCollect = buildAssetAndCollectDependencies(asset, ''),\n          dependencies = _buildAssetAndCollect.dependencies,\n          magicString = _buildAssetAndCollect.magicString;\n\n      var sourceMap = options.sourceMap ? this.generateSourceMap(magicString, asset.href) : undefined;\n      var code = magicString.toString() + (sourceMap ? \"\\n//# sourceMappingURL=\".concat(sourceMap.toDataUri()) : '');\n      return {\n        code: code,\n        dependencies: dependencies\n      };\n    }\n  }, {\n    key: \"generateSourceMap\",\n    value: function generateSourceMap(bundle, href) {\n      var _this4 = this;\n\n      var inputMap = bundle.generateMap({\n        includeContent: true,\n        hires: false,\n        source: href\n      }); // In case a source map seems to be self-referential, avoid crashing\n\n      var seen = new Set();\n      return new SourceMap(remapping(inputMap.toString(), function (uri) {\n        var asset = _this4.assetsByHref.get(uri);\n\n        if (asset && asset.sourceMappingUrl) {\n          if (seen.has(asset)) {\n            return null;\n          }\n\n          seen.add(asset);\n          var match = asset.sourceMappingUrl.match(/^data:application\\/json;(?:charset=([^;]+);)?base64,(.*)$/);\n\n          if (match) {\n            if (match[1] && match[1] !== 'utf-8') {\n              return null;\n            }\n\n            try {\n              var decoded = JSON.parse(Base64.decode(match[2]));\n              return decoded;\n            } catch (err) {\n              return null;\n            }\n          }\n        }\n\n        return null;\n      }, false));\n    }\n  }]);\n\n  return Bundle;\n}();\n\nvar SourceMap =\n/*#__PURE__*/\nfunction () {\n  function SourceMap(input) {\n    _classCallCheck(this, SourceMap);\n\n    this.file = input.file;\n    this.mappings = input.mappings;\n    this.sourceRoot = input.sourceRoot;\n    this.names = input.names;\n    this.sources = input.sources;\n    this.sourcesContent = input.sourcesContent;\n    this.version = input.version;\n  }\n\n  _createClass(SourceMap, [{\n    key: \"toString\",\n    value: function toString() {\n      return JSON.stringify(this);\n    }\n  }, {\n    key: \"toDataUri\",\n    value: function toDataUri() {\n      return \"data:application/json;charset=utf-8;base64,\".concat(Base64.encode(this.toString()));\n    }\n  }]);\n\n  return SourceMap;\n}();\n\nfunction buildAssetAndCollectDependencies(asset) {\n  var indent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '\\t';\n\n  if (!asset.magicString) {\n    throw new InvariantViolation(\"Invariant violation: asset is not loaded '\".concat(asset.href, \"'\"));\n  }\n\n  var dependencies = {};\n  var magicString = asset.magicString.clone();\n  magicString.trim();\n  magicString.indent(indent); // We'll replace each dependency string with the resolved stable href. The stable href doesn't require any\n  // information about where it is being resolved from, so it is useful as a long-term pointer whose target\n  // can change over time\n\n  var _iteratorNormalCompletion10 = true;\n  var _didIteratorError10 = false;\n  var _iteratorError10 = undefined;\n\n  try {\n    for (var _iterator10 = asset.dependencies[Symbol.iterator](), _step10; !(_iteratorNormalCompletion10 = (_step10 = _iterator10.next()).done); _iteratorNormalCompletion10 = true) {\n      var dependency = _step10.value;\n\n      switch (dependency.type) {\n        case Asset.DependencyKind.Require:\n          {\n            // magicString.overwrite(dependency.spec.start, dependency.spec.end, JSON.stringify(dependency.href));\n            // magicString.overwrite(dependency.callee.start, dependency.callee.end, '__velcro_require');\n            dependencies[dependency.spec.value] = dependency.href;\n            break;\n          }\n\n        case Asset.DependencyKind.RequireResolve:\n          {\n            // magicString.overwrite(dependency.spec.start, dependency.spec.end, JSON.stringify(dependency.href));\n            // magicString.overwrite(dependency.callee.start, dependency.callee.end, '__velcro_require_resolve');\n            dependencies[dependency.spec.value] = dependency.href;\n            break;\n          }\n\n        case Asset.DependencyKind.InjectedGlobal:\n          {\n            magicString.prepend(\"\\n\".concat(indent, \"const \").concat(dependency.symbolName, \" = require(\").concat(JSON.stringify(dependency.symbolName), \")\").concat(dependency.exportName ? \".\".concat(dependency.exportName) : '', \";\\n\"));\n            dependencies[dependency.symbolName] = dependency.href;\n            break;\n          }\n\n        default:\n          throw new Error(\"Invariant violation: Encountered unexpected dependency kind '\".concat(dependency.type, \"'\"));\n      }\n    }\n  } catch (err) {\n    _didIteratorError10 = true;\n    _iteratorError10 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion10 && _iterator10.return != null) {\n        _iterator10.return();\n      }\n    } finally {\n      if (_didIteratorError10) {\n        throw _iteratorError10;\n      }\n    }\n  }\n\n  return {\n    dependencies: dependencies,\n    magicString: magicString\n  };\n}\n\nfunction buildAssetForImmediateExecution(asset) {\n  var _buildAssetAndCollect2 = buildAssetAndCollectDependencies(asset, '\\t\\t\\t'),\n      dependencies = _buildAssetAndCollect2.dependencies,\n      magicString = _buildAssetAndCollect2.magicString;\n\n  magicString.prepend(\"\\t\\t\".concat(JSON.stringify(asset.href), \": { dependencies: \").concat(JSON.stringify(dependencies), \", factory: function(module, exports, require, __dirname, __filename){\\n\"));\n  magicString.append('\\n\\t\\t}}');\n  return magicString;\n}\n\nvar EMPTY_MODULE_URL = new URL('velcro://@empty');\nvar EMPTY_MODULE_CODE = 'module.exports = function(){};';\nvar DEFAULT_SHIM_GLOBALS = {\n  Buffer: {\n    spec: \"@velcro/node-libs@\".concat(version, \"/lib/buffer.js\"),\n    export: 'Buffer'\n  },\n  global: {\n    spec: \"@velcro/node-libs@\".concat(version, \"/lib/global.js\")\n  },\n  process: {\n    spec: \"@velcro/node-libs@\".concat(version, \"/lib/process.js\")\n  }\n};\n\nvar Bundler =\n/*#__PURE__*/\nfunction () {\n  function Bundler(options) {\n    _classCallCheck(this, Bundler);\n\n    this.assetsByHref = new Map(); // private readonly assetsByRootHref = new Map<string, Set<Asset>>();\n\n    this.pendingResolves = new Map();\n    this.onAssetAddedEmitter = new Emitter();\n    this.onAssetRemovedEmitter = new Emitter();\n    this.resolver = options.resolver;\n  }\n\n  _createClass(Bundler, [{\n    key: \"dispose\",\n    value: function dispose() {\n      this.onAssetAddedEmitter.dispose();\n      this.onAssetRemovedEmitter.dispose();\n      this.assetsByHref.clear(); // this.assetsByRootHref.clear();\n\n      this.pendingResolves.clear();\n    }\n  }, {\n    key: \"getOrCreateAsset\",\n    value: function getOrCreateAsset(href, rootHref) {\n      var asset = this.assetsByHref.get(href);\n\n      if (!asset) {\n        asset = new Asset(href, rootHref);\n        this.assetsByHref.set(href, asset);\n        this.onAssetAddedEmitter.fire(asset);\n      }\n\n      return asset;\n    }\n  }, {\n    key: \"generateBundle\",\n    value: function () {\n      var _generateBundle = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(entrypoints) {\n        var _this5 = this;\n\n        var options,\n            tokenSource,\n            token,\n            pendingOperations,\n            assets,\n            dfd,\n            dependenciesToAssets,\n            entrypointsToAssets,\n            enqueue,\n            resolveDependencies,\n            resolveAsset,\n            _loop4,\n            name,\n            _loop5,\n            idx,\n            _args5 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                options = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : {};\n\n                if (Array.isArray(entrypoints)) {\n                  _context5.next = 3;\n                  break;\n                }\n\n                throw new Error('Generating a bundle requires passing in an array of entrypoints');\n\n              case 3:\n                tokenSource = new CancellationTokenSource();\n                token = tokenSource.token;\n\n                if (options.token) {\n                  if (options.token.isCancellationRequested) {\n                    tokenSource.cancel();\n                    tokenSource.dispose();\n                  }\n\n                  options.token.onCancellationRequested(function () {\n                    tokenSource.cancel();\n                    tokenSource.dispose();\n                  });\n                }\n\n                pendingOperations = 0;\n                assets = new Set();\n                dfd = new Deferred(token);\n                dependenciesToAssets = new Map();\n                entrypointsToAssets = new Map();\n\n                enqueue =\n                /*#__PURE__*/\n                function () {\n                  var _ref17 = _asyncToGenerator(\n                  /*#__PURE__*/\n                  _regeneratorRuntime.mark(function _callee2(op) {\n                    var result;\n                    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                      while (1) {\n                        switch (_context2.prev = _context2.next) {\n                          case 0:\n                            _context2.prev = 0;\n                            pendingOperations++;\n\n                            if (options.onEnqueueAsset) {\n                              options.onEnqueueAsset();\n                            }\n\n                            _context2.next = 5;\n                            return op();\n\n                          case 5:\n                            result = _context2.sent;\n\n                            if (options.onCompleteAsset) {\n                              options.onCompleteAsset();\n                            }\n\n                            pendingOperations--;\n\n                            if (!(pendingOperations < 0)) {\n                              _context2.next = 10;\n                              break;\n                            }\n\n                            throw new InvariantViolation('Pending operations fell below zero');\n\n                          case 10:\n                            if (pendingOperations === 0) {\n                              // Let's make sure this happens after the current microtask.\n                              setTimeout(function () {\n                                return dfd.resolve();\n                              }, 0);\n                            }\n\n                            return _context2.abrupt(\"return\", result);\n\n                          case 14:\n                            _context2.prev = 14;\n                            _context2.t0 = _context2[\"catch\"](0);\n\n                            // Let's make sure this happens 'later'.\n                            if (!dfd.isSettled) {\n                              Promise.resolve().then(function () {\n                                return dfd.reject(_context2.t0);\n                              }).catch(function (_) {\n                                return undefined;\n                              });\n                            }\n\n                            throw _context2.t0;\n\n                          case 18:\n                          case \"end\":\n                            return _context2.stop();\n                        }\n                      }\n                    }, _callee2, null, [[0, 14]]);\n                  }));\n\n                  return function enqueue(_x5) {\n                    return _ref17.apply(this, arguments);\n                  };\n                }();\n\n                resolveDependencies =\n                /*#__PURE__*/\n                function () {\n                  var _ref18 = _asyncToGenerator(\n                  /*#__PURE__*/\n                  _regeneratorRuntime.mark(function _callee3(asset, code) {\n                    var _asset$dependencies2;\n\n                    var promises, _iteratorNormalCompletion11, _didIteratorError11, _iteratorError11, _loop, _iterator11, _step11, _ret, _iteratorNormalCompletion12, _didIteratorError12, _iteratorError12, _loop2, _iterator12, _step12, _iteratorNormalCompletion13, _didIteratorError13, _iteratorError13, _loop3, _iterator13, _step13, _ref20, dependencies;\n\n                    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                      while (1) {\n                        switch (_context3.prev = _context3.next) {\n                          case 0:\n                            asset.setCode(code);\n                            promises = [];\n                            _iteratorNormalCompletion11 = true;\n                            _didIteratorError11 = false;\n                            _iteratorError11 = undefined;\n                            _context3.prev = 5;\n\n                            _loop = function _loop() {\n                              var dependency = _step11.value;\n\n                              if (dependency.spec.value === '@@runtime') {\n                                return \"continue\";\n                              }\n\n                              promises.push(enqueue(function () {\n                                return resolveAsset(dependency.spec.value, asset.href);\n                              }).then(function (dependencyAsset) {\n                                return {\n                                  type: Asset.DependencyKind.Require,\n                                  href: dependencyAsset.href,\n                                  rootHref: dependencyAsset.rootHref,\n                                  callee: dependency.callee,\n                                  spec: dependency.spec,\n                                  value: dependency.spec.value\n                                };\n                              }));\n                            };\n\n                            _iterator11 = asset.unresolvedDependencies.requireDependencies[Symbol.iterator]();\n\n                          case 8:\n                            if (_iteratorNormalCompletion11 = (_step11 = _iterator11.next()).done) {\n                              _context3.next = 15;\n                              break;\n                            }\n\n                            _ret = _loop();\n\n                            if (!(_ret === \"continue\")) {\n                              _context3.next = 12;\n                              break;\n                            }\n\n                            return _context3.abrupt(\"continue\", 12);\n\n                          case 12:\n                            _iteratorNormalCompletion11 = true;\n                            _context3.next = 8;\n                            break;\n\n                          case 15:\n                            _context3.next = 21;\n                            break;\n\n                          case 17:\n                            _context3.prev = 17;\n                            _context3.t0 = _context3[\"catch\"](5);\n                            _didIteratorError11 = true;\n                            _iteratorError11 = _context3.t0;\n\n                          case 21:\n                            _context3.prev = 21;\n                            _context3.prev = 22;\n\n                            if (!_iteratorNormalCompletion11 && _iterator11.return != null) {\n                              _iterator11.return();\n                            }\n\n                          case 24:\n                            _context3.prev = 24;\n\n                            if (!_didIteratorError11) {\n                              _context3.next = 27;\n                              break;\n                            }\n\n                            throw _iteratorError11;\n\n                          case 27:\n                            return _context3.finish(24);\n\n                          case 28:\n                            return _context3.finish(21);\n\n                          case 29:\n                            _iteratorNormalCompletion12 = true;\n                            _didIteratorError12 = false;\n                            _iteratorError12 = undefined;\n                            _context3.prev = 32;\n\n                            _loop2 = function _loop2() {\n                              var dependency = _step12.value;\n                              promises.push(enqueue(function () {\n                                return resolveAsset(dependency.spec.value, asset.href);\n                              }).then(function (dependencyAsset) {\n                                return {\n                                  type: Asset.DependencyKind.RequireResolve,\n                                  href: dependencyAsset.href,\n                                  rootHref: dependencyAsset.rootHref,\n                                  callee: dependency.callee,\n                                  spec: dependency.spec,\n                                  value: dependency.spec.value\n                                };\n                              }));\n                            };\n\n                            for (_iterator12 = asset.unresolvedDependencies.requireResolveDependencies[Symbol.iterator](); !(_iteratorNormalCompletion12 = (_step12 = _iterator12.next()).done); _iteratorNormalCompletion12 = true) {\n                              _loop2();\n                            }\n\n                            _context3.next = 41;\n                            break;\n\n                          case 37:\n                            _context3.prev = 37;\n                            _context3.t1 = _context3[\"catch\"](32);\n                            _didIteratorError12 = true;\n                            _iteratorError12 = _context3.t1;\n\n                          case 41:\n                            _context3.prev = 41;\n                            _context3.prev = 42;\n\n                            if (!_iteratorNormalCompletion12 && _iterator12.return != null) {\n                              _iterator12.return();\n                            }\n\n                          case 44:\n                            _context3.prev = 44;\n\n                            if (!_didIteratorError12) {\n                              _context3.next = 47;\n                              break;\n                            }\n\n                            throw _iteratorError12;\n\n                          case 47:\n                            return _context3.finish(44);\n\n                          case 48:\n                            return _context3.finish(41);\n\n                          case 49:\n                            _iteratorNormalCompletion13 = true;\n                            _didIteratorError13 = false;\n                            _iteratorError13 = undefined;\n                            _context3.prev = 52;\n\n                            _loop3 = function _loop3() {\n                              var _ref19 = _step13.value;\n                              _ref20 = _slicedToArray(_ref19, 2);\n                              var symbolName = _ref20[0];\n                              var references = _ref20[1];\n                              var shim = DEFAULT_SHIM_GLOBALS[symbolName];\n\n                              if (shim) {\n                                promises.push(enqueue(function () {\n                                  return resolveAsset(shim.spec, asset.href);\n                                }).then(function (dependencyAsset) {\n                                  return {\n                                    type: Asset.DependencyKind.InjectedGlobal,\n                                    href: dependencyAsset.href,\n                                    rootHref: dependencyAsset.rootHref,\n                                    references: references,\n                                    exportName: shim.export,\n                                    symbolName: symbolName,\n                                    value: \"\".concat(shim.spec).concat(shim.export ? \"[\".concat(JSON.stringify(shim.export), \"]\") : '')\n                                  };\n                                }));\n                              }\n                            };\n\n                            for (_iterator13 = asset.unresolvedDependencies.unboundSymbols[Symbol.iterator](); !(_iteratorNormalCompletion13 = (_step13 = _iterator13.next()).done); _iteratorNormalCompletion13 = true) {\n                              _loop3();\n                            }\n\n                            _context3.next = 61;\n                            break;\n\n                          case 57:\n                            _context3.prev = 57;\n                            _context3.t2 = _context3[\"catch\"](52);\n                            _didIteratorError13 = true;\n                            _iteratorError13 = _context3.t2;\n\n                          case 61:\n                            _context3.prev = 61;\n                            _context3.prev = 62;\n\n                            if (!_iteratorNormalCompletion13 && _iterator13.return != null) {\n                              _iterator13.return();\n                            }\n\n                          case 64:\n                            _context3.prev = 64;\n\n                            if (!_didIteratorError13) {\n                              _context3.next = 67;\n                              break;\n                            }\n\n                            throw _iteratorError13;\n\n                          case 67:\n                            return _context3.finish(64);\n\n                          case 68:\n                            return _context3.finish(61);\n\n                          case 69:\n                            _context3.next = 71;\n                            return Promise.all(promises);\n\n                          case 71:\n                            dependencies = _context3.sent;\n\n                            (_asset$dependencies2 = asset.dependencies).splice.apply(_asset$dependencies2, [0, asset.dependencies.length].concat(_toConsumableArray(dependencies)));\n\n                            return _context3.abrupt(\"return\", asset);\n\n                          case 74:\n                          case \"end\":\n                            return _context3.stop();\n                        }\n                      }\n                    }, _callee3, null, [[5, 17, 21, 29], [22,, 24, 28], [32, 37, 41, 49], [42,, 44, 48], [52, 57, 61, 69], [62,, 64, 68]]);\n                  }));\n\n                  return function resolveDependencies(_x6, _x7) {\n                    return _ref18.apply(this, arguments);\n                  };\n                }();\n\n                resolveAsset =\n                /*#__PURE__*/\n                function () {\n                  var _ref21 = _asyncToGenerator(\n                  /*#__PURE__*/\n                  _regeneratorRuntime.mark(function _callee4(spec, fromSpec) {\n                    var resolvedSpec, asset, code;\n                    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n                      while (1) {\n                        switch (_context4.prev = _context4.next) {\n                          case 0:\n                            _context4.next = 2;\n                            return _this5.resolveWithDetails(spec, fromSpec, {\n                              syntheticDependencies: options.dependencies,\n                              token: token\n                            });\n\n                          case 2:\n                            resolvedSpec = _context4.sent;\n                            asset = _this5.getOrCreateAsset(resolvedSpec.resolvedHref, resolvedSpec.rootHref); // No need to re-process the same asset during the same operation\n\n                            if (assets.has(asset)) {\n                              _context4.next = 10;\n                              break;\n                            }\n\n                            assets.add(asset);\n                            _context4.next = 8;\n                            return _this5.readCode(asset, {\n                              token: token\n                            });\n\n                          case 8:\n                            code = _context4.sent;\n                            // No need to wait for this, but we do need to make sure it doesn't\n                            // generate an unhandled rejection.\n                            resolveDependencies(asset, code).catch(function (_) {\n                              return undefined;\n                            });\n\n                          case 10:\n                            return _context4.abrupt(\"return\", asset);\n\n                          case 11:\n                          case \"end\":\n                            return _context4.stop();\n                        }\n                      }\n                    }, _callee4);\n                  }));\n\n                  return function resolveAsset(_x8, _x9) {\n                    return _ref21.apply(this, arguments);\n                  };\n                }();\n\n                if (options.dependencies) {\n                  _loop4 = function _loop4(name) {\n                    var dependency = options.dependencies[name];\n                    enqueue(function () {\n                      return resolveAsset(\"\".concat(name, \"@\").concat(dependency));\n                    }).then(function (asset) {\n                      return dependenciesToAssets.set(name, asset);\n                    }, function (_) {\n                      return undefined;\n                    });\n                  };\n\n                  for (name in options.dependencies) {\n                    _loop4(name);\n                  }\n                }\n\n                _loop5 = function _loop5(idx) {\n                  var entrypoint = entrypoints[idx]; // We need to add a catch handler because we might not catch all thrown exceptions,\n                  // only the first, via the dfd.promise.\n\n                  switch (entrypoint.type) {\n                    case 'href':\n                      {\n                        enqueue(function () {\n                          return resolveAsset(entrypoint.href);\n                        }).then(function (asset) {\n                          return entrypointsToAssets.set(entrypoint.href, asset);\n                        }, function (_) {\n                          return undefined;\n                        });\n                        break;\n                      }\n\n                    case 'inline':\n                      {\n                        enqueue(function () {\n                          var asset = _this5.getOrCreateAsset(entrypoint.href, 'velcro:///');\n\n                          if (!assets.has(asset)) {\n                            assets.add(asset);\n                            return resolveDependencies(asset, entrypoint.code);\n                          }\n\n                          return asset;\n                        }).then(function (asset) {\n                          return entrypointsToAssets.set(entrypoint.href, asset);\n                        }, function (_) {\n                          return undefined;\n                        });\n                        break;\n                      }\n\n                    default:\n                      {\n                        throw new Error(\"Unexpected entrypoint type '\".concat(entrypoint.type));\n                      }\n                  }\n                };\n\n                for (idx in entrypoints) {\n                  _loop5(idx);\n                }\n\n                _context5.next = 19;\n                return dfd.promise;\n\n              case 19:\n                return _context5.abrupt(\"return\", new Bundle(assets, entrypointsToAssets, dependenciesToAssets));\n\n              case 20:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }));\n\n      function generateBundle(_x4) {\n        return _generateBundle.apply(this, arguments);\n      }\n\n      return generateBundle;\n    }()\n  }, {\n    key: \"invalidate\",\n    value: function () {\n      var _invalidate = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6(spec) {\n        var _ref22,\n            token,\n            asset,\n            resolveResult,\n            combinedUri,\n            _args6 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _ref22 = _args6.length > 1 && _args6[1] !== undefined ? _args6[1] : {}, token = _ref22.token;\n                asset = this.assetsByHref.get(spec);\n\n                if (asset) {\n                  _context6.next = 25;\n                  break;\n                }\n\n                // We can't use Bundler::resolveWithDetails() because that will throw\n                // when a module isn't found. We just want to attempt to resolve and\n                // return true / false accordingly.\n                resolveResult = undefined;\n                _context6.prev = 4;\n\n                if (!isBareModuleSpecifier(spec)) {\n                  _context6.next = 11;\n                  break;\n                }\n\n                _context6.next = 8;\n                return resolveBareModuleToUnpkgWithDetails(this.resolver, spec, undefined, {\n                  token: token\n                });\n\n              case 8:\n                resolveResult = _context6.sent;\n                _context6.next = 15;\n                break;\n\n              case 11:\n                combinedUri = new URL(spec);\n                _context6.next = 14;\n                return this.resolver.resolve(combinedUri, {\n                  token: token\n                });\n\n              case 14:\n                resolveResult = _context6.sent;\n\n              case 15:\n                _context6.next = 22;\n                break;\n\n              case 17:\n                _context6.prev = 17;\n                _context6.t0 = _context6[\"catch\"](4);\n\n                if (!(_context6.t0 instanceof EntryNotFoundError)) {\n                  _context6.next = 21;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\", false);\n\n              case 21:\n                throw _context6.t0;\n\n              case 22:\n                if (!(!resolveResult || !resolveResult.resolvedUrl)) {\n                  _context6.next = 24;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\", false);\n\n              case 24:\n                asset = this.assetsByHref.get(resolveResult.resolvedUrl.href);\n\n              case 25:\n                if (!asset) {\n                  _context6.next = 28;\n                  break;\n                }\n\n                this.removeAsset(asset);\n                return _context6.abrupt(\"return\", true);\n\n              case 28:\n                return _context6.abrupt(\"return\", false);\n\n              case 29:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this, [[4, 17]]);\n      }));\n\n      function invalidate(_x10) {\n        return _invalidate.apply(this, arguments);\n      }\n\n      return invalidate;\n    }()\n  }, {\n    key: \"removeAsset\",\n    value: function removeAsset(asset) {\n      var hadAsset = this.assetsByHref.delete(asset.href);\n\n      if (hadAsset) {\n        this.onAssetRemovedEmitter.fire(asset);\n      }\n    }\n  }, {\n    key: \"readCode\",\n    value: function () {\n      var _readCode = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee7(asset, _ref23) {\n        var token, buf, code;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                token = _ref23.token;\n\n                if (!(asset.href === EMPTY_MODULE_URL.href)) {\n                  _context7.next = 3;\n                  break;\n                }\n\n                return _context7.abrupt(\"return\", EMPTY_MODULE_CODE);\n\n              case 3:\n                _context7.next = 5;\n                return this.resolver.host.readFileContent(this.resolver, new URL(asset.href), {\n                  token: token\n                });\n\n              case 5:\n                buf = _context7.sent;\n                code = this.resolver.decoder.decode(buf);\n                return _context7.abrupt(\"return\", code);\n\n              case 8:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function readCode(_x11, _x12) {\n        return _readCode.apply(this, arguments);\n      }\n\n      return readCode;\n    }()\n  }, {\n    key: \"resolveWithDetails\",\n    value: function () {\n      var _resolveWithDetails = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee8(uri, fromUri, _ref24) {\n        var syntheticDependencies, token, resolved, bareModuleResolveResult, resolvedHref, combinedUri, resolveResult, resolvedUri, _resolvedHref, rootHref;\n\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                syntheticDependencies = _ref24.syntheticDependencies, token = _ref24.token;\n\n                if (!isBareModuleSpecifier(uri)) {\n                  _context8.next = 13;\n                  break;\n                }\n\n                _context8.next = 4;\n                return resolveBareModuleToUnpkgWithDetails(this.resolver, uri, fromUri, {\n                  syntheticDependencies: syntheticDependencies,\n                  token: token\n                });\n\n              case 4:\n                bareModuleResolveResult = _context8.sent;\n\n                if (bareModuleResolveResult.stableUrl) {\n                  _context8.next = 7;\n                  break;\n                }\n\n                throw new Error(\"Failed to resolve bare module '\".concat(uri, \"' from '\").concat(fromUri || '@root', \"' to a stable url\"));\n\n              case 7:\n                if (bareModuleResolveResult.stableRootUrl) {\n                  _context8.next = 9;\n                  break;\n                }\n\n                throw new Error(\"Failed to resolve bare module '\".concat(uri, \"' from '\").concat(fromUri || '@root', \"' to a stable root url\"));\n\n              case 9:\n                resolvedHref = bareModuleResolveResult.resolvedUrl ? bareModuleResolveResult.resolvedUrl.href : EMPTY_MODULE_URL.href;\n                resolved = {\n                  type: Bundler.ResolveDetailsKind.BareModule,\n                  bareModule: {\n                    isBuiltIn: bareModuleResolveResult.bareModule.isBuiltIn,\n                    version: bareModuleResolveResult.bareModule.version,\n                    versionSpec: bareModuleResolveResult.bareModule.versionSpec\n                  },\n                  ignored: bareModuleResolveResult.ignored,\n                  resolvedHref: resolvedHref,\n                  rootHref: bareModuleResolveResult.rootUrl.href,\n                  stableHref: bareModuleResolveResult.stableUrl.href,\n                  stableRootHref: bareModuleResolveResult.stableRootUrl.href\n                };\n                _context8.next = 21;\n                break;\n\n              case 13:\n                combinedUri = new URL(uri, fromUri);\n                _context8.next = 16;\n                return this.resolver.resolve(combinedUri);\n\n              case 16:\n                resolveResult = _context8.sent;\n\n                if (!resolveResult.resolvedUrl) {\n                  resolvedUri = EMPTY_MODULE_URL;\n                } else {\n                  resolvedUri = resolveResult.resolvedUrl;\n                }\n\n                _resolvedHref = resolvedUri.href;\n                rootHref = resolveResult.rootUrl.href;\n                resolved = {\n                  type: Bundler.ResolveDetailsKind.Relative,\n                  ignored: resolveResult.ignored,\n                  resolvedHref: _resolvedHref,\n                  rootHref: rootHref,\n                  stableHref: _resolvedHref,\n                  stableRootHref: rootHref\n                };\n\n              case 21:\n                return _context8.abrupt(\"return\", resolved);\n\n              case 22:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function resolveWithDetails(_x13, _x14, _x15) {\n        return _resolveWithDetails.apply(this, arguments);\n      }\n\n      return resolveWithDetails;\n    }()\n  }, {\n    key: \"onAssetAdded\",\n    get: function get() {\n      return this.onAssetAddedEmitter.event;\n    }\n  }, {\n    key: \"onAssetRemoved\",\n    get: function get() {\n      return this.onAssetRemovedEmitter.event;\n    }\n  }]);\n\n  return Bundler;\n}();\n\n(function (Bundler) {\n  var ResolveDetailsKind;\n\n  (function (ResolveDetailsKind) {\n    ResolveDetailsKind[\"BareModule\"] = \"bare_module\";\n    ResolveDetailsKind[\"Relative\"] = \"relative\";\n  })(ResolveDetailsKind = Bundler.ResolveDetailsKind || (Bundler.ResolveDetailsKind = {}));\n})(Bundler || (Bundler = {}));\n\nvar base64 = {\n  decode: Base64.decode,\n  encode: Base64.encode\n};\nexport { Asset, Bundler, InvariantViolation, ResolveError, base64, getSourceMappingUrl };","import _slicedToArray from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport { AbstractResolverHost } from '@velcro/resolver';\n\nvar ResolverHostCompound =\n/*#__PURE__*/\nfunction (_AbstractResolverHost) {\n  _inherits(ResolverHostCompound, _AbstractResolverHost);\n\n  function ResolverHostCompound(hosts) {\n    var _this;\n\n    _classCallCheck(this, ResolverHostCompound);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ResolverHostCompound).call(this));\n    _this.hosts = new Map();\n\n    for (var prefix in hosts) {\n      _this.hosts.set(prefix, hosts[prefix]);\n    }\n\n    return _this;\n  }\n\n  _createClass(ResolverHostCompound, [{\n    key: \"getCanonicalUrl\",\n    value: function getCanonicalUrl(resolver, url) {\n      var href = url.href; // TODO: Decide whether a more efficient solution is needed\n\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = this.hosts[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var _ref3 = _step.value;\n\n          var _ref2 = _slicedToArray(_ref3, 2);\n\n          var prefix = _ref2[0];\n          var child = _ref2[1];\n\n          if (href.startsWith(prefix)) {\n            if (typeof child.getCanonicalUrl === 'function') {\n              // console.error(`getCanonicalUrl(%s): %s`, url.href, prefix);\n              return child.getCanonicalUrl(resolver, url);\n            }\n\n            break;\n          }\n        } // If the resolved child doesn't have this method, treat it as an identity function\n\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return Promise.resolve(url);\n    }\n  }, {\n    key: \"getResolveRoot\",\n    value: function getResolveRoot(resolver, url) {\n      var href = url.href; // TODO: Decide whether a more efficient solution is needed\n\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = this.hosts[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var _ref6 = _step2.value;\n\n          var _ref5 = _slicedToArray(_ref6, 2);\n\n          var prefix = _ref5[0];\n          var child = _ref5[1];\n\n          if (href.startsWith(prefix)) {\n            // console.error(`getResolveRoot(%s): %s`, url.href, prefix);\n            return child.getResolveRoot(resolver, url);\n          }\n        }\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      return Promise.reject(new Error(\"No suitable host found for url \".concat(href)));\n    }\n  }, {\n    key: \"listEntries\",\n    value: function listEntries(resolver, url) {\n      var href = url.href; // TODO: Decide whether a more efficient solution is needed\n\n      var _iteratorNormalCompletion3 = true;\n      var _didIteratorError3 = false;\n      var _iteratorError3 = undefined;\n\n      try {\n        for (var _iterator3 = this.hosts[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n          var _ref9 = _step3.value;\n\n          var _ref8 = _slicedToArray(_ref9, 2);\n\n          var prefix = _ref8[0];\n          var child = _ref8[1];\n\n          if (href.startsWith(prefix)) {\n            // console.error(`listEntries(%s): %s`, url.href, prefix);\n            return child.listEntries(resolver, url);\n          }\n        }\n      } catch (err) {\n        _didIteratorError3 = true;\n        _iteratorError3 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n            _iterator3.return();\n          }\n        } finally {\n          if (_didIteratorError3) {\n            throw _iteratorError3;\n          }\n        }\n      }\n\n      return Promise.reject(new Error(\"No suitable host found for url \".concat(href)));\n    }\n  }, {\n    key: \"readFileContent\",\n    value: function readFileContent(resolver, url) {\n      var href = url.href; // TODO: Decide whether a more efficient solution is needed\n\n      var _iteratorNormalCompletion4 = true;\n      var _didIteratorError4 = false;\n      var _iteratorError4 = undefined;\n\n      try {\n        for (var _iterator4 = this.hosts[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n          var _ref12 = _step4.value;\n\n          var _ref11 = _slicedToArray(_ref12, 2);\n\n          var prefix = _ref11[0];\n          var child = _ref11[1];\n\n          if (href.startsWith(prefix)) {\n            // console.error(`readFileContent(%s): %s`, url.href, prefix);\n            return child.readFileContent(resolver, url);\n          }\n        }\n      } catch (err) {\n        _didIteratorError4 = true;\n        _iteratorError4 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion4 && _iterator4.return != null) {\n            _iterator4.return();\n          }\n        } finally {\n          if (_didIteratorError4) {\n            throw _iteratorError4;\n          }\n        }\n      }\n\n      return Promise.reject(new Error(\"No suitable host found for url \".concat(href)));\n    }\n  }]);\n\n  return ResolverHostCompound;\n}(AbstractResolverHost);\n\nexport { ResolverHostCompound };","export interface Diagnostic {\n  message: string;\n  start?: { lineNumber: number; column: number };\n  end?: { lineNumber: number; column: number };\n  href?: string;\n}\n\nexport class ExtendableError extends Error {\n  constructor(message?: string) {\n    super(message);\n\n    this.name = this.constructor.name;\n  }\n}\n\nexport class InvariantError extends ExtendableError {}\n\nexport class TimeoutError extends ExtendableError {}\n\nexport class TranspileError extends ExtendableError {\n  constructor(message: string, readonly diagnostics: Diagnostic[]) {\n    super(message);\n  }\n}\n","import { Resolver, ResolvedEntryKind, AbstractResolverHost, ResolvedEntry } from '@velcro/resolver';\nimport * as Monaco from 'monaco-editor';\nimport { timeout } from 'ts-primitives';\n\nimport { InvariantError, TimeoutError, TranspileError, Diagnostic } from './error';\n\nconst LANGUAGE_TYPESCRIPT = 'typescript';\nconst MAX_TRANSPILE_ATTEMPTS = 3;\nconst TRANSPILE_TIMEOUT = 2000;\nconst TRANSPILE_TIMEOUT_BACKOFF = 500;\n\ntype Model = Monaco.editor.ITextModel;\n\nexport class ResolverHostMonaco extends AbstractResolverHost {\n  constructor(private readonly rootUri: Monaco.Uri = Monaco.Uri.file('/')) {\n    super();\n  }\n\n  get rootHref() {\n    return this.rootUri.toString(true);\n  }\n\n  async getResolveRoot() {\n    return new URL(this.rootUri.toString(true));\n  }\n\n  async listEntries(_resolver: Resolver, url: URL) {\n    const href = url.href.replace(/\\/?$/, '/');\n    const rootHref = this.rootUri.toString(true);\n\n    if (!href.startsWith(rootHref)) {\n      return [];\n    }\n\n    return Monaco.editor.getModels().reduce(\n      (entries, model) => {\n        const modelHref = model.uri.toString(true);\n        const seenDirs = new Set<string>();\n\n        if (modelHref.startsWith(href)) {\n          const nestedPath = modelHref.slice(href.length);\n          const nextDirIdx = nestedPath.indexOf('/');\n\n          if (nextDirIdx === 0) {\n            throw new Error('Invariant error: WAT?');\n          }\n\n          if (nextDirIdx > 0) {\n            // This is an intermediate directory\n            const url = new URL(nestedPath.slice(0, nextDirIdx + 1), href);\n\n            if (!seenDirs.has(url.href)) {\n              entries.push({\n                type: ResolvedEntryKind.Directory,\n                url,\n              });\n            }\n          } else {\n            entries.push({\n              type: ResolvedEntryKind.File,\n              url: new URL(modelHref),\n            });\n          }\n        }\n\n        return entries;\n      },\n      [] as ResolvedEntry[]\n    );\n  }\n\n  async readFileContent(_resolver: Resolver, url: URL) {\n    const href = url.href;\n\n    if (!href.startsWith(this.rootHref)) {\n      throw new InvariantError(\n        `Attempting to read file content for a model at '${href}' outside of this host's root '${this.rootHref}'`\n      );\n    }\n\n    const pathname = href.slice(this.rootHref.length);\n    const model = Monaco.editor.getModel(Monaco.Uri.file(pathname));\n\n    if (!model) {\n      throw new InvariantError(`Attempting to read file content for a model that doesn't exist at '${href}'`);\n    }\n\n    const encoder = new TextEncoder();\n    const output = await this.getTranspiledValue(model);\n\n    return encoder.encode(output);\n  }\n\n  private async getTranspiledValue(model: Monaco.editor.ITextModel) {\n    if (model.getModeId() === LANGUAGE_TYPESCRIPT) {\n      const href = model.uri.toString(true);\n      const tryLoadFromWorker = async () => {\n        const workerFactory = await Monaco.languages.typescript.getTypeScriptWorker();\n        const workerClient = await workerFactory(model.uri);\n        const [emitOutput, syntacticDiagnostics] = (await Promise.all([\n          workerClient.getEmitOutput(href),\n          workerClient.getSyntacticDiagnostics(href),\n        ])) as [import('typescript').EmitOutput, import('typescript').Diagnostic[]];\n\n        if (emitOutput.emitSkipped) {\n          throw new InvariantError(`Emit skipped when trying to read '${model.uri.fsPath}'`);\n        }\n\n        if (syntacticDiagnostics.length) {\n          const diagnostics: Diagnostic[] = syntacticDiagnostics.map(diagnostic => {\n            const startPosition =\n              typeof diagnostic.start === 'number' ? model.getPositionAt(diagnostic.start) : undefined;\n            const endPosition =\n              typeof diagnostic.start === 'number' && typeof diagnostic.length === 'number'\n                ? model.getPositionAt(diagnostic.start + diagnostic.length)\n                : undefined;\n\n            return {\n              message: flattenDiagnosticMessageText(diagnostic.messageText),\n              start: startPosition ? { lineNumber: startPosition.lineNumber, column: startPosition.column } : undefined,\n              end: endPosition ? { lineNumber: endPosition.lineNumber, column: endPosition.column } : undefined,\n              href: diagnostic.source,\n            };\n          });\n          throw new TranspileError(`${syntacticDiagnostics[0].messageText} at ${model.uri.fsPath}`, diagnostics);\n        }\n\n        return emitOutput.outputFiles[0].text;\n      };\n\n      let attempt = 0;\n\n      while (attempt++ < MAX_TRANSPILE_ATTEMPTS) {\n        try {\n          const code = await raceTimeout(tryLoadFromWorker(), TRANSPILE_TIMEOUT);\n\n          return code;\n        } catch (err) {\n          if (err instanceof TimeoutError) {\n            await timeout(TRANSPILE_TIMEOUT_BACKOFF * Math.pow(2, attempt));\n            continue;\n          }\n\n          throw err;\n        }\n      }\n\n      throw new TimeoutError(`Timed out while trying to transpile '${href}'`);\n    }\n\n    return model.getValue();\n  }\n}\n\nexport function flattenDiagnosticMessageText(\n  diag: string | import('typescript').DiagnosticMessageChain | undefined,\n  newLine: string = '\\n',\n  indent = 0\n): string {\n  if (typeof diag === 'string') {\n    return diag;\n  } else if (diag === undefined) {\n    return '';\n  }\n  let result = '';\n  if (indent) {\n    result += newLine;\n\n    for (let i = 0; i < indent; i++) {\n      result += '  ';\n    }\n  }\n  result += diag.messageText;\n  indent++;\n  if (diag.next) {\n    for (const kid of diag.next) {\n      result += flattenDiagnosticMessageText(kid, newLine, indent);\n    }\n  }\n  return result;\n}\n\nfunction raceTimeout<T>(promise: Promise<T>, timeoutMs: number): Promise<T> {\n  return Promise.race([\n    promise,\n    timeout(timeoutMs).then(() => {\n      return Promise.reject(new TimeoutError());\n    }),\n  ]);\n}\n","import _slicedToArray from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _regeneratorRuntime from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _createClass from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _classCallCheck from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _wrapNativeSuper from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper\";\nimport { ResolvedEntryKind, AbstractResolverHost, CanceledError, Resolver, util } from '@velcro/resolver';\nimport LRU from 'lru-cache';\nimport { validRange, satisfies } from 'semver';\n\nvar ExtendableError =\n/*#__PURE__*/\nfunction (_Error) {\n  _inherits(ExtendableError, _Error);\n\n  function ExtendableError(message) {\n    var _this;\n\n    _classCallCheck(this, ExtendableError);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ExtendableError).call(this, message));\n    _this.name = _this.constructor.name;\n\n    if (typeof Error.captureStackTrace === 'function') {\n      Error.captureStackTrace(_assertThisInitialized(_this), _this.constructor);\n    } else {\n      _this.stack = new Error(message).stack;\n    }\n\n    return _this;\n  }\n\n  return ExtendableError;\n}(_wrapNativeSuper(Error));\n\nvar EntryNotFoundError =\n/*#__PURE__*/\nfunction (_ExtendableError) {\n  _inherits(EntryNotFoundError, _ExtendableError);\n\n  function EntryNotFoundError(url) {\n    _classCallCheck(this, EntryNotFoundError);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(EntryNotFoundError).call(this, \"Not found \".concat(url.href)));\n  }\n\n  return EntryNotFoundError;\n}(ExtendableError);\n\nfunction isValidEntry(entry) {\n  if (!entry || typeof entry !== 'object') return false;\n  if (entry.type === ResolvedEntryKind.Directory) return isValidDirectory(entry);\n  if (entry.type === ResolvedEntryKind.File) return isValidFile(entry);\n  return false;\n}\n\nfunction isValidDirectory(entry) {\n  return typeof entry === 'object' && entry && entry.type === ResolvedEntryKind.Directory && typeof entry.path === 'string' && entry.path && (typeof entry.files === 'undefined' || Array.isArray(entry.files) && entry.files.every(isValidEntry));\n}\n\nfunction isValidFile(entry) {\n  return typeof entry === 'object' && entry && entry.type === ResolvedEntryKind.File && typeof entry.path === 'string' && entry.path;\n}\n\nvar UNPKG_SPEC_RX = /^\\/((@[^/]+\\/[^/@]+|[^/@]+)(?:@([^/]+))?)(.*)?$/;\n\nfunction parseUnpkgUrl(url) {\n  if (url instanceof URL) {\n    url = url.pathname;\n  }\n  /**\r\n   * 1: scope + name + version\r\n   * 2: scope + name\r\n   * 3: version?\r\n   * 4: pathname\r\n   */\n\n\n  var matches = url.match(UNPKG_SPEC_RX);\n\n  if (!matches) {\n    throw new Error(\"Unable to parse unexpected unpkg url: \".concat(url));\n  }\n\n  return {\n    spec: matches[1],\n    name: matches[2],\n    version: matches[3] || '',\n    pathname: matches[4] || ''\n  };\n}\n\nfunction signalFromCancellationToken(token, AbortControllerConstructor) {\n  if (!token || !AbortControllerConstructor) {\n    return;\n  }\n\n  var abortController = new AbortControllerConstructor();\n\n  if (token.isCancellationRequested) {\n    abortController.abort();\n  } else {\n    token.onCancellationRequested(function () {\n      return abortController.abort();\n    });\n  }\n\n  return abortController.signal;\n}\n\nvar UNPKG_PROTOCOL = 'https:';\nvar UNPKG_HOST = 'unpkg.com';\n\nvar ResolverHostUnpkg =\n/*#__PURE__*/\nfunction (_AbstractResolverHost) {\n  _inherits(ResolverHostUnpkg, _AbstractResolverHost);\n\n  function ResolverHostUnpkg() {\n    var _this2;\n\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, ResolverHostUnpkg);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(ResolverHostUnpkg).call(this));\n    _this2.contentCache = new LRU({\n      length: function length(buf) {\n        return buf.byteLength;\n      },\n      max: 1024 * 1024 * 5\n    });\n    _this2.inflightContentRequests = new Map();\n    _this2.packageLock = new Map();\n    _this2.packageEntriesCache = new Map();\n    _this2.packageJsonCache = new Map();\n\n    if (!options.fetch && typeof fetch !== 'function') {\n      throw new TypeError(\"A fetch function must be provided to the \".concat(_this2.constructor.name, \" if the environment doesn't provide one\"));\n    }\n\n    _this2.AbortController = options.AbortController;\n\n    _this2.fetch = options.fetch || function (input, init) {\n      return fetch(input, init);\n    };\n\n    return _this2;\n  }\n\n  _createClass(ResolverHostUnpkg, [{\n    key: \"getCanonicalUrl\",\n    value: function () {\n      var _getCanonicalUrl = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(resolver, url) {\n        var _ref,\n            token,\n            unresolvedSpec,\n            packageJson,\n            _args = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _ref = _args.length > 2 && _args[2] !== undefined ? _args[2] : {}, token = _ref.token;\n\n                if (!(url.protocol !== UNPKG_PROTOCOL || url.hostname !== UNPKG_HOST)) {\n                  _context.next = 3;\n                  break;\n                }\n\n                throw new Error(\"Unable to list non-unpkg entries for \".concat(url.href));\n\n              case 3:\n                unresolvedSpec = parseUnpkgUrl(url);\n                _context.next = 6;\n                return this.readPackageJsonWithCache(resolver, unresolvedSpec, {\n                  token: token\n                });\n\n              case 6:\n                packageJson = _context.sent;\n                return _context.abrupt(\"return\", new URL(\"\".concat(UNPKG_PROTOCOL, \"//\").concat(UNPKG_HOST, \"/\").concat(packageJson.name, \"@\").concat(packageJson.version).concat(unresolvedSpec.pathname)));\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getCanonicalUrl(_x, _x2) {\n        return _getCanonicalUrl.apply(this, arguments);\n      }\n\n      return getCanonicalUrl;\n    }()\n  }, {\n    key: \"getResolveRoot\",\n    value: function () {\n      var _getResolveRoot = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(resolver, url) {\n        var _ref2,\n            token,\n            unresolvedSpec,\n            packageJson,\n            _args2 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _ref2 = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : {}, token = _ref2.token;\n\n                if (!(url.protocol !== UNPKG_PROTOCOL || url.hostname !== UNPKG_HOST)) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                throw new Error(\"Unable to list non-unpkg entries for \".concat(url.href));\n\n              case 3:\n                unresolvedSpec = parseUnpkgUrl(url);\n                _context2.next = 6;\n                return this.readPackageJsonWithCache(resolver, unresolvedSpec, {\n                  token: token\n                });\n\n              case 6:\n                packageJson = _context2.sent;\n                return _context2.abrupt(\"return\", new URL(\"\".concat(UNPKG_PROTOCOL, \"//\").concat(UNPKG_HOST, \"/\").concat(packageJson.name, \"@\").concat(packageJson.version, \"/\")));\n\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getResolveRoot(_x3, _x4) {\n        return _getResolveRoot.apply(this, arguments);\n      }\n\n      return getResolveRoot;\n    }()\n  }, {\n    key: \"listEntries\",\n    value: function () {\n      var _listEntries = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(resolver, url) {\n        var _ref3,\n            token,\n            rootUrl,\n            unresolvedSpec,\n            packageJson,\n            parentEntry,\n            traversalSegments,\n            _loop,\n            _args3 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _ref3 = _args3.length > 2 && _args3[2] !== undefined ? _args3[2] : {}, token = _ref3.token;\n\n                if (!(url.protocol !== UNPKG_PROTOCOL || url.hostname !== UNPKG_HOST)) {\n                  _context3.next = 3;\n                  break;\n                }\n\n                throw new Error(\"Unable to list non-unpkg entries for \".concat(url.href));\n\n              case 3:\n                _context3.next = 5;\n                return resolver.host.getResolveRoot(resolver, url, {\n                  token: token\n                });\n\n              case 5:\n                rootUrl = _context3.sent;\n                unresolvedSpec = parseUnpkgUrl(url);\n                _context3.next = 9;\n                return this.readPackageJsonWithCache(resolver, unresolvedSpec, {\n                  token: token\n                });\n\n              case 9:\n                packageJson = _context3.sent;\n                url.pathname = \"/\".concat(packageJson.name, \"@\").concat(packageJson.version).concat(unresolvedSpec.pathname);\n                _context3.next = 13;\n                return this.readPackageEntriesWithCache(parseUnpkgUrl(url), {\n                  token: token\n                });\n\n              case 13:\n                parentEntry = _context3.sent;\n\n                if (!(token && token.isCancellationRequested)) {\n                  _context3.next = 16;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 16:\n                traversalSegments = unresolvedSpec.pathname.split('/').filter(Boolean);\n\n                _loop = function _loop() {\n                  var segment = traversalSegments.shift();\n\n                  if (parentEntry.type !== ResolvedEntryKind.Directory || !parentEntry.files) {\n                    throw new EntryNotFoundError(url);\n                  }\n\n                  parentEntry = parentEntry.files.find(function (file) {\n                    return file.type === ResolvedEntryKind.Directory && Resolver.path.basename(file.path) === segment;\n                  });\n                };\n\n                while (parentEntry && traversalSegments.length) {\n                  _loop();\n                }\n\n                if (parentEntry) {\n                  _context3.next = 21;\n                  break;\n                }\n\n                throw new EntryNotFoundError(url);\n\n              case 21:\n                if (parentEntry.files) {\n                  _context3.next = 23;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", []);\n\n              case 23:\n                return _context3.abrupt(\"return\", parentEntry.files.map(function (entry) {\n                  return {\n                    type: entry.type,\n                    url: new URL(\".\".concat(entry.path), rootUrl)\n                  };\n                }));\n\n              case 24:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function listEntries(_x5, _x6) {\n        return _listEntries.apply(this, arguments);\n      }\n\n      return listEntries;\n    }()\n  }, {\n    key: \"readFileContent\",\n    value: function () {\n      var _readFileContent = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(_, url) {\n        var _ref4,\n            token,\n            href,\n            cached,\n            inflight,\n            signal,\n            fetch,\n            promise,\n            buf,\n            _args4 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _ref4 = _args4.length > 2 && _args4[2] !== undefined ? _args4[2] : {}, token = _ref4.token;\n\n                if (!(url.protocol !== UNPKG_PROTOCOL || url.hostname !== UNPKG_HOST)) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                throw new Error(\"Unable to read file contents for non-unpkg entries for \".concat(url.href));\n\n              case 3:\n                href = url.href;\n                cached = this.contentCache.get(href);\n\n                if (!cached) {\n                  _context4.next = 7;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", cached);\n\n              case 7:\n                inflight = this.inflightContentRequests.get(href);\n\n                if (!inflight) {\n                  _context4.next = 10;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", inflight);\n\n              case 10:\n                // console.log('[MISS] readFileContent(%s)', href);\n                signal = signalFromCancellationToken(token, this.AbortController);\n                fetch = this.fetch;\n                promise = fetch(href, {\n                  redirect: 'follow',\n                  signal: signal\n                }).then(function (res) {\n                  if (!res.ok) {\n                    throw new Error(\"Error reading file content for \".concat(href, \": \").concat(res.status));\n                  }\n\n                  return res.arrayBuffer();\n                }).catch(function (err) {\n                  if (signal && signal.aborted) {\n                    throw new CanceledError('Canceled');\n                  }\n\n                  throw err;\n                });\n                this.inflightContentRequests.set(href, promise);\n                _context4.prev = 14;\n                _context4.next = 17;\n                return promise;\n\n              case 17:\n                buf = _context4.sent;\n                this.contentCache.set(href, buf);\n                return _context4.abrupt(\"return\", buf);\n\n              case 20:\n                _context4.prev = 20;\n                this.inflightContentRequests.delete(href);\n                return _context4.finish(20);\n\n              case 23:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[14,, 20, 23]]);\n      }));\n\n      function readFileContent(_x7, _x8) {\n        return _readFileContent.apply(this, arguments);\n      }\n\n      return readFileContent;\n    }()\n  }, {\n    key: \"readPackageEntriesWithCache\",\n    value: function () {\n      var _readPackageEntriesWithCache = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(spec) {\n        var _ref5,\n            token,\n            lockKey,\n            lock,\n            range,\n            packageEntriesCacheForModule,\n            exactMatch,\n            _iteratorNormalCompletion,\n            _didIteratorError,\n            _iteratorError,\n            _iterator,\n            _step,\n            _ref8,\n            _ref7,\n            version,\n            _packageEntries,\n            promise,\n            packageEntries,\n            _args5 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _ref5 = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : {}, token = _ref5.token;\n                lockKey = \"entries:\".concat(spec.name);\n                lock = this.packageLock.get(lockKey);\n\n                if (!lock) {\n                  _context5.next = 6;\n                  break;\n                }\n\n                _context5.next = 6;\n                return lock;\n\n              case 6:\n                range = validRange(spec.version);\n\n                if (range) {\n                  _context5.next = 9;\n                  break;\n                }\n\n                throw new Error(\"Invalid SemVer range for spec \".concat(spec.spec));\n\n              case 9:\n                packageEntriesCacheForModule = this.packageEntriesCache.get(spec.name);\n\n                if (!packageEntriesCacheForModule) {\n                  _context5.next = 45;\n                  break;\n                }\n\n                exactMatch = packageEntriesCacheForModule.get(spec.version);\n\n                if (!exactMatch) {\n                  _context5.next = 14;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\", exactMatch);\n\n              case 14:\n                _iteratorNormalCompletion = true;\n                _didIteratorError = false;\n                _iteratorError = undefined;\n                _context5.prev = 17;\n                _iterator = packageEntriesCacheForModule[Symbol.iterator]();\n\n              case 19:\n                if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n                  _context5.next = 29;\n                  break;\n                }\n\n                _ref8 = _step.value;\n                _ref7 = _slicedToArray(_ref8, 2);\n                version = _ref7[0];\n                _packageEntries = _ref7[1];\n\n                if (!satisfies(version, range)) {\n                  _context5.next = 26;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\", _packageEntries);\n\n              case 26:\n                _iteratorNormalCompletion = true;\n                _context5.next = 19;\n                break;\n\n              case 29:\n                _context5.next = 35;\n                break;\n\n              case 31:\n                _context5.prev = 31;\n                _context5.t0 = _context5[\"catch\"](17);\n                _didIteratorError = true;\n                _iteratorError = _context5.t0;\n\n              case 35:\n                _context5.prev = 35;\n                _context5.prev = 36;\n\n                if (!_iteratorNormalCompletion && _iterator.return != null) {\n                  _iterator.return();\n                }\n\n              case 38:\n                _context5.prev = 38;\n\n                if (!_didIteratorError) {\n                  _context5.next = 41;\n                  break;\n                }\n\n                throw _iteratorError;\n\n              case 41:\n                return _context5.finish(38);\n\n              case 42:\n                return _context5.finish(35);\n\n              case 43:\n                _context5.next = 47;\n                break;\n\n              case 45:\n                packageEntriesCacheForModule = new Map();\n                this.packageEntriesCache.set(spec.name, packageEntriesCacheForModule);\n\n              case 47:\n                // console.log('[MISS] readPackageEntriesWithCache(%s)', spec.spec);\n                promise = this.readPackageEntries(spec.spec, {\n                  token: token\n                });\n                this.packageLock.set(lockKey, promise);\n                _context5.next = 51;\n                return promise;\n\n              case 51:\n                packageEntries = _context5.sent;\n                this.packageLock.delete(lockKey);\n                packageEntriesCacheForModule.set(spec.version, packageEntries);\n                return _context5.abrupt(\"return\", packageEntries);\n\n              case 55:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[17, 31, 35, 43], [36,, 38, 42]]);\n      }));\n\n      function readPackageEntriesWithCache(_x9) {\n        return _readPackageEntriesWithCache.apply(this, arguments);\n      }\n\n      return readPackageEntriesWithCache;\n    }()\n  }, {\n    key: \"readPackageJsonWithCache\",\n    value: function () {\n      var _readPackageJsonWithCache = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6(resolver, spec) {\n        var _ref9,\n            token,\n            lockKey,\n            lock,\n            packageJsonCacheForModule,\n            exactMatch,\n            range,\n            _iteratorNormalCompletion2,\n            _didIteratorError2,\n            _iteratorError2,\n            _iterator2,\n            _step2,\n            _ref12,\n            _ref11,\n            version,\n            _packageJson,\n            promise,\n            packageJson,\n            _args6 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _ref9 = _args6.length > 2 && _args6[2] !== undefined ? _args6[2] : {}, token = _ref9.token;\n                lockKey = \"packageJson:\".concat(spec.spec);\n                lock = this.packageLock.get(lockKey);\n\n                if (!lock) {\n                  _context6.next = 6;\n                  break;\n                }\n\n                _context6.next = 6;\n                return lock;\n\n              case 6:\n                packageJsonCacheForModule = this.packageJsonCache.get(spec.name);\n\n                if (!packageJsonCacheForModule) {\n                  _context6.next = 44;\n                  break;\n                }\n\n                exactMatch = packageJsonCacheForModule.get(spec.version);\n\n                if (!exactMatch) {\n                  _context6.next = 11;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\", exactMatch);\n\n              case 11:\n                range = validRange(spec.version);\n\n                if (!range) {\n                  _context6.next = 42;\n                  break;\n                }\n\n                _iteratorNormalCompletion2 = true;\n                _didIteratorError2 = false;\n                _iteratorError2 = undefined;\n                _context6.prev = 16;\n                _iterator2 = packageJsonCacheForModule[Symbol.iterator]();\n\n              case 18:\n                if (_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done) {\n                  _context6.next = 28;\n                  break;\n                }\n\n                _ref12 = _step2.value;\n                _ref11 = _slicedToArray(_ref12, 2);\n                version = _ref11[0];\n                _packageJson = _ref11[1];\n\n                if (!satisfies(version, range)) {\n                  _context6.next = 25;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\", _packageJson);\n\n              case 25:\n                _iteratorNormalCompletion2 = true;\n                _context6.next = 18;\n                break;\n\n              case 28:\n                _context6.next = 34;\n                break;\n\n              case 30:\n                _context6.prev = 30;\n                _context6.t0 = _context6[\"catch\"](16);\n                _didIteratorError2 = true;\n                _iteratorError2 = _context6.t0;\n\n              case 34:\n                _context6.prev = 34;\n                _context6.prev = 35;\n\n                if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n                  _iterator2.return();\n                }\n\n              case 37:\n                _context6.prev = 37;\n\n                if (!_didIteratorError2) {\n                  _context6.next = 40;\n                  break;\n                }\n\n                throw _iteratorError2;\n\n              case 40:\n                return _context6.finish(37);\n\n              case 41:\n                return _context6.finish(34);\n\n              case 42:\n                _context6.next = 46;\n                break;\n\n              case 44:\n                packageJsonCacheForModule = new Map();\n                this.packageJsonCache.set(spec.name, packageJsonCacheForModule);\n\n              case 46:\n                // console.log('[MISS] readPackageJsonWithCache(%s)', spec.spec);\n                promise = this.readPackageJson(resolver, spec.spec, {\n                  token: token\n                });\n                this.packageLock.set(lockKey, promise);\n                _context6.next = 50;\n                return promise;\n\n              case 50:\n                packageJson = _context6.sent;\n                this.packageLock.delete(lockKey);\n\n                if (packageJson.version) {\n                  _context6.next = 54;\n                  break;\n                }\n\n                throw new Error(\"Manifest missing a version identifier for \".concat(spec));\n\n              case 54:\n                packageJsonCacheForModule.set(packageJson.version, packageJson);\n                return _context6.abrupt(\"return\", packageJson);\n\n              case 56:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this, [[16, 30, 34, 42], [35,, 37, 41]]);\n      }));\n\n      function readPackageJsonWithCache(_x10, _x11) {\n        return _readPackageJsonWithCache.apply(this, arguments);\n      }\n\n      return readPackageJsonWithCache;\n    }()\n  }, {\n    key: \"readPackageJson\",\n    value: function () {\n      var _readPackageJson = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee7(resolver, spec) {\n        var _ref13,\n            token,\n            href,\n            content,\n            manifest,\n            _args7 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _ref13 = _args7.length > 2 && _args7[2] !== undefined ? _args7[2] : {}, token = _ref13.token;\n                // console.log('readPackageJson(%s)', spec);\n                href = \"\".concat(UNPKG_PROTOCOL, \"//\").concat(UNPKG_HOST, \"/\").concat(spec, \"/package.json\");\n                _context7.next = 4;\n                return this.readFileContent(resolver, new URL(href), {\n                  token: token\n                });\n\n              case 4:\n                content = _context7.sent;\n                _context7.prev = 5;\n                manifest = util.parseBufferAsPackageJson(resolver.decoder, content, spec);\n                _context7.next = 12;\n                break;\n\n              case 9:\n                _context7.prev = 9;\n                _context7.t0 = _context7[\"catch\"](5);\n                throw new Error(\"Error parsing manifest as json for package \".concat(spec, \": \").concat(_context7.t0.message));\n\n              case 12:\n                return _context7.abrupt(\"return\", manifest);\n\n              case 13:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this, [[5, 9]]);\n      }));\n\n      function readPackageJson(_x12, _x13) {\n        return _readPackageJson.apply(this, arguments);\n      }\n\n      return readPackageJson;\n    }()\n  }, {\n    key: \"readPackageEntries\",\n    value: function () {\n      var _readPackageEntries = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee8(spec) {\n        var _ref14,\n            token,\n            href,\n            signal,\n            fetch,\n            res,\n            json,\n            _args8 = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _ref14 = _args8.length > 1 && _args8[1] !== undefined ? _args8[1] : {}, token = _ref14.token;\n                // console.log('readPackageEntries(%s)', spec);\n                href = \"\".concat(UNPKG_PROTOCOL, \"//\").concat(UNPKG_HOST, \"/\").concat(spec, \"/?meta\");\n                signal = signalFromCancellationToken(token, this.AbortController);\n                fetch = this.fetch;\n                _context8.next = 6;\n                return fetch(href, {\n                  signal: signal\n                }).catch(function (err) {\n                  if (signal && signal.aborted) {\n                    throw new CanceledError('Canceled');\n                  }\n\n                  throw err;\n                });\n\n              case 6:\n                res = _context8.sent;\n\n                if (res.ok) {\n                  _context8.next = 9;\n                  break;\n                }\n\n                throw new Error(\"Error listing package contents for \".concat(spec, \": \").concat(res.status));\n\n              case 9:\n                _context8.next = 11;\n                return res.json();\n\n              case 11:\n                json = _context8.sent;\n\n                if (isValidDirectory(json)) {\n                  _context8.next = 14;\n                  break;\n                }\n\n                throw new Error(\"Unexpected response payload while listing package contents for \".concat(spec));\n\n              case 14:\n                return _context8.abrupt(\"return\", json);\n\n              case 15:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function readPackageEntries(_x14) {\n        return _readPackageEntries.apply(this, arguments);\n      }\n\n      return readPackageEntries;\n    }()\n  }], [{\n    key: \"resolveBareModule\",\n    value: function resolveBareModule(_, spec) {\n      return new URL(\"\".concat(UNPKG_PROTOCOL, \"//\").concat(UNPKG_HOST, \"/\").concat(spec.name, \"@\").concat(spec.spec).concat(spec.pathname));\n    }\n  }]);\n\n  return ResolverHostUnpkg;\n}(AbstractResolverHost);\n\nexport { ResolverHostUnpkg, isValidDirectory, isValidEntry, isValidFile };","import { Bundler } from '@velcro/bundler';\nimport { Resolver, AbstractResolverHost, ResolverHost } from '@velcro/resolver';\nimport { openDB } from 'idb';\nimport { timeout } from 'ts-primitives';\nimport { TimeoutError } from './error';\n\ntype ThenArg<T> = T extends Promise<infer U> ? U : T;\n\nexport class ResolverHostWithCache extends AbstractResolverHost {\n  private readonly idbPromise = openDB('velcro', Bundler.schemaVersion, {\n    async upgrade(db, oldVersion, newVersion, transaction) {\n      console.log('Upgrading cache from version %s to %s', oldVersion, newVersion);\n\n      if (!oldVersion) {\n        db.createObjectStore('getCanonicalUrl');\n        db.createObjectStore('getResolveRoot');\n        db.createObjectStore('listEntries');\n        db.createObjectStore('readFileContent');\n      }\n\n      await transaction.objectStore('getCanonicalUrl').clear();\n      await transaction.objectStore('getResolveRoot').clear();\n      await transaction.objectStore('listEntries').clear();\n      await transaction.objectStore('readFileContent').clear();\n    },\n  }).catch(err => {\n    console.error(err, 'error opening IndexedDB');\n\n    return null;\n  });\n\n  private readonly hostTimeout: number;\n  private readonly idbTimeout: number;\n\n  private readonly inflightGetCanonicalUrl = new Map<string, ReturnType<ResolverHost['getCanonicalUrl']>>();\n  private readonly inflightGetResolveRoot = new Map<string, ReturnType<ResolverHost['getResolveRoot']>>();\n  private readonly inflightListEntries = new Map<string, ReturnType<ResolverHost['listEntries']>>();\n  private readonly inflightReadFileContent = new Map<string, ReturnType<ResolverHost['readFileContent']>>();\n\n  private readonly getCanonicalUrlCache = new Map<string, ThenArg<ReturnType<ResolverHost['getCanonicalUrl']>>>();\n  private readonly getResolveRootCache = new Map<string, ThenArg<ReturnType<ResolverHost['getResolveRoot']>>>();\n  private readonly listEntriesCache = new Map<string, ThenArg<ReturnType<ResolverHost['listEntries']>>>();\n  private readonly readFileContentCache = new Map<string, ThenArg<ReturnType<ResolverHost['readFileContent']>>>();\n\n  constructor(readonly host: ResolverHost, { idbTimeout = 1000, hostTimeout = 10000 } = {}) {\n    super();\n\n    this.hostTimeout = hostTimeout;\n    this.idbTimeout = idbTimeout;\n  }\n\n  private async withCache<T, C = unknown>(\n    href: string,\n    loadFn: () => Promise<T>,\n    cache: Map<string, T>,\n    inflightMap: Map<string, Promise<T>>,\n    storeName: string,\n    serialize?: (result: T) => C,\n    deserialize?: (cached: C) => T\n  ): Promise<T> {\n    if (cache.has(href)) {\n      return cache.get(href)!;\n    }\n\n    const idb = await withTimeout(this.idbTimeout, this.idbPromise, `this.idbPromise`).catch(_ => undefined);\n\n    if (idb) {\n      const cached = await withTimeout(\n        this.idbTimeout,\n        idb.get(storeName, href),\n        `idb.get(${storeName}, ${href})`\n      ).catch(_ => undefined);\n\n      if (cached) {\n        const result = (deserialize ? deserialize(cached as any) : cached) as T;\n\n        cache.set(href, result);\n\n        return result;\n      }\n    }\n\n    let inflight = inflightMap.get(href);\n\n    if (!inflight) {\n      inflight = withTimeout(this.hostTimeout, loadFn(), `Timed out on operation '${storeName}' for '${href}'`);\n      inflightMap.set(href, inflight);\n\n      // Make sure we don't get an uncaught rejection\n      inflight\n        .then(result => {\n          cache.set(href, result);\n\n          if (idb) {\n            idb.put(storeName, serialize ? serialize(result) : result, href).catch(_ => undefined);\n          }\n        })\n        .catch(_ => undefined)\n        .then(() => {\n          inflightMap.delete(href);\n        });\n    }\n\n    return inflight;\n  }\n\n  async getCanonicalUrl(resolver: Resolver, url: URL) {\n    const result = await this.withCache(\n      url.href,\n      () => this.host.getCanonicalUrl(resolver, url),\n      this.getCanonicalUrlCache,\n      this.inflightGetCanonicalUrl,\n      'getCanonicalUrl',\n      url => url.href,\n      href => new URL(href)\n    );\n\n    return result;\n  }\n\n  async getResolveRoot(resolver: Resolver, url: URL) {\n    const result = await this.withCache(\n      url.href,\n      () => this.host.getResolveRoot(resolver, url),\n      this.getResolveRootCache,\n      this.inflightGetResolveRoot,\n      'getResolveRoot',\n      url => url.href,\n      href => new URL(href)\n    );\n\n    return result;\n  }\n\n  async listEntries(resolver: Resolver, url: URL) {\n    const result = await this.withCache(\n      url.href,\n      () => this.host.listEntries(resolver, url),\n      this.listEntriesCache,\n      this.inflightListEntries,\n      'listEntries',\n      entries =>\n        entries.map(entry => ({\n          type: entry.type,\n          href: entry.url.href,\n        })),\n      cached =>\n        cached.map(entry => ({\n          type: entry.type,\n          url: new URL(entry.href),\n        }))\n    );\n\n    return result;\n  }\n\n  async readFileContent(resolver: Resolver, url: URL) {\n    try {\n      const result = await this.withCache(\n        url.href,\n        () => this.host.readFileContent(resolver, url),\n        this.readFileContentCache,\n        this.inflightReadFileContent,\n        'readFileContent'\n      );\n\n      return result;\n    } catch (err) {\n      throw err;\n    }\n  }\n}\n\nfunction withTimeout<T>(duration: number, promise: Promise<T>, message: string) {\n  return Promise.race([\n    promise,\n    timeout(duration).then(() => {\n      return Promise.reject(new TimeoutError(message));\n    }),\n  ]);\n}\n","import * as Monaco from 'monaco-editor';\nimport { Emitter, IDisposable, DisposableStore, ThrottledDelayer } from 'ts-primitives';\nimport { useState, useEffect, useContext, createContext } from 'react';\nimport { TypeAcquirer } from './typeAcquisition';\nimport { Bundler } from '@velcro/bundler';\nimport { Resolver } from '@velcro/resolver';\nimport { ResolverHostCompound } from '@velcro/resolver-host-compound';\nimport { ResolverHostMonaco } from '../lib/ResolverHostMonaco';\nimport { ResolverHostUnpkg } from '@velcro/resolver-host-unpkg';\nimport { ResolverHostWithCache } from '../lib/ResolverHostWithCache';\n\nconst rootUri = Monaco.Uri.file('/');\n\nexport class EditorManager implements IDisposable {\n  readonly bundler = new Bundler({\n    resolver: new Resolver(\n      new ResolverHostCompound({\n        'https://unpkg.com/': new ResolverHostWithCache(new ResolverHostUnpkg()),\n        [rootUri.toString(true)]: new ResolverHostMonaco(rootUri),\n      }),\n      {\n        extensions: ['.js', '.jsx', '.ts', '.tsx'],\n        packageMain: ['browser', 'main'],\n      }\n    ),\n  });\n\n  editor: Monaco.editor.IStandaloneCodeEditor | null = null;\n\n  private readonly disposableStore = new DisposableStore();\n  private readonly initialPath: string | undefined;\n\n  private readonly typeAcquirer = new TypeAcquirer(this.bundler.resolver, ResolverHostUnpkg.resolveBareModule);\n  private readonly viewState = new WeakMap<Monaco.editor.ITextModel, Monaco.editor.ICodeEditorViewState>();\n\n  private readonly onWillFocusModelEmitter = new Emitter<Monaco.editor.ITextModel>();\n  private readonly onDidChangeEmitter = new Emitter<{ model: Monaco.editor.ITextModel }>();\n\n  constructor(options: { files?: Record<string, string>; initialPath?: string } = {}) {\n    this.disposableStore.add(this.onWillFocusModelEmitter);\n    this.disposableStore.add(this.onDidChangeEmitter);\n\n    Monaco.languages.typescript.typescriptDefaults.setEagerModelSync(true);\n    Monaco.languages.typescript.typescriptDefaults.setMaximumWorkerIdleTime(-1);\n    Monaco.languages.typescript.typescriptDefaults.setCompilerOptions({\n      allowJs: true,\n      allowNonTsExtensions: true,\n      allowSyntheticDefaultImports: true,\n      baseUrl: '.',\n      checkJs: true,\n      esModuleInterop: true,\n      experimentalDecorators: true,\n      inlineSourceMap: true,\n      inlineSources: true,\n      isolatedModules: false,\n      jsx: Monaco.languages.typescript.JsxEmit.React,\n      lib: ['dom'],\n      module: Monaco.languages.typescript.ModuleKind.CommonJS,\n      moduleResolution: Monaco.languages.typescript.ModuleResolutionKind.NodeJs,\n      noEmit: false,\n      outDir: `dist`,\n      resolveJsonModule: true,\n      rootDir: '/',\n      sourceMap: true,\n      target: Monaco.languages.typescript.ScriptTarget.ES2015,\n      typeRoots: ['node_modules/@types'],\n    });\n    Monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({\n      noSemanticValidation: true,\n      noSyntaxValidation: false,\n    });\n\n    if (options.files) {\n      for (const pathname in options.files) {\n        const content = options.files[pathname];\n\n        this.createModel(pathname, content);\n      }\n    }\n\n    Monaco.editor.onDidCreateModel(model => {\n      const onDidChangePackageJson = async () => {\n        const value = model.getValue();\n\n        let dependencies = {\n          typescript: Monaco.languages.typescript.typescriptVersion,\n        };\n\n        try {\n          const pkgJson = JSON.parse(value);\n\n          if (pkgJson.dependencies) {\n            dependencies = { ...dependencies, ...pkgJson.dependencies };\n          }\n        } catch (_) {\n          // Ignore\n        }\n\n        Monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({ noSemanticValidation: true });\n        await this.typeAcquirer.importTypesForSpecs(dependencies);\n        Monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({ noSemanticValidation: false });\n      };\n\n      if (model.uri.toString(true) === `${rootUri.toString(true)}package.json`) {\n        const throttler = new ThrottledDelayer(1500);\n        throttler.trigger(onDidChangePackageJson);\n\n        this.disposableStore.add(model.onDidChangeContent(() => throttler.trigger(onDidChangePackageJson)));\n        this.disposableStore.add(throttler);\n      }\n    });\n\n    this.disposableStore.add(\n      this.typeAcquirer.onTypeFile(file => {\n        this.disposableStore.add(\n          Monaco.languages.typescript.typescriptDefaults.addExtraLib(\n            file.content,\n            Monaco.Uri.file(file.pathname).toString(true)\n          )\n        );\n      })\n    );\n\n    this.initialPath = options.initialPath;\n  }\n\n  get dispose() {\n    return this.disposableStore.dispose;\n  }\n\n  get onDidChange() {\n    return this.onDidChangeEmitter.event;\n  }\n\n  get onWillFocusModel() {\n    return this.onWillFocusModelEmitter.event;\n  }\n\n  createModel(pathname: string, content = '') {\n    const language = this.inferLanguage(pathname);\n\n    let uri: Monaco.Uri;\n\n    try {\n      uri = Monaco.Uri.file(pathname);\n    } catch (err) {\n      throw new Error(`Invalid path '${pathname}': ${err && err.message}`);\n    }\n\n    if (Monaco.editor.getModel(uri)) {\n      throw new Error(`Cannot create file because it exists '${pathname}'`);\n    }\n\n    return Monaco.editor.createModel(content, language, uri);\n  }\n\n  focusHref(\n    href: string,\n    options: { lineNumber?: number; columnNumber?: number; markers?: Monaco.editor.IMarkerData[] } = {}\n  ) {\n    const model = this.getModelByHref(href);\n\n    if (model) {\n      this.focusModel(model, options);\n    }\n  }\n\n  focusModel(\n    model: Monaco.editor.ITextModel,\n    options: { lineNumber?: number; columnNumber?: number; markers?: Monaco.editor.IMarkerData[] } = {}\n  ) {\n    if (this.editor) {\n      this.editor.setModel(model);\n      if (options.lineNumber) {\n        this.editor.revealLineInCenter(options.lineNumber, Monaco.editor.ScrollType.Smooth);\n        this.editor.setPosition({\n          column: options.columnNumber || 0,\n          lineNumber: options.lineNumber,\n        });\n      }\n      if (options.markers) {\n        Monaco.editor.setModelMarkers(model, 'editorManager', options.markers);\n      }\n      this.editor.focus();\n    }\n  }\n\n  focusPath(\n    path: string,\n    options: { lineNumber?: number; columnNumber?: number; markers?: Monaco.editor.IMarkerData[] } = {}\n  ) {\n    const model = this.getModelByPath(path);\n\n    if (model) {\n      this.focusModel(model, options);\n    }\n  }\n\n  getModelByHref(href: string) {\n    try {\n      const uri = Monaco.Uri.parse(href);\n      return Monaco.editor.getModel(uri);\n    } catch (_) {\n      return null;\n    }\n  }\n\n  getModelByPath(path: string) {\n    return Monaco.editor.getModel(Monaco.Uri.file(path));\n  }\n\n  mount(el: HTMLElement) {\n    if (this.editor) {\n      throw new Error('Invariant violation: Editor already mounted');\n    }\n\n    this.editor = Monaco.editor.create(el, {\n      model: null,\n      automaticLayout: true,\n      showUnused: true,\n      scrollBeyondLastLine: false,\n      theme: 'vs',\n      wordWrap: 'bounded',\n      wrappingIndent: 'same',\n    });\n\n    this.editor.onDidDispose(() => {\n      this.editor = null;\n    });\n\n    this.editor.onDidChangeModel(e => {\n      if (e.newModelUrl && this.editor) {\n        const model = Monaco.editor.getModel(e.newModelUrl)!;\n        const viewState = this.viewState.get(model);\n\n        if (viewState) {\n          this.editor.restoreViewState(viewState);\n        }\n      }\n    });\n\n    this.editor.onDidBlurEditorText(() => {\n      if (this.editor) {\n        const model = this.editor.getModel();\n        const viewState = this.editor.saveViewState();\n\n        if (model && viewState) {\n          this.viewState.set(model, viewState);\n        }\n      }\n    });\n\n    this.disposableStore.add(this.editor);\n\n    if (this.initialPath) {\n      this.focusPath(this.initialPath);\n    }\n\n    return this.editor;\n  }\n\n  inferLanguage(pathname: string) {\n    return pathname.match(/\\.(?:tsx?|jsx?)$/) ? 'typescript' : undefined;\n  }\n}\n\nexport const EditorManagerContext = createContext(new EditorManager());\n\nexport function useActiveModel() {\n  const workbench = useContext(EditorManagerContext);\n  const [activeModel, setActiveModel] = useState<Monaco.editor.ITextModel | null>(\n    workbench.editor ? workbench.editor.getModel() : null\n  );\n\n  useEffect(() => {\n    const disposable = new DisposableStore();\n\n    const trackEditor = (editor: Monaco.editor.ICodeEditor) => {\n      editor.onDidChangeModel(e => {\n        const model = e.newModelUrl ? Monaco.editor.getModel(e.newModelUrl) : null;\n\n        setActiveModel(model);\n      });\n\n      disposable.add(\n        editor.onDidBlurEditorText(() => {\n          setActiveModel(null);\n        })\n      );\n\n      disposable.add(\n        editor.onDidFocusEditorText(() => {\n          setActiveModel(editor.getModel());\n        })\n      );\n\n      if (editor.hasTextFocus()) {\n        setActiveModel(editor.getModel());\n      }\n    };\n\n    disposable.add(Monaco.editor.onDidCreateEditor(trackEditor));\n    if (workbench.editor) {\n      trackEditor(workbench.editor);\n    }\n\n    return () => disposable.dispose();\n  }, [workbench.editor, activeModel]);\n\n  return activeModel;\n}\n","import styled from '@emotion/styled/macro';\nimport React, { useRef, useEffect, useContext } from 'react';\nimport { EditorManagerContext } from '../lib/EditorManager';\n\nconst Editor: React.FC<{\n  className?: string;\n}> = ({ className }) => {\n  const el = useRef<HTMLDivElement | null>(null);\n  const editorManager = useContext(EditorManagerContext);\n\n  useEffect(() => {\n    if (!el.current) {\n      return;\n    }\n\n    const editor = editorManager.mount(el.current);\n\n    return () => {\n      editor.dispose();\n    };\n  }, [editorManager, el]);\n\n  return (\n    <div className={className} ref={el}>\n      <div></div>\n    </div>\n  );\n};\n\nexport default styled(Editor)``;\n","import styled from '@emotion/styled/macro';\nimport { InvariantViolation, Runtime } from '@velcro/bundler';\nimport { CanceledError } from '@velcro/resolver';\nimport * as Monaco from 'monaco-editor';\nimport React, { useEffect, useRef, useContext, useState } from 'react';\nimport {\n  Delayer,\n  Throttler,\n  DisposableStore,\n  CancellationTokenSource,\n  IDisposable,\n  Emitter,\n  Event,\n  timeout,\n} from 'ts-primitives';\n\nimport { EditorManagerContext } from '../lib/EditorManager';\nimport { TimeoutError } from '../lib/error';\nimport { Bundle } from '@velcro/bundler/dist/dist-main/bundle';\n\nexport interface DeferredExecutionModuleRecord {\n  code: string;\n  dependencies: Record<string, string>;\n}\n\nexport interface DeferredExecutionManifest {\n  aliases: Record<string, string>;\n  entrypoints: Record<string, string>;\n  modules: Record<string, DeferredExecutionModuleRecord>;\n}\n\ninterface MessageLine {\n  isInternal: boolean;\n  text: string;\n}\ninterface Message {\n  lines: MessageLine[];\n}\n\nconst PreviewProgress = styled.div<{ completed: number; total: number }>`\n  z-index: 1;\n  position: absolute;\n  top: 0;\n  width: ${props => (props.total ? `${Math.round((100 * props.completed) / props.total)}%` : 0)};\n  left: 0;\n  height: ${props => (props.total ? '2px' : '0')};\n  background-color: #008cba;\n  transition: width 0.5s 0s cubic-bezier(0.455, 0.03, 0.515, 0.955);\n`;\nconst PreviewIframeWrap = styled.div`\n  position: relative;\n  overflow: hidden;\n\n  & > iframe {\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    border: none;\n    width: 100%;\n    height: 100%;\n  }\n`;\nconst PreviewWrap = styled.div`\n  position: relative;\n  ${PreviewIframeWrap} {\n    position: absolute;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n  }\n`;\nconst PreviewMessageError = styled.ul`\n  margin: 0;\n  padding: 1em 2em;\n  font-family: monospace;\n  font-size: 16px;\n  background-color: rgba(255, 0, 0, 0.5);\n  backdrop-filter: brightness(50%);\n  color: white;\n  list-style: none;\n`;\nconst PreviewMessageErrorText = styled.li<{ isInternal: boolean }>`\n  white-space: pre-wrap;\n  opacity: ${props => (props.isInternal ? 0.7 : 1.0)};\n`;\nconst PreviewMessages = styled.div`\n  z-index: 1;\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  display: flex;\n  flex-direction: column-reverse;\n`;\nconst PreviewMessageLine: React.FC<{ line: MessageLine }> = ({ line }) => {\n  return <PreviewMessageErrorText isInternal={line.isInternal}>{line.text}</PreviewMessageErrorText>;\n};\nconst PreviewMessage: React.FC<{ message: Message }> = ({ message }) => {\n  return message.lines.length ? (\n    <PreviewMessageError>\n      {message.lines.map((line, i) => (\n        <PreviewMessageLine key={i} line={line}></PreviewMessageLine>\n      ))}\n    </PreviewMessageError>\n  ) : null;\n};\n\nconst Preview: React.FC<{ className?: string }> = props => {\n  const invalidations = useRef(new Set<string>());\n  const previewWrapRef = useRef<HTMLDivElement | null>(null);\n  const hmrClientRef = useRef<HmrClient | null>(null);\n  const previewIframeRef = useRef<HTMLIFrameElement | null>(null);\n  const editorManager = useContext(EditorManagerContext);\n  const [messages, setMessages] = useState([] as Message[]);\n  const [buildProgress, setBuildProgress] = useState({ completed: 0, total: 0 });\n  const runtimeBundleString = useRef('');\n\n  useEffect(() => {\n    const disposable = new DisposableStore();\n    const delayer = new Delayer(500);\n    const throttler = new Throttler();\n\n    let tokenSource = new CancellationTokenSource();\n\n    const queueRefreshPreview = (uris: string[]) => {\n      tokenSource.cancel();\n      tokenSource.dispose();\n\n      tokenSource = new CancellationTokenSource();\n\n      for (const uri of uris) {\n        invalidations.current.add(uri);\n      }\n\n      delayer.trigger(() => throttler.queue(() => refreshPreview(tokenSource.token)));\n    };\n\n    const refreshPreview = async (token: Monaco.CancellationToken) => {\n      const toInvalidate = Array.from(invalidations.current);\n\n      setMessages([]);\n\n      invalidations.current.clear();\n\n      setBuildProgress({ completed: 0, total: 0 });\n\n      let building = true;\n\n      try {\n        await Promise.all(\n          toInvalidate.map(spec => {\n            return editorManager.bundler.invalidate(spec, { token });\n          })\n        );\n\n        if (!runtimeBundleString.current) {\n          const runtimeBundle = await editorManager.bundler.generateBundle(\n            [\n              {\n                type: 'inline',\n                code: `(${createBundleRuntime.toString().replace(/velcroRequire/g, 'require')})();`,\n                href: 'playground:///runtime.js',\n              },\n            ],\n            {\n              dependencies: {\n                'react-error-overlay': '^6.0.3',\n              },\n              onCompleteAsset: () => {\n                if (building) {\n                  setBuildProgress(buildProgress => {\n                    return {\n                      completed: buildProgress.completed + 1,\n                      total: buildProgress.total,\n                    };\n                  });\n                }\n              },\n              onEnqueueAsset: () => {\n                if (building) {\n                  setBuildProgress(buildProgress => {\n                    return {\n                      completed: buildProgress.completed,\n                      total: buildProgress.total + 1,\n                    };\n                  });\n                }\n              },\n              token,\n            }\n          );\n\n          runtimeBundleString.current = runtimeBundle.toString({ executeEntrypoints: true, sourceMap: false });\n        }\n\n        let build: Bundle | Error;\n\n        try {\n          const unresolvedEntrypointHref = Monaco.Uri.file('/').toString(true);\n          const resolvedEntrypoint = await editorManager.bundler.resolver.resolve(unresolvedEntrypointHref);\n\n          if (!resolvedEntrypoint.resolvedUrl) {\n            throw new Error(`Unable to determine the entrypoing to your code`);\n          }\n\n          const resolvedEntrypointHref = resolvedEntrypoint.resolvedUrl.href;\n\n          build = await editorManager.bundler.generateBundle(\n            [\n              {\n                type: 'href',\n                href: resolvedEntrypointHref,\n              },\n            ],\n            {\n              onCompleteAsset: () => {\n                if (building) {\n                  setBuildProgress(buildProgress => {\n                    return {\n                      completed: buildProgress.completed + 1,\n                      total: buildProgress.total,\n                    };\n                  });\n                }\n              },\n              onEnqueueAsset: () => {\n                if (building) {\n                  setBuildProgress(buildProgress => {\n                    return {\n                      completed: buildProgress.completed,\n                      total: buildProgress.total + 1,\n                    };\n                  });\n                }\n              },\n              token,\n            }\n          );\n        } catch (err) {\n          build = err;\n        }\n\n        if (hmrClientRef.current) {\n          if (build instanceof CanceledError || (build instanceof Error && build.name === 'CanceledError')) {\n            return;\n          } else if (build instanceof Error) {\n            hmrClientRef.current.send({\n              type: 'build_error',\n              message: build.message,\n              stack: build.stack,\n            });\n          } else {\n            const updatedBundleFile = new File(\n              [build.toString({ executeEntrypoints: true, runtime: '__velcroRuntime', sourceMap: true })],\n              'playground:///runtime.js',\n              {\n                type: 'text/javascript',\n              }\n            );\n            const updatedBundleHref = URL.createObjectURL(updatedBundleFile);\n\n            hmrClientRef.current.send({\n              type: 'reload',\n              invalidations: toInvalidate,\n              href: updatedBundleHref,\n            });\n          }\n\n          await Promise.race([\n            Event.toPromise(hmrClientRef.current.onReload),\n            timeout(5000).then(() => {\n              throw new TimeoutError(`HMR refresh timed out`);\n            }),\n          ]);\n        } else {\n          let bundledCode: string;\n\n          if (build instanceof Error) {\n            bundledCode = `ReactErrorOverlay.reportBuildError(${JSON.stringify(build.message)});\\n`;\n          } else {\n            bundledCode = `__velcroRuntime = ${build.toString({ executeEntrypoints: true, sourceMap: true })}`;\n          }\n\n          const runtimeFile = new File([runtimeBundleString.current], 'playground:///runtime.js', {\n            type: 'text/javascript',\n          });\n          const bundleFile = new File([bundledCode], 'playground:///index.js', {\n            type: 'text/javascript',\n          });\n          const markup = new File(\n            [\n              `\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n<title>Document</title>\n<script src=\"${URL.createObjectURL(runtimeFile)}\"></script>\n</head>\n<body>\n<div id=\"root\"></div>\n<script src=\"${URL.createObjectURL(bundleFile)}\"></script>\n</body>\n</html>`,\n            ],\n            Monaco.Uri.file('/index.html').toString(true),\n            {\n              type: 'text/html',\n            }\n          );\n          const htmlUrl = URL.createObjectURL(markup);\n          const iframe = document.createElement('iframe');\n          iframe.style.display = 'none';\n          iframe.src = htmlUrl;\n\n          if (previewWrapRef.current) {\n            previewWrapRef.current.appendChild(iframe);\n          }\n\n          try {\n            await new Promise((resolve, reject) => {\n              iframe.onload = () => resolve();\n              iframe.onerror = reject;\n            });\n\n            if (previewIframeRef.current) {\n              previewIframeRef.current.remove();\n            }\n\n            iframe.style.display = '';\n\n            previewIframeRef.current = iframe;\n          } catch (err) {\n            iframe.remove();\n\n            throw err;\n          }\n        }\n      } catch (err) {\n        tokenSource.cancel();\n\n        if (!(err instanceof CanceledError) && (err && err.name !== 'CanceledError')) {\n          setMessages(messages => [...messages, { lines: [{ isInternal: false, text: err.message }] }]);\n        }\n      } finally {\n        if (tokenSource) {\n          tokenSource.dispose();\n        }\n\n        building = false;\n\n        setBuildProgress({ completed: 0, total: 0 });\n      }\n    };\n\n    disposable.add(delayer);\n\n    for (const model of Monaco.editor.getModels()) {\n      disposable.add(\n        model.onDidChangeContent(() => {\n          queueRefreshPreview([model.uri.toString(true)]);\n        })\n      );\n    }\n\n    disposable.add(\n      Monaco.editor.onDidCreateModel(model => {\n        queueRefreshPreview([model.uri.toString(true)]);\n\n        disposable.add(\n          model.onDidChangeContent(() => {\n            queueRefreshPreview([model.uri.toString(true)]);\n          })\n        );\n      })\n    );\n\n    disposable.add(\n      Monaco.editor.onWillDisposeModel(model => {\n        queueRefreshPreview([model.uri.toString(true)]);\n      })\n    );\n\n    disposable.add(\n      (() => {\n        const onMessage = async (e: MessageEvent) => {\n          if (\n            (previewIframeRef.current && e.source !== previewIframeRef.current.contentWindow) ||\n            !e.data ||\n            typeof e.data.type !== 'string' ||\n            !e.data.payload\n          ) {\n            return;\n          }\n\n          switch (e.data.type) {\n            case 'error_open': {\n              if (!editorManager.editor) {\n                return;\n              }\n\n              const model = editorManager.getModelByHref(e.data.payload.fileName);\n\n              if (model) {\n                let lineNumber: number | undefined = e.data.payload.lineNumber;\n                let columnNumber: number | undefined = undefined;\n\n                if (lineNumber !== undefined) {\n                  const row = model.getLineContent(lineNumber);\n                  const matches = row.match(/^(\\s*)/);\n\n                  columnNumber = matches ? matches[1].length + 1 : undefined;\n                }\n\n                editorManager.focusModel(model, {\n                  lineNumber,\n                  columnNumber,\n                });\n              }\n\n              break;\n            }\n            case 'hmr_ready': {\n              if (!(e.data.payload instanceof MessagePort)) {\n                console.warn(\n                  'Received \"hmr_ready\" message from preview but did not receive the expected MessagePort payload',\n                  e.data\n                );\n                return;\n              }\n\n              hmrClientRef.current = new HmrClient(e.data.payload);\n              break;\n            }\n            default: {\n              console.debug({ message: e.data }, 'Unknown message received from preview iframe');\n            }\n          }\n        };\n\n        window.addEventListener('message', onMessage);\n        return {\n          dispose() {\n            window.removeEventListener('message', onMessage);\n          },\n        };\n      })()\n    );\n\n    disposable.add({\n      dispose() {\n        if (hmrClientRef.current) {\n          hmrClientRef.current.dispose();\n        }\n      },\n    });\n\n    queueRefreshPreview([]);\n\n    return () => disposable.dispose();\n  }, [editorManager.bundler, editorManager, invalidations]);\n\n  return (\n    <PreviewWrap className={props.className}>\n      <PreviewProgress completed={buildProgress.completed} total={buildProgress.total}></PreviewProgress>\n      {previewIframeRef.current ? null : 'Building the preview...'}\n      <PreviewIframeWrap ref={previewWrapRef}></PreviewIframeWrap>\n      <PreviewMessages>\n        {messages.map((message, idx) => (\n          <PreviewMessage key={idx} message={message}></PreviewMessage>\n        ))}\n      </PreviewMessages>\n    </PreviewWrap>\n  );\n};\n\nexport default styled(Preview)``;\n\ndeclare var velcroRequire: NodeRequire;\ndeclare var __velcroRuntime: Runtime;\n\n/**\n * Important: This function needs to be fully self-contained because it will be stringified.\n * @param filename\n */\nfunction createBundleRuntime() {\n  const ReactErrorOverlay = velcroRequire('react-error-overlay') as typeof import('react-error-overlay');\n  const channel = new MessageChannel();\n\n  //@ts-ignore\n  window.ReactErrorOverlay = ReactErrorOverlay;\n\n  ReactErrorOverlay.setEditorHandler(err => {\n    window.parent.postMessage({ type: 'error_open', payload: err }, '*');\n  });\n  ReactErrorOverlay.startReportingRuntimeErrors({\n    onError: () => undefined,\n  });\n\n  channel.port2.onmessage = function(e) {\n    if (!e.data || typeof e.data !== 'object') {\n      throw new Error(`Unexpected message received by HMR server`);\n    }\n\n    switch (e.data.type) {\n      case 'build_error': {\n        ReactErrorOverlay.dismissRuntimeErrors();\n        ReactErrorOverlay.reportBuildError(e.data.stack || e.data.message);\n\n        channel.port2.postMessage({\n          type: 'reload',\n        });\n        break;\n      }\n      case 'reload': {\n        if (isValidReload(e.data)) {\n          ReactErrorOverlay.dismissBuildError();\n          ReactErrorOverlay.dismissRuntimeErrors();\n          const reload = e.data;\n          const runtime = __velcroRuntime;\n          const queue = reload.invalidations.slice();\n          const seen = new Set<string>();\n          const requireReload = [] as string[];\n\n          while (queue.length) {\n            const href = queue.shift()!;\n\n            if (seen.has(href)) continue;\n            seen.add(href);\n\n            const module = runtime.get(href);\n\n            if (!module) {\n              continue;\n            }\n\n            runtime.remove(href);\n\n            for (const disposeCallback of module.disposeCallbacks) {\n              disposeCallback.cb && disposeCallback.cb();\n            }\n\n            if (module.acceptCallbacks.length) {\n              for (const acceptCallback of module.acceptCallbacks) {\n                acceptCallback.cb && acceptCallback.cb();\n              }\n            } else {\n              const isEntrypoint = module.dependents.indexOf(runtime.root) !== -1;\n\n              if (isEntrypoint) {\n                requireReload.push(module.id);\n              } else {\n                const dependents = module.dependents.filter(m => !seen.has(m.id)).map(m => m.id);\n                queue.push.apply(queue, dependents);\n              }\n            }\n          }\n\n          const script = document.createElement('script');\n          script.src = reload.href;\n          script.onerror = function(err) {\n            channel.port2.postMessage({\n              type: 'reload',\n              err,\n            });\n          };\n          script.onload = function() {\n            for (const toReload of requireReload) {\n              runtime.require(toReload);\n            }\n\n            channel.port2.postMessage({\n              type: 'reload',\n            });\n          };\n\n          document.head.appendChild(script);\n        }\n      }\n    }\n  };\n\n  window.parent.postMessage({ type: 'hmr_ready', payload: channel.port1 }, '*', [channel.port1]);\n\n  //#region Type Guards\n\n  function isObject(val: unknown): val is Record<string | number, unknown> {\n    return val && typeof val === 'object';\n  }\n\n  function isString(val: unknown): val is string {\n    return typeof val === 'string';\n  }\n\n  function isValidReload(message: unknown): message is HmrReloadRequest {\n    if (!isObject(message)) return false;\n\n    if (message.type !== 'reload') return false;\n\n    if (!Array.isArray(message.invalidations) || message.invalidations.find(entry => typeof entry !== 'string')) {\n      return false;\n    }\n\n    return isString(message.href);\n  }\n  //#endregion\n}\n\ninterface HmrBuildErrorRequest {\n  type: 'build_error';\n  message?: string;\n  stack?: string;\n}\ninterface HmrReloadRequest {\n  type: 'reload';\n  href: string;\n  invalidations: string[];\n}\n\ninterface HmrReloadResponse {}\n\nclass HmrClient implements IDisposable {\n  private readonly onReloadEmitter = new Emitter<HmrReloadResponse>();\n\n  constructor(private readonly port: MessagePort) {\n    port.onmessage = e => {\n      if (!e.data || typeof e.data !== 'object') {\n        throw new InvariantViolation('Unexpected message received from HMR client');\n      }\n\n      switch (e.data.type) {\n        case 'reload': {\n          this.onReloadEmitter.fire(e.data);\n          break;\n        }\n        default: {\n          throw new InvariantViolation(`Unexpected message with type '${e.data.type}' received from HMR client`);\n        }\n      }\n    };\n  }\n\n  get onReload() {\n    return this.onReloadEmitter.event;\n  }\n\n  dispose() {\n    this.port.close();\n  }\n\n  send(message: HmrBuildErrorRequest | HmrReloadRequest) {\n    this.port.postMessage(message);\n  }\n}\n","import * as Monaco from 'monaco-editor';\nimport { useEffect, useState } from 'react';\nimport { DisposableStore } from 'ts-primitives';\n\n// import { EditorContext } from './context';\n\nexport enum EntryKind {\n  Directory = 'directory',\n  File = 'file',\n}\n\nexport interface IDirectory {\n  type: EntryKind.Directory;\n  uri: Monaco.Uri;\n}\nexport interface IFile {\n  type: EntryKind.File;\n  uri: Monaco.Uri;\n  model: Monaco.editor.ITextModel;\n}\n\nexport type DirectoryEntry = IDirectory | IFile;\n\nexport function useDirectory(uri: Monaco.Uri) {\n  // Make sure the URI always ends with a trailing slash\n  const prefix = uri.toString(true).replace(/\\/?$/, '/');\n  const sortEntries = (models: (DirectoryEntry)[]) => {\n    return [...models].sort((a, b) => (a.uri.fsPath > b.uri.fsPath ? 1 : -1));\n  };\n\n  const initialEntries = sortEntries(\n    Monaco.editor.getModels().reduce(\n      (entries, model) => {\n        const modelUri = model.uri.toString(true);\n\n        if (modelUri.startsWith(prefix)) {\n          const nestedPath = modelUri.slice(prefix.length);\n          const nextDirIdx = nestedPath.indexOf('/');\n\n          if (nextDirIdx === 0) {\n            throw new Error('Invariant error: WAT?');\n          }\n\n          if (nextDirIdx > 0) {\n            // This is an intermediate directory\n            const uri = Monaco.Uri.parse(`${prefix}${nestedPath.slice(0, nextDirIdx + 1)}`);\n\n            entries.push({\n              type: EntryKind.Directory,\n              uri,\n            });\n          } else {\n            entries.push({\n              type: EntryKind.File,\n              uri: model.uri,\n              model,\n            });\n          }\n        }\n\n        return entries;\n      },\n      [] as DirectoryEntry[]\n    )\n  );\n  const [entries, setEntries] = useState(initialEntries);\n\n  useEffect(() => {\n    const disposable = new DisposableStore();\n    const prefix = uri.toString(true).replace(/\\/?$/, '/');\n\n    disposable.add(\n      Monaco.editor.onDidCreateModel((model: Monaco.editor.ITextModel) => {\n        const modelUri = model.uri.toString(true);\n\n        if (modelUri.startsWith(prefix)) {\n          const nestedPath = modelUri.slice(prefix.length);\n          const nextDirIdx = nestedPath.indexOf('/');\n\n          if (nextDirIdx === 0) {\n            throw new Error('Invariant error: WAT?');\n          }\n\n          if (nextDirIdx > 0) {\n            // This is an intermediate directory\n            const uri = Monaco.Uri.parse(`${prefix}${nestedPath.slice(0, nextDirIdx)}`);\n\n            // It is possible that we already have this directory\n            const entry = entries.find(entry => entry.uri.toString(true) === uri.toString(true));\n\n            if (entry) {\n              if (entry.type !== EntryKind.Directory) {\n                throw new Error(\n                  `Invariant violation: A file in '${prefix}' conflicts with the path of the new file '${modelUri}'`\n                );\n              }\n\n              return;\n            }\n\n            entries.push({ type: EntryKind.Directory, uri });\n\n            return setEntries(sortEntries(entries));\n          }\n\n          if (\n            !entries.find(\n              entry => entry.type === EntryKind.File && entry.uri.toString(true) === model.uri.toString(true)\n            )\n          ) {\n            entries.push({ type: EntryKind.File, uri: model.uri, model });\n\n            setEntries(sortEntries(entries));\n          }\n        }\n      })\n    );\n\n    disposable.add(\n      Monaco.editor.onWillDisposeModel(model => {\n        const idx = entries.findIndex(entry => entry.type === EntryKind.File && entry.model === model);\n\n        if (idx === -1) {\n          throw new Error(`Invariant violation: Removing an untracked model: '${model.uri.fsPath}'`);\n        }\n\n        entries.splice(idx, 1);\n\n        setEntries(sortEntries(entries));\n      })\n    );\n\n    return () => disposable.dispose();\n  }, [entries, uri]);\n\n  return entries;\n}\n","import styled from '@emotion/styled/macro';\nimport * as Monaco from 'monaco-editor';\nimport React, { useContext, useRef } from 'react';\nimport { Button } from 'reakit/Button';\nimport { Tooltip, TooltipReference, useTooltipState } from 'reakit/Tooltip';\nimport { useDirectory, EntryKind } from '../lib/hooks';\nimport { useActiveModel, EditorManagerContext } from '../lib/EditorManager';\n\nconst Entry = styled.div<{ modelFocused: boolean }>`\n  background-color: ${props => (props.modelFocused ? '#008cba' : 'inherit')};\n  text-decoration: none;\n  color: ${props => (props.modelFocused ? '#fff' : '#262626')};\n\n  height: 25px;\n  padding: 0 0 0 8px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n\n  & > span {\n    flex: 1;\n  }\n\n  & > button {\n    display: none;\n  }\n\n  &:hover > button {\n    display: block;\n  }\n\n  ${props =>\n    props.modelFocused\n      ? {\n          ':hover': {\n            color: '#f5f5f5',\n            cursor: 'pointer',\n          },\n        }\n      : {\n          ':hover': {\n            backgroundColor: '#eee',\n            color: '#262626',\n            cursor: 'pointer',\n          },\n        }}\n`;\n\nconst CreateEntry = styled.div`\n  text-decoration: none;\n  color: '#262626';\n\n  height: 25px;\n  padding: 0 0 0 8px;\n  display: flex;\n  align-items: center;\n\n  :hover {\n    background-color: #eee;\n    cursor: pointer;\n  }\n`;\n\nconst SidebarFileDelete = styled(Button)`\n  border: none;\n  background: none;\n\n  :hover {\n    cursor: pointer;\n  }\n`;\n\nconst StyledTooltip = styled.div`\n  font-family: Open Sans, Helvetica Neue, Helvetica, Arial, sans-serif;\n  font-size: 14px;\n  line-height: 1.4;\n  background-color: #333;\n  color: #fff;\n  border-radius: 4px;\n  opacity: 0.9;\n  padding: 0.2em 0.4em;\n`;\n\nconst SidebarFile: React.FC<{ className?: string; model: Monaco.editor.ITextModel }> = ({ className, model }) => {\n  const activeModel = useActiveModel();\n  const editorManager = useContext(EditorManagerContext);\n  const tooltip = useTooltipState({ gutter: 0 });\n\n  const onClickDelete = () => {\n    model.dispose();\n  };\n\n  return (\n    <Entry className={className} modelFocused={model === activeModel}>\n      <span onClick={() => editorManager.focusModel(model)}>{model.uri.fsPath.slice(1)}</span>\n      <TooltipReference {...tooltip} as={SidebarFileDelete} onClick={() => onClickDelete()}>\n        <span role=\"img\" aria-label=\"Delete file\">\n          ❌\n        </span>\n      </TooltipReference>\n      <Tooltip {...tooltip} as={StyledTooltip}>\n        Delete file\n      </Tooltip>\n    </Entry>\n  );\n};\n\nconst Sidebar: React.FC<{ className?: string }> = props => {\n  const rootDir = useRef(Monaco.Uri.file('/'));\n  const entries = useDirectory(rootDir.current);\n  const editorManager = useContext(EditorManagerContext);\n\n  const onClickCreate = () => {\n    const filename = prompt('Filename?');\n\n    if (filename) {\n      editorManager.createModel(filename);\n    }\n  };\n\n  return (\n    <div className={props.className}>\n      {entries.map(entry =>\n        entry.type === EntryKind.Directory ? (\n          <div>{entry.uri.fsPath.slice(1)}</div>\n        ) : (\n          <SidebarFile key={entry.uri.toString(true)} model={entry.model}></SidebarFile>\n        )\n      )}\n      <CreateEntry onClick={() => onClickCreate()}>Create...</CreateEntry>\n    </div>\n  );\n};\n\nexport default styled(Sidebar)`\n  display: flex;\n  flex-direction: column;\n`;\n","import styled from '@emotion/styled/macro';\nimport React from 'react';\n\nimport Editor from './Editor';\nimport Preview from './Preview';\nimport Sidebar from './Sidebar';\nimport { EditorManager, EditorManagerContext } from '../lib/EditorManager';\n\nconst App: React.FC<{ className?: string; initialPath: string; project: Record<string, string> }> = ({\n  className,\n  initialPath,\n  project,\n}) => {\n  const editorManager = new EditorManager({ files: project, initialPath: initialPath });\n\n  return (\n    <div className={className}>\n      <EditorManagerContext.Provider value={editorManager}>\n        <Sidebar></Sidebar>\n        <Editor></Editor>\n        <Preview></Preview>\n      </EditorManagerContext.Provider>\n    </div>\n  );\n};\n\nexport default styled(App)`\n  display: flex;\n  flex-direction: row;\n\n  font-family: Open Sans, Helvetica Neue, Helvetica, Arial, sans-serif;\n  font-size: 14px;\n  line-height: 1.4;\n  color: #222;\n\n  ${Sidebar} {\n    flex: 1 1 200px;\n    min-width: 150px;\n    max-width: 400px;\n    border-right: 1px solid #ccc;\n  }\n\n  ${Editor} {\n    border-right: 1px solid #ccc;\n  }\n\n  ${Editor}, ${Preview} {\n    flex: 10;\n  }\n`;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (response.status === 404 || (contentType != null && contentType.indexOf('javascript') === -1)) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import styled from '@emotion/styled';\nimport React, { useState, useEffect } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Button } from 'reakit/Button';\nimport { useDialogState, Dialog } from 'reakit/Dialog';\nimport { Portal } from 'reakit/Portal';\n// import 'modern-css-reset';\n\nimport App from './components/App';\nimport * as serviceWorker from './serviceWorker';\n\nconst project = {\n  'package.json':\n    JSON.stringify(\n      {\n        dependencies: {\n          '@emotion/core': '^10.0.17',\n          '@emotion/styled': '^10.0.17',\n          'github-markdown-css': '^3.0.1',\n          react: '^16.9.0',\n          'react-dom': '^16.9.0',\n        },\n      },\n      null,\n      2\n    ) + '\\n',\n  'explanation.jsx':\n    `\nimport React from 'react';\n\nexport const Explanation = () => <>\n  <section>\n    <h2>What is this?</h2>\n    <p>\n      This is a demo of bundling and serving a browser-based sandbox fully from the browser. <strong>There are <em>no</em> servers involved</strong> except the static server hosting this demo and <a href=\"https://unpkg.com\" target=\"_blank\" rel=\"noopener\">unpkg.com</a>. All module resolution, transpilation and bundling is happening in the browser.\n    </p>\n    <p>\n      Try it. Go offline, and reload...\n    </p>\n    <p>\n      <strong>I dare you.</strong>\n    </p>\n  </section>\n  <section>\n    <h2>Features</h2>\n    <ul>\n      <li>Full offline support. Once your cache is seeded, you can cut the cord.</li>\n      <li>Fully browser-based bundling.</li>\n      <li>Add (almost) any node module and no server is involved.</li>\n      <li>If you want to add another module, make sure to add it to <code>package.json</code> first.</li>\n      <li>Automatic type acquisition for full typings support in the browser, in JavaScript!</li>\n      <li>Resolve source locations in stack traces</li>\n      <li>Hot module reloading</li>\n    </ul>\n  </section>\n</>;\n    `.trim() + '\\n',\n  'index.jsx':\n    `\nimport React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport 'github-markdown-css';\nimport './style.css';\n\nimport { Explanation } from './explanation';\nimport { name } from './name';\n\nclass Hello extends Component {\n  render() {\n    return <div className=\"markdown-body\">\n      <h1>Hello {this.props.toWhat}</h1>\n      <blockquote>There is no <del>spoon</del> server</blockquote>\n      <Explanation/>\n    </div>;\n  }\n}\n  \nReactDOM.render(\n  <Hello toWhat={ name } />,\n  document.getElementById('root')\n);\n      `.trim() + '\\n',\n  'name.js':\n    `\nexport const name = 'Velcro';\n    `.trim() + '\\n',\n  'style.css':\n    `\n.markdown-body {\n  box-sizing: border-box;\n  min-width: 200px;\n  max-width: 980px;\n  margin: 0 auto;\n  padding: 45px;\n}\n\n@media (max-width: 767px) {\n  .markdown-body {\n    padding: 15px;\n  }\n}\n    `.trim() + '\\n',\n};\n\nconst AppWrap = styled.div`\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n\n  background: #333;\n\n  ${App} {\n    flex: 0 0 80vh;\n    width: 80vw;\n    background: white;\n    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(0, 0, 0, 0.23);\n    max-height: 90vh;\n  }\n`;\n\nconst Notifications = styled.div`\n  font-family: Open Sans, Helvetica Neue, Helvetica, Arial, sans-serif;\n  font-size: 14px;\n  line-height: 1.4;\n  color: #222;\n\n  display: flex;\n  flex-direction: column;\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  padding: 8px;\n\n  & > * {\n    box-shadow: 0 19px 38px rgba(0, 0, 0, 0.3), 0 15px 12px rgba(0, 0, 0, 0.22);\n    max-width: 200px;\n    margin: 8px;\n  }\n`;\n\nconst AlertDialog = styled(Dialog)`\n  background-color: white;\n  padding: 0.5em 1em;\n  border-radius: 4px;\n\n  & > p {\n    margin: 0;\n  }\n`;\n\nconst OnlineNotification: React.FC<{ notification: ServiceWorkerOnine; onDismiss: () => void }> = ({ onDismiss }) => {\n  const dialog = useDialogState({ visible: true });\n\n  return (\n    <AlertDialog\n      {...dialog}\n      hideOnClickOutside={false}\n      hideOnEsc={false}\n      modal={false}\n      role=\"alertdialog\"\n      aria-label=\"This application is ready for offline usage\"\n    >\n      <p>This application is ready for offline usage</p>\n      <Button onClick={onDismiss}>Hide</Button>\n    </AlertDialog>\n  );\n};\n\nconst UpdatedNotification: React.FC<{ notification: ServiceWorkerUpdated; onDismiss: () => void }> = ({\n  notification,\n  onDismiss,\n}) => {\n  const dialog = useDialogState({ visible: true });\n\n  const onClickUpdate = () => {\n    const waitingServiceWorker = notification.registration.waiting;\n\n    interface ServiceWorkerEvent extends Event {\n      target: Partial<ServiceWorker> & EventTarget | null;\n    }\n\n    if (waitingServiceWorker) {\n      waitingServiceWorker.addEventListener('statechange', (event: ServiceWorkerEvent) => {\n        if (event.target && event.target.state === 'activated') {\n          window.location.reload();\n        }\n      });\n      waitingServiceWorker.postMessage({ type: 'SKIP_WAITING' });\n    }\n  };\n\n  return (\n    <AlertDialog {...dialog} modal={false} role=\"alertdialog\" aria-label=\"A new version of this application is ready\">\n      <p>A new version of this application is ready</p>\n      <Button onClick={onDismiss}>Cancel</Button>\n      <Button onClick={onClickUpdate}>Update</Button>\n    </AlertDialog>\n  );\n};\n\ninterface ServiceWorkerOnine {\n  type: 'online';\n  registration: ServiceWorkerRegistration;\n}\n\ninterface ServiceWorkerUpdated {\n  type: 'updated';\n  registration: ServiceWorkerRegistration;\n}\n\ntype ServiceWorkerNotification = ServiceWorkerOnine | ServiceWorkerUpdated;\n\nconst ServiceWorkerLifecycle: React.FC = props => {\n  const [notifications, setNotifications] = useState([] as ServiceWorkerNotification[]);\n\n  useEffect(() => {\n    serviceWorker.register({\n      onSuccess(registration) {\n        const newNotifications = notifications.filter(n => n.type !== 'online');\n\n        newNotifications.push({ type: 'online', registration });\n        setNotifications(newNotifications);\n      },\n      onUpdate(registration) {\n        const newNotifications = notifications.filter(n => n.type !== 'updated');\n\n        newNotifications.push({ type: 'updated', registration });\n        setNotifications(newNotifications);\n      },\n    });\n  });\n\n  const removeNotification = (notification: ServiceWorkerNotification) => {\n    const idx = notifications.indexOf(notification);\n\n    if (idx !== -1) {\n      const newNotifications = notifications.slice();\n\n      newNotifications.splice(idx, 1);\n\n      setNotifications(newNotifications);\n    }\n  };\n\n  return (\n    <>\n      <Portal>\n        <Notifications>\n          {notifications.map((notification, i) => {\n            switch (notification.type) {\n              case 'online':\n                return (\n                  <OnlineNotification\n                    key={i}\n                    notification={notification}\n                    onDismiss={() => removeNotification(notification)}\n                  ></OnlineNotification>\n                );\n              case 'updated':\n                return (\n                  <UpdatedNotification\n                    key={i}\n                    notification={notification}\n                    onDismiss={() => removeNotification(notification)}\n                  ></UpdatedNotification>\n                );\n            }\n\n            return undefined;\n          })}\n        </Notifications>\n      </Portal>\n      {props.children}\n    </>\n  );\n};\n\nReactDOM.render(\n  <ServiceWorkerLifecycle>\n    <AppWrap>\n      <App initialPath=\"index.jsx\" project={project} />\n    </AppWrap>\n  </ServiceWorkerLifecycle>,\n  document.getElementById('root')\n);\n","import _defineProperty from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _slicedToArray from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _asyncToGenerator from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _possibleConstructorReturn from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _wrapNativeSuper from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper\";\nimport _classCallCheck from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ggoodman/Projects/velcro/packages/playground/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { CancellationTokenSource, CanceledError } from 'ts-primitives';\nexport { CanceledError, CancellationToken, CancellationTokenSource } from 'ts-primitives';\nvar ResolvedEntryKind;\n\n(function (ResolvedEntryKind) {\n  ResolvedEntryKind[\"Directory\"] = \"directory\";\n  ResolvedEntryKind[\"File\"] = \"file\";\n})(ResolvedEntryKind || (ResolvedEntryKind = {}));\n\nfunction isValidPackageJson(json) {\n  return typeof json === 'object' && json !== null && !hasInvalidOptionalStringField(json, 'name') && !hasInvalidOptionalStringField(json, 'version') && !hasInvalidBrowserField(json) && !hasInvalidOptionalStringField(json, 'main') && !hasInvalidOptionalStringField(json, 'module') && !hasInvalidOptionalStringField(json, 'jsnext:main') && !hasInvalidOptionalStringField(json, 'unpkg') && !hasInvalidDependenciesField(json, 'dependencies') && !hasInvalidDependenciesField(json, 'devDependencies') && !hasInvalidDependenciesField(json, 'peerDependencies');\n}\n\nfunction hasInvalidBrowserField(json) {\n  var error = '';\n  var browser = json.browser;\n\n  if (browser) {\n    if (typeof browser === 'object') {\n      for (var key in browser) {\n        if (typeof key !== 'string') {\n          error = \"The key \".concat(key, \" of .browser must be a string\");\n          break;\n        }\n\n        if (typeof browser[key] !== 'string' && browser[key] !== false) {\n          error = \"The value \".concat(key, \" of .browser must be a string or false\");\n          break;\n        }\n      }\n    }\n  }\n\n  return error;\n}\n\nfunction hasInvalidOptionalStringField(json, field) {\n  return json[field] !== undefined && typeof json[field] !== 'string';\n}\n\nfunction hasInvalidDependenciesField(json, field) {\n  return json[field] !== undefined && typeof json[field] === 'object' && json[field] !== null && !Object.keys(json[field]).every(function (key) {\n    return typeof key === 'string' && typeof json[field][key] === 'string';\n  });\n}\n\nvar CHAR_DOT = 46;\n/* . */\n\nvar CHAR_FORWARD_SLASH = 47;\n/* / */\n\nvar TRAILING_SLASH_RX = /\\/?$/;\n\nfunction ensureTrailingSlash(pathname) {\n  return pathname.replace(TRAILING_SLASH_RX, '/');\n}\n\nfunction parseBufferAsPackageJson(decoder, content, spec) {\n  try {\n    var text = decoder.decode(content);\n    return parseTextAsPackageJson(text, spec);\n  } catch (err) {\n    throw new Error(\"Error decoding manifest buffer for package \".concat(spec, \": \").concat(err.message));\n  }\n}\n\nfunction parseTextAsPackageJson(text, spec) {\n  var json;\n\n  try {\n    json = JSON.parse(text);\n  } catch (err) {\n    throw new Error(\"Error parsing manifest as json for package \".concat(spec, \": \").concat(err.message));\n  }\n\n  if (!isValidPackageJson(json)) {\n    throw new Error(\"Invalid manifest for the package \".concat(spec));\n  }\n\n  return json;\n}\n\nfunction getFirstPathSegmentAfterPrefix(child, parent) {\n  var childHref = child.pathname;\n  var parentHref = parent.pathname;\n  var parentOffset = parentHref.charAt(parentHref.length - 1) === '/' ? -1 : 0;\n\n  for (var i = 0; i <= childHref.length; i++) {\n    if (i < parentHref.length) {\n      if (childHref.charAt(i) !== parentHref.charAt(i)) {\n        throw new Error(\"The child entry \".concat(child.href, \" does not have the pathname of \").concat(parent.href, \" as a prefix\"));\n      }\n    } else if (i === parentHref.length + parentOffset) {\n      if (childHref.charAt(i) !== '/') {\n        throw new Error(\"The child entry \".concat(child.href, \" does not have the pathname of \").concat(parent.href, \" as a prefix\"));\n      }\n    } else if (childHref.charAt(i) === '/') {\n      return childHref.slice(parentHref.length + 1 + parentOffset, i);\n    }\n  }\n\n  return childHref.slice(parentHref.length + 1 + parentOffset);\n}\n\nfunction validateString(value, name) {\n  if (typeof value !== 'string') {\n    throw new TypeError(\"The '\".concat(name, \"' argument must be of type string but got \").concat(typeof value));\n  }\n}\n\nfunction basename(path, ext) {\n  if (ext !== undefined) {\n    validateString(ext, 'ext');\n  }\n\n  validateString(path, 'path');\n  var start = 0;\n  var end = -1;\n  var matchedSlash = true;\n  var i;\n\n  if (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\n    if (ext.length === path.length && ext === path) {\n      return '';\n    }\n\n    var extIdx = ext.length - 1;\n    var firstNonSlashEnd = -1;\n\n    for (i = path.length - 1; i >= start; --i) {\n      var code = path.charCodeAt(i);\n\n      if (isPathSeparator(code)) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          start = i + 1;\n          break;\n        }\n      } else {\n        if (firstNonSlashEnd === -1) {\n          // We saw the first non-path separator, remember this index in case\n          // we need it if the extension ends up not matching\n          matchedSlash = false;\n          firstNonSlashEnd = i + 1;\n        }\n\n        if (extIdx >= 0) {\n          // Try to match the explicit extension\n          if (code === ext.charCodeAt(extIdx)) {\n            if (--extIdx === -1) {\n              // We matched the extension, so mark this as the end of our path\n              // component\n              end = i;\n            }\n          } else {\n            // Extension does not match, so our result is the entire path\n            // component\n            extIdx = -1;\n            end = firstNonSlashEnd;\n          }\n        }\n      }\n    }\n\n    if (start === end) {\n      end = firstNonSlashEnd;\n    } else if (end === -1) {\n      end = path.length;\n    }\n\n    return path.slice(start, end);\n  } else {\n    for (i = path.length - 1; i >= start; --i) {\n      if (isPathSeparator(path.charCodeAt(i))) {\n        // If we reached a path separator that was not part of a set of path\n        // separators at the end of the string, stop now\n        if (!matchedSlash) {\n          start = i + 1;\n          break;\n        }\n      } else if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // path component\n        matchedSlash = false;\n        end = i + 1;\n      }\n    }\n\n    if (end === -1) {\n      return '';\n    }\n\n    return path.slice(start, end);\n  }\n}\n\nfunction extname(path) {\n  validateString(path, 'path');\n  var start = 0;\n  var startDot = -1;\n  var startPart = 0;\n  var end = -1;\n  var matchedSlash = true; // Track the state of characters (if any) we see before our first dot and\n  // after any path separator we find\n\n  var preDotState = 0;\n\n  for (var i = path.length - 1; i >= start; --i) {\n    var code = path.charCodeAt(i);\n\n    if (isPathSeparator(code)) {\n      // If we reached a path separator that was not part of a set of path\n      // separators at the end of the string, stop now\n      if (!matchedSlash) {\n        startPart = i + 1;\n        break;\n      }\n\n      continue;\n    }\n\n    if (end === -1) {\n      // We saw the first non-path separator, mark this as the end of our\n      // extension\n      matchedSlash = false;\n      end = i + 1;\n    }\n\n    if (code === CHAR_DOT) {\n      // If this is our first dot, mark it as the start of our extension\n      if (startDot === -1) {\n        startDot = i;\n      } else if (preDotState !== 1) {\n        preDotState = 1;\n      }\n    } else if (startDot !== -1) {\n      // We saw a non-dot and non-path separator before our dot, so we should\n      // have a good chance at having a non-empty extension\n      preDotState = -1;\n    }\n  }\n\n  if (startDot === -1 || end === -1 || // We saw a non-dot character immediately before the dot\n  preDotState === 0 || // The (right-most) trimmed path component is exactly '..'\n  preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n    return '';\n  }\n\n  return path.slice(startDot, end);\n}\n\nfunction dirname(path) {\n  validateString(path, 'path');\n  var len = path.length;\n\n  if (len === 0) {\n    return '.';\n  }\n\n  var rootEnd = -1;\n  var end = -1;\n  var matchedSlash = true;\n  var offset = 0;\n  var code = path.charCodeAt(0); // Try to match a root\n\n  if (len > 1) {\n    if (isPathSeparator(code)) {\n      // Possible UNC root\n      rootEnd = offset = 1;\n\n      if (isPathSeparator(path.charCodeAt(1))) {\n        // Matched double path separator at beginning\n        var j = 2;\n        var last = j; // Match 1 or more non-path separators\n\n        for (; j < len; ++j) {\n          if (isPathSeparator(path.charCodeAt(j))) {\n            break;\n          }\n        }\n\n        if (j < len && j !== last) {\n          // Matched!\n          last = j; // Match 1 or more path separators\n\n          for (; j < len; ++j) {\n            if (!isPathSeparator(path.charCodeAt(j))) {\n              break;\n            }\n          }\n\n          if (j < len && j !== last) {\n            // Matched!\n            last = j; // Match 1 or more non-path separators\n\n            for (; j < len; ++j) {\n              if (isPathSeparator(path.charCodeAt(j))) {\n                break;\n              }\n            }\n\n            if (j === len) {\n              // We matched a UNC root only\n              return path;\n            }\n\n            if (j !== last) {\n              // We matched a UNC root with leftovers\n              // Offset by 1 to include the separator after the UNC root to\n              // treat it as a \"normal root\" on top of a (UNC) root\n              rootEnd = offset = j + 1;\n            }\n          }\n        }\n      }\n    }\n  } else if (isPathSeparator(code)) {\n    // `path` contains just a path separator, exit early to avoid\n    // unnecessary work\n    return path;\n  }\n\n  for (var i = len - 1; i >= offset; --i) {\n    if (isPathSeparator(path.charCodeAt(i))) {\n      if (!matchedSlash) {\n        end = i;\n        break;\n      }\n    } else {\n      // We saw the first non-path separator\n      matchedSlash = false;\n    }\n  }\n\n  if (end === -1) {\n    if (rootEnd === -1) {\n      return '.';\n    } else {\n      end = rootEnd;\n    }\n  }\n\n  return path.slice(0, end);\n}\n\nfunction join(initialSegment) {\n  var pathname = initialSegment;\n\n  for (var i = 0; i < (arguments.length <= 1 ? 0 : arguments.length - 1); i++) {\n    var segment = i + 1 < 1 || arguments.length <= i + 1 ? undefined : arguments[i + 1];\n\n    if (segment.startsWith('/')) {\n      segment = segment.slice(1);\n    }\n\n    if (pathname.endsWith('/')) {\n      pathname += segment;\n    } else {\n      pathname += \"/\".concat(segment);\n    }\n  }\n\n  return pathname;\n}\n\nfunction resolve() {\n  var resolvedPath = '';\n  var resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = void 0;\n\n    if (i >= 0) {\n      path = i < 0 || arguments.length <= i ? undefined : arguments[i];\n    } else {\n      break;\n    }\n\n    validateString(path, 'path'); // Skip empty entries\n\n    if (path.length === 0) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charCodeAt(0) === CHAR_FORWARD_SLASH;\n  } // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n  // Normalize the path\n\n\n  resolvedPath = normalizeString(resolvedPath, !resolvedAbsolute, '/', isPathSeparator);\n\n  if (resolvedAbsolute) {\n    if (resolvedPath.length > 0) {\n      return '/' + resolvedPath;\n    } else {\n      return '/';\n    }\n  } else if (resolvedPath.length > 0) {\n    return resolvedPath;\n  } else {\n    return '.';\n  }\n}\n\nfunction isPathSeparator(code) {\n  return code === CHAR_FORWARD_SLASH;\n}\n\nfunction normalizeString(path, allowAboveRoot, separator, isPathSeparator) {\n  var res = '';\n  var lastSegmentLength = 0;\n  var lastSlash = -1;\n  var dots = 0;\n  var code = -1;\n\n  for (var i = 0; i <= path.length; ++i) {\n    if (i < path.length) {\n      code = path.charCodeAt(i);\n    } else if (isPathSeparator(code)) {\n      break;\n    } else {\n      code = CHAR_FORWARD_SLASH;\n    }\n\n    if (isPathSeparator(code)) {\n      if (lastSlash === i - 1 || dots === 1) ;else if (lastSlash !== i - 1 && dots === 2) {\n        if (res.length < 2 || lastSegmentLength !== 2 || res.charCodeAt(res.length - 1) !== CHAR_DOT || res.charCodeAt(res.length - 2) !== CHAR_DOT) {\n          if (res.length > 2) {\n            var lastSlashIndex = res.lastIndexOf(separator);\n\n            if (lastSlashIndex === -1) {\n              res = '';\n              lastSegmentLength = 0;\n            } else {\n              res = res.slice(0, lastSlashIndex);\n              lastSegmentLength = res.length - 1 - res.lastIndexOf(separator);\n            }\n\n            lastSlash = i;\n            dots = 0;\n            continue;\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSegmentLength = 0;\n            lastSlash = i;\n            dots = 0;\n            continue;\n          }\n        }\n\n        if (allowAboveRoot) {\n          if (res.length > 0) {\n            res += \"\".concat(separator, \"..\");\n          } else {\n            res = '..';\n          }\n\n          lastSegmentLength = 2;\n        }\n      } else {\n        if (res.length > 0) {\n          res += separator + path.slice(lastSlash + 1, i);\n        } else {\n          res = path.slice(lastSlash + 1, i);\n        }\n\n        lastSegmentLength = i - lastSlash - 1;\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === CHAR_DOT && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n\n  return res;\n}\n\nvar util =\n/*#__PURE__*/\nObject.freeze({\n  __proto__: null,\n  ensureTrailingSlash: ensureTrailingSlash,\n  parseBufferAsPackageJson: parseBufferAsPackageJson,\n  getFirstPathSegmentAfterPrefix: getFirstPathSegmentAfterPrefix,\n  basename: basename,\n  extname: extname,\n  dirname: dirname,\n  join: join,\n  resolve: resolve\n});\n\nvar Decoder =\n/*#__PURE__*/\nfunction () {\n  function Decoder() {\n    _classCallCheck(this, Decoder);\n\n    if (typeof TextDecoder !== 'undefined') {\n      this.decoder = new TextDecoder();\n    }\n  }\n\n  _createClass(Decoder, [{\n    key: \"decode\",\n    value: function decode(buf) {\n      var str = this.decoder ? this.decoder.decode(buf) : Buffer.from(buf).toString('utf-8');\n      return str.charCodeAt(0) === 0xfeff ? str.slice(1) : str;\n    }\n  }]);\n\n  return Decoder;\n}();\n\nvar ExtendableError =\n/*#__PURE__*/\nfunction (_Error) {\n  _inherits(ExtendableError, _Error);\n\n  function ExtendableError(message) {\n    var _this;\n\n    _classCallCheck(this, ExtendableError);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ExtendableError).call(this, message));\n    _this.name = _this.constructor.name;\n\n    if (typeof Error.captureStackTrace === 'function') {\n      Error.captureStackTrace(_assertThisInitialized(_this), _this.constructor);\n    } else {\n      _this.stack = new Error(message).stack;\n    }\n\n    return _this;\n  }\n\n  return ExtendableError;\n}(_wrapNativeSuper(Error));\n\nvar EntryNotFoundError =\n/*#__PURE__*/\nfunction (_ExtendableError) {\n  _inherits(EntryNotFoundError, _ExtendableError);\n\n  function EntryNotFoundError(url) {\n    var _this2;\n\n    _classCallCheck(this, EntryNotFoundError);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(EntryNotFoundError).call(this, \"Not found \".concat(url.href)));\n    _this2.url = url;\n    return _this2;\n  }\n\n  return EntryNotFoundError;\n}(ExtendableError);\n\nvar AbstractResolverHost =\n/*#__PURE__*/\nfunction () {\n  function AbstractResolverHost() {\n    _classCallCheck(this, AbstractResolverHost);\n  }\n\n  _createClass(AbstractResolverHost, [{\n    key: \"getCanonicalUrl\",\n    value: function getCanonicalUrl(_resolver, url) {\n      return Promise.resolve(url);\n    }\n  }]);\n\n  return AbstractResolverHost;\n}();\n\nvar TRAILING_SLASH_RX$1 = /\\/?$/;\n\nvar Resolver =\n/*#__PURE__*/\nfunction () {\n  function Resolver(host) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Resolver);\n\n    this.host = host;\n    this.decoder = new Decoder();\n    this.extensions = Array.from(options.extensions || Resolver.defaultExtensions);\n    this.packageMain = options.packageMain || ['main'];\n  }\n\n  _createClass(Resolver, [{\n    key: \"resolve\",\n    value: function () {\n      var _resolve = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(url) {\n        var options,\n            token,\n            tokenSource,\n            optionsWithDefaults,\n            canonicalUrlPromise,\n            _ref,\n            _ref2,\n            canonicalUrl,\n            rootUrl,\n            rootHref,\n            rootHrefWithoutTrailingSlash,\n            canonicalHref,\n            resolvedUrl,\n            _args = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                options = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};\n\n                if (url instanceof URL) {\n                  _context.next = 9;\n                  break;\n                }\n\n                _context.prev = 2;\n                url = new URL(url);\n                _context.next = 9;\n                break;\n\n              case 6:\n                _context.prev = 6;\n                _context.t0 = _context[\"catch\"](2);\n                throw new Error(\"Invalid URL: \".concat(url, \": \").concat(_context.t0.message));\n\n              case 9:\n                token = options.token;\n\n                if (!token) {\n                  tokenSource = new CancellationTokenSource();\n                  token = tokenSource.token;\n                }\n\n                optionsWithDefaults = {\n                  extensions: options.extensions || this.extensions,\n                  ignoreBrowserOverrides: typeof options.ignoreBrowserOverrides === 'undefined' ? false : options.ignoreBrowserOverrides,\n                  packageMain: options.packageMain || this.packageMain,\n                  token: token\n                };\n                canonicalUrlPromise = this.host.getCanonicalUrl(this, url, {\n                  token: token\n                }); // To figure out if the url should be resolved as a file or as a directory, we need to first canonicalize the url\n                // if the host supports this and resolve the root url for the given asset.\n\n                _context.next = 15;\n                return Promise.all([canonicalUrlPromise, this.host.getResolveRoot(this, url, {\n                  token: token\n                })]);\n\n              case 15:\n                _ref = _context.sent;\n                _ref2 = _slicedToArray(_ref, 2);\n                canonicalUrl = _ref2[0];\n                rootUrl = _ref2[1];\n\n                if (!token.isCancellationRequested) {\n                  _context.next = 21;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 21:\n                rootHref = rootUrl.href;\n                rootHrefWithoutTrailingSlash = rootHref.replace(TRAILING_SLASH_RX$1, '');\n                canonicalHref = canonicalUrl.href;\n\n                if (canonicalHref.startsWith(rootHrefWithoutTrailingSlash)) {\n                  _context.next = 26;\n                  break;\n                }\n\n                throw new Error(\"Unable to resolve a module whose path \".concat(canonicalHref, \" is above the host's root \").concat(rootHref));\n\n              case 26:\n                if (!(rootHrefWithoutTrailingSlash === canonicalHref || rootHref == canonicalHref)) {\n                  _context.next = 32;\n                  break;\n                }\n\n                _context.next = 29;\n                return this.resolveAsDirectory(canonicalUrl, optionsWithDefaults);\n\n              case 29:\n                _context.t1 = _context.sent;\n                _context.next = 35;\n                break;\n\n              case 32:\n                _context.next = 34;\n                return this.resolveAsFile(canonicalUrl, optionsWithDefaults);\n\n              case 34:\n                _context.t1 = _context.sent;\n\n              case 35:\n                resolvedUrl = _context.t1;\n\n                if (!token.isCancellationRequested) {\n                  _context.next = 38;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 38:\n                return _context.abrupt(\"return\", {\n                  ignored: resolvedUrl === false,\n                  resolvedUrl: resolvedUrl || undefined,\n                  rootUrl: rootUrl\n                });\n\n              case 39:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[2, 6]]);\n      }));\n\n      function resolve(_x) {\n        return _resolve.apply(this, arguments);\n      }\n\n      return resolve;\n    }()\n    /**\r\n     * Resolve a reference treating it as a directory\r\n     *\r\n     * 1. If there is a `package.json` file and this has a `main` entry, use that\r\n     * 2. Assume `index` if no main file is found in the `package.json` manifest\r\n     *\r\n     * The outcome of this process will then be resolved as if it were a file.\r\n     */\n\n  }, {\n    key: \"resolveAsDirectory\",\n    value: function () {\n      var _resolveAsDirectory = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(url, options) {\n        var _ref3, _ref4, rootUrl, entries, mainPathname, packageJsonEntry, packageJsonContent, packageJson, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, packageMain, pathname, mainUrl;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return Promise.all([this.host.getResolveRoot(this, url, {\n                  token: options.token\n                }), this.host.listEntries(this, url, {\n                  token: options.token\n                })]);\n\n              case 2:\n                _ref3 = _context2.sent;\n                _ref4 = _slicedToArray(_ref3, 2);\n                rootUrl = _ref4[0];\n                entries = _ref4[1];\n\n                if (!options.token.isCancellationRequested) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 8:\n                mainPathname = 'index'; // Step 1: Look for a package.json with an main field\n\n                packageJsonEntry = entries.find(function (entry) {\n                  return basename(entry.url.pathname) === 'package.json';\n                });\n\n                if (!packageJsonEntry) {\n                  _context2.next = 45;\n                  break;\n                }\n\n                _context2.next = 13;\n                return this.host.readFileContent(this, packageJsonEntry.url, {\n                  token: options.token\n                });\n\n              case 13:\n                packageJsonContent = _context2.sent;\n\n                if (!options.token.isCancellationRequested) {\n                  _context2.next = 16;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 16:\n                packageJson = parseBufferAsPackageJson(this.decoder, packageJsonContent, url.href);\n                _iteratorNormalCompletion = true;\n                _didIteratorError = false;\n                _iteratorError = undefined;\n                _context2.prev = 20;\n                _iterator = this.packageMain[Symbol.iterator]();\n\n              case 22:\n                if (_iteratorNormalCompletion = (_step = _iterator.next()).done) {\n                  _context2.next = 31;\n                  break;\n                }\n\n                packageMain = _step.value;\n                pathname = packageJson[packageMain];\n\n                if (!(typeof pathname === 'string')) {\n                  _context2.next = 28;\n                  break;\n                }\n\n                mainPathname = pathname;\n                return _context2.abrupt(\"break\", 31);\n\n              case 28:\n                _iteratorNormalCompletion = true;\n                _context2.next = 22;\n                break;\n\n              case 31:\n                _context2.next = 37;\n                break;\n\n              case 33:\n                _context2.prev = 33;\n                _context2.t0 = _context2[\"catch\"](20);\n                _didIteratorError = true;\n                _iteratorError = _context2.t0;\n\n              case 37:\n                _context2.prev = 37;\n                _context2.prev = 38;\n\n                if (!_iteratorNormalCompletion && _iterator.return != null) {\n                  _iterator.return();\n                }\n\n              case 40:\n                _context2.prev = 40;\n\n                if (!_didIteratorError) {\n                  _context2.next = 43;\n                  break;\n                }\n\n                throw _iteratorError;\n\n              case 43:\n                return _context2.finish(40);\n\n              case 44:\n                return _context2.finish(37);\n\n              case 45:\n                mainUrl = new URL(resolve(url.pathname, mainPathname), rootUrl);\n                return _context2.abrupt(\"return\", this.resolveAsFile(mainUrl, options));\n\n              case 47:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[20, 33, 37, 45], [38,, 40, 44]]);\n      }));\n\n      function resolveAsDirectory(_x2, _x3) {\n        return _resolveAsDirectory.apply(this, arguments);\n      }\n\n      return resolveAsDirectory;\n    }()\n    /**\r\n     * Resolve a reference treating it as a file\r\n     *\r\n     * 1. List entries in the containing directory\r\n     * 2. Look for an exact file match or a file match with one of the supplied extensions\r\n     * 3. Look for a matching child directory and attempt to resolve that as a directory\r\n     */\n\n  }, {\n    key: \"resolveAsFile\",\n    value: function () {\n      var _resolveAsFile = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(url, options) {\n        var rootUrl, parentPackageJson, browserOverrides, browserMap, packageJsonDir, entry, impliedUrl, targetSpec, target, containingUrl, filename, entries, entryDirectoryMap, entryFileMap, _iteratorNormalCompletion2, _didIteratorError2, _iteratorError2, _iterator2, _step2, _entry, childFilename, _childFilename, _iteratorNormalCompletion3, _didIteratorError3, _iteratorError3, _iterator3, _step3, ext, mapping, _match, match;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!(url.pathname === '' || url.pathname === '/')) {\n                  _context3.next = 2;\n                  break;\n                }\n\n                throw new TypeError(\"Unable to resolve the root as a file: \".concat(url.href));\n\n              case 2:\n                _context3.next = 4;\n                return this.host.getResolveRoot(this, url, {\n                  token: options.token\n                });\n\n              case 4:\n                rootUrl = _context3.sent;\n\n                if (!options.token.isCancellationRequested) {\n                  _context3.next = 7;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 7:\n                if (!(this.packageMain.includes('browser') && !options.ignoreBrowserOverrides)) {\n                  _context3.next = 13;\n                  break;\n                }\n\n                _context3.next = 10;\n                return this.readParentPackageJson(url, {\n                  token: options.token\n                });\n\n              case 10:\n                _context3.t0 = _context3.sent;\n                _context3.next = 14;\n                break;\n\n              case 13:\n                _context3.t0 = undefined;\n\n              case 14:\n                parentPackageJson = _context3.t0;\n\n                if (!options.token.isCancellationRequested) {\n                  _context3.next = 17;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 17:\n                browserOverrides = new Map();\n\n                if (!(parentPackageJson && typeof parentPackageJson.packageJson.browser === 'object')) {\n                  _context3.next = 34;\n                  break;\n                }\n\n                browserMap = parentPackageJson.packageJson.browser;\n                packageJsonDir = dirname(parentPackageJson.url.pathname);\n                _context3.t1 = _regeneratorRuntime.keys(browserMap);\n\n              case 22:\n                if ((_context3.t2 = _context3.t1()).done) {\n                  _context3.next = 34;\n                  break;\n                }\n\n                entry = _context3.t2.value;\n                impliedUrl = new URL(resolve(packageJsonDir, entry), parentPackageJson.url);\n                targetSpec = browserMap[entry];\n                target = targetSpec === false ? false : new URL(resolve(packageJsonDir, targetSpec), parentPackageJson.url);\n\n                if (!(impliedUrl.href === url.href)) {\n                  _context3.next = 31;\n                  break;\n                }\n\n                if (!(target === false)) {\n                  _context3.next = 30;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", false);\n\n              case 30:\n                return _context3.abrupt(\"return\", this.resolveAsFile(target, _objectSpread({}, options, {\n                  ignoreBrowserOverrides: true\n                })));\n\n              case 31:\n                browserOverrides.set(impliedUrl.href, target);\n                _context3.next = 22;\n                break;\n\n              case 34:\n                containingUrl = new URL(ensureTrailingSlash(dirname(url.pathname)), rootUrl);\n                filename = basename(url.pathname);\n                _context3.next = 38;\n                return this.host.listEntries(this, containingUrl, {\n                  token: options.token\n                });\n\n              case 38:\n                entries = _context3.sent;\n\n                if (!options.token.isCancellationRequested) {\n                  _context3.next = 41;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 41:\n                entryDirectoryMap = new Map();\n                entryFileMap = new Map();\n                _iteratorNormalCompletion2 = true;\n                _didIteratorError2 = false;\n                _iteratorError2 = undefined;\n                _context3.prev = 46;\n                _iterator2 = entries[Symbol.iterator]();\n\n              case 48:\n                if (_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done) {\n                  _context3.next = 56;\n                  break;\n                }\n\n                _entry = _step2.value;\n\n                if (!(_entry.url.href === url.href && _entry.type == ResolvedEntryKind.File)) {\n                  _context3.next = 52;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", _entry.url);\n\n              case 52:\n                if (_entry.type === ResolvedEntryKind.Directory) {\n                  childFilename = getFirstPathSegmentAfterPrefix(_entry.url, containingUrl);\n                  entryDirectoryMap.set(childFilename, _entry);\n                } else if (_entry.type === ResolvedEntryKind.File) {\n                  _childFilename = basename(_entry.url.pathname);\n                  entryFileMap.set(_childFilename, _entry);\n                }\n\n              case 53:\n                _iteratorNormalCompletion2 = true;\n                _context3.next = 48;\n                break;\n\n              case 56:\n                _context3.next = 62;\n                break;\n\n              case 58:\n                _context3.prev = 58;\n                _context3.t3 = _context3[\"catch\"](46);\n                _didIteratorError2 = true;\n                _iteratorError2 = _context3.t3;\n\n              case 62:\n                _context3.prev = 62;\n                _context3.prev = 63;\n\n                if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n                  _iterator2.return();\n                }\n\n              case 65:\n                _context3.prev = 65;\n\n                if (!_didIteratorError2) {\n                  _context3.next = 68;\n                  break;\n                }\n\n                throw _iteratorError2;\n\n              case 68:\n                return _context3.finish(65);\n\n              case 69:\n                return _context3.finish(62);\n\n              case 70:\n                // Look for browser overrides\n                _iteratorNormalCompletion3 = true;\n                _didIteratorError3 = false;\n                _iteratorError3 = undefined;\n                _context3.prev = 73;\n                _iterator3 = options.extensions[Symbol.iterator]();\n\n              case 75:\n                if (_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done) {\n                  _context3.next = 92;\n                  break;\n                }\n\n                ext = _step3.value;\n                mapping = browserOverrides.get(\"\".concat(url.href).concat(ext));\n\n                if (!(mapping === false)) {\n                  _context3.next = 82;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", false);\n\n              case 82:\n                if (!mapping) {\n                  _context3.next = 84;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\", this.resolveAsFile(mapping, _objectSpread({}, options, {\n                  ignoreBrowserOverrides: true\n                })));\n\n              case 84:\n                _match = entryFileMap.get(\"\".concat(filename).concat(ext));\n\n                if (!_match) {\n                  _context3.next = 89;\n                  break;\n                }\n\n                if (!(_match.type !== ResolvedEntryKind.File)) {\n                  _context3.next = 88;\n                  break;\n                }\n\n                return _context3.abrupt(\"continue\", 89);\n\n              case 88:\n                return _context3.abrupt(\"return\", _match.url);\n\n              case 89:\n                _iteratorNormalCompletion3 = true;\n                _context3.next = 75;\n                break;\n\n              case 92:\n                _context3.next = 98;\n                break;\n\n              case 94:\n                _context3.prev = 94;\n                _context3.t4 = _context3[\"catch\"](73);\n                _didIteratorError3 = true;\n                _iteratorError3 = _context3.t4;\n\n              case 98:\n                _context3.prev = 98;\n                _context3.prev = 99;\n\n                if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n                  _iterator3.return();\n                }\n\n              case 101:\n                _context3.prev = 101;\n\n                if (!_didIteratorError3) {\n                  _context3.next = 104;\n                  break;\n                }\n\n                throw _iteratorError3;\n\n              case 104:\n                return _context3.finish(101);\n\n              case 105:\n                return _context3.finish(98);\n\n              case 106:\n                // First, attempt to find a matching file or directory\n                match = entryDirectoryMap.get(filename);\n\n                if (!match) {\n                  _context3.next = 111;\n                  break;\n                }\n\n                if (!(match.type !== ResolvedEntryKind.Directory)) {\n                  _context3.next = 110;\n                  break;\n                }\n\n                throw new Error(\"Invariant violation \".concat(match.type, \" is unexpected\"));\n\n              case 110:\n                return _context3.abrupt(\"return\", this.resolveAsDirectory(match.url, options));\n\n              case 111:\n                throw new EntryNotFoundError(url);\n\n              case 112:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[46, 58, 62, 70], [63,, 65, 69], [73, 94, 98, 106], [99,, 101, 105]]);\n      }));\n\n      function resolveAsFile(_x4, _x5) {\n        return _resolveAsFile.apply(this, arguments);\n      }\n\n      return resolveAsFile;\n    }()\n  }, {\n    key: \"readParentPackageJson\",\n    value: function () {\n      var _readParentPackageJson = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(url) {\n        var _this3 = this;\n\n        var options,\n            hostRootUrl,\n            hostRootHref,\n            containingDirUrl,\n            readPackageJsonOrRecurse,\n            _args5 = arguments;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                options = _args5.length > 1 && _args5[1] !== undefined ? _args5[1] : {};\n                _context5.next = 3;\n                return this.host.getCanonicalUrl(this, url, {\n                  token: options.token\n                });\n\n              case 3:\n                url = _context5.sent;\n\n                if (!(options.token && options.token.isCancellationRequested)) {\n                  _context5.next = 6;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 6:\n                _context5.next = 8;\n                return this.host.getResolveRoot(this, url, {\n                  token: options.token\n                });\n\n              case 8:\n                hostRootUrl = _context5.sent;\n\n                if (!(options.token && options.token.isCancellationRequested)) {\n                  _context5.next = 11;\n                  break;\n                }\n\n                throw new CanceledError('Canceled');\n\n              case 11:\n                hostRootHref = ensureTrailingSlash(hostRootUrl.href);\n                containingDirUrl = new URL(ensureTrailingSlash(dirname(url.pathname)), url);\n\n                readPackageJsonOrRecurse =\n                /*#__PURE__*/\n                function () {\n                  var _ref5 = _asyncToGenerator(\n                  /*#__PURE__*/\n                  _regeneratorRuntime.mark(function _callee4(dir) {\n                    var entries, packageJsonEntry, parentPackageJsonContent, packageJson, parentDir;\n                    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n                      while (1) {\n                        switch (_context4.prev = _context4.next) {\n                          case 0:\n                            if (dir.href.startsWith(hostRootHref)) {\n                              _context4.next = 2;\n                              break;\n                            }\n\n                            return _context4.abrupt(\"return\", undefined);\n\n                          case 2:\n                            _context4.next = 4;\n                            return _this3.host.listEntries(_this3, dir, {\n                              token: options.token\n                            });\n\n                          case 4:\n                            entries = _context4.sent;\n\n                            if (!(options.token && options.token.isCancellationRequested)) {\n                              _context4.next = 7;\n                              break;\n                            }\n\n                            throw new CanceledError('Canceled');\n\n                          case 7:\n                            packageJsonEntry = entries.find(function (entry) {\n                              return entry.type === ResolvedEntryKind.File && entry.url.pathname.endsWith('/package.json');\n                            });\n\n                            if (!packageJsonEntry) {\n                              _context4.next = 24;\n                              break;\n                            }\n\n                            _context4.prev = 9;\n                            _context4.next = 12;\n                            return _this3.host.readFileContent(_this3, packageJsonEntry.url, {\n                              token: options.token\n                            });\n\n                          case 12:\n                            parentPackageJsonContent = _context4.sent;\n\n                            if (!(options.token && options.token.isCancellationRequested)) {\n                              _context4.next = 15;\n                              break;\n                            }\n\n                            throw new CanceledError('Canceled');\n\n                          case 15:\n                            packageJson = parseBufferAsPackageJson(_this3.decoder, parentPackageJsonContent, packageJsonEntry.url.href);\n                            return _context4.abrupt(\"return\", {\n                              packageJson: packageJson,\n                              url: packageJsonEntry.url\n                            });\n\n                          case 19:\n                            _context4.prev = 19;\n                            _context4.t0 = _context4[\"catch\"](9);\n\n                            if (!(_context4.t0 instanceof CanceledError || _context4.t0 && _context4.t0.name === 'CanceledError')) {\n                              _context4.next = 23;\n                              break;\n                            }\n\n                            throw _context4.t0;\n\n                          case 23:\n                            console.warn(\"Error reading the parent package manifest for \".concat(url.href, \" from \").concat(packageJsonEntry.url.href, \": \").concat(_context4.t0.message));\n\n                          case 24:\n                            // Not found here, let's try one up\n                            parentDir = new URL(ensureTrailingSlash(dirname(dir.pathname)), dir); // Skip infinite recursion\n\n                            if (!(parentDir.href === dir.href)) {\n                              _context4.next = 27;\n                              break;\n                            }\n\n                            return _context4.abrupt(\"return\", undefined);\n\n                          case 27:\n                            return _context4.abrupt(\"return\", readPackageJsonOrRecurse(parentDir));\n\n                          case 28:\n                          case \"end\":\n                            return _context4.stop();\n                        }\n                      }\n                    }, _callee4, null, [[9, 19]]);\n                  }));\n\n                  return function readPackageJsonOrRecurse(_x7) {\n                    return _ref5.apply(this, arguments);\n                  };\n                }();\n\n                return _context5.abrupt(\"return\", readPackageJsonOrRecurse(containingDirUrl));\n\n              case 15:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function readParentPackageJson(_x6) {\n        return _readParentPackageJson.apply(this, arguments);\n      }\n\n      return readParentPackageJson;\n    }()\n  }]);\n\n  return Resolver;\n}();\n\nResolver.defaultExtensions = ['.js', '.jsx', '.es6', '.es', '.mjs', '.ts', '.tsx', '.json'];\nResolver.path = {\n  basename: basename,\n  dirname: dirname,\n  extname: extname,\n  resolve: resolve\n};\nexport { AbstractResolverHost, Decoder, EntryNotFoundError, ResolvedEntryKind, Resolver, isValidPackageJson, util };"],"sourceRoot":""}